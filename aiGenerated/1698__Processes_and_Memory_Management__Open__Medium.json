{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Processes and Memory Management",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 20:06:44",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1726,
      "output_tokens": 1471,
      "total_tokens": 6633
    }
  },
  "question": {
    "id": 101,
    "type": "Open",
    "topic": [
      "Processes",
      "Memory Management",
      "Virtual Memory",
      "Paging",
      "TLB"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה עם זיכרון וירטואלי בגודל 4GB, זיכרון פיזי בגודל 1GB, וגודל דף של 4KB. למערכת קיים TLB בגודל 128 רשומות. תהליך P מנסה לגשת לכתובת וירטואלית 0xABCD1234. ידוע כי הדף המתאים לכתובת זו אינו נמצא בזיכרון הפיזי (ה-Valid bit ב-Page Table Entry המתאים הוא 0).\n\nא. תאר בפירוט את רצף האירועים מרגע ניסיון הגישה לכתובת 0xABCD1234 ועד לביצוע הפקודה בהצלחה. כלול את כל המרכיבים המעורבים (MMU, TLB, טבלת דפים, מערכת הפעלה).\n\nב. מה יקרה בניסיון גישה *חוזר* לאותה כתובת וירטואלית 0xABCD1234, מיד לאחר השלמת הגישה הראשונה?",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": 20,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "א. רצף האירועים בניסיון הגישה הראשון:\n1.  **קבלת הכתובת הווירטואלית:** ה-CPU מנסה לגשת לכתובת הווירטואלית 0xABCD1234. ה-MMU (Memory Management Unit) מקבל כתובת זו.\n2.  **בדיקת TLB:** ה-MMU בודק תחילה האם ה-Virtual Page Number (VPN) המתאים לכתובת (0xABCD1, בהינתן גודל דף 4KB) קיים ב-TLB. מכיוון שהדף אינו בזיכרון הפיזי, סביר להניח שהוא אינו ב-TLB, ולכן מתרחש TLB Miss.\n3.  **חיפוש בטבלת הדפים:** ה-MMU מתחיל בחיפוש ה-PTE (Page Table Entry) המתאים בטבלת הדפים (לרוב טבלה היררכית). הוא משתמש בחלקי ה-VPN השונים כדי לאתר את ה-PTE הרצוי.\n4.  **זיהוי Page Fault:** כאשר ה-MMU מוצא את ה-PTE עבור הדף 0xABCD1, הוא מגלה שה-Valid bit ב-PTE הוא 0. זהו סימן לכך שהדף אינו נמצא כרגע בזיכרון הפיזי, ומתרחש Page Fault.\n5.  **הפעלת מטפל ה-Page Fault של מערכת ההפעלה:** ה-MMU מדווח על ה-Page Fault ל-CPU, שמפסיק את ביצוע התהליך, עובר למצב Kernel ומפעיל את מטפל ה-Page Fault של מערכת ההפעלה.\n6.  **טיפול ב-Page Fault:**\n    *   מערכת ההפעלה מזהה את הדף הווירטואלי שגרם לתקלה (0xABCD1).\n    *   היא מוצאת מסגרת פיזית פנויה בזיכרון הפיזי (או בוחרת מסגרת לפנות באמצעות אלגוריתם החלפת דפים, אם אין פנויות). \n    *   מערכת ההפעלה מבצעת פעולת קלט/פלט (I/O) כדי לטעון את תוכן הדף הדרוש מהדיסק אל המסגרת הפיזית שנבחרה.\n    *   לאחר שהדף נטען, מערכת ההפעלה מעדכנת את ה-PTE המתאים: היא מעלה את ה-Valid bit ל-1, מכניסה את מספר המסגרת הפיזית (PFN) החדש, ומעדכנת ביטים נוספים כמו Accessed/Dirty.\n    *   לבסוף, מערכת ההפעלה מוסיפה את המיפוי החדש (VPN -> PFN) ל-TLB כדי לזרז גישות עתידיות לאותו דף.\n7.  **הפעלת הפקודה מחדש:** מערכת ההפעלה מחזירה את השליטה לתהליך P, ומורה ל-CPU להפעיל מחדש את הפקודה שגרמה ל-Page Fault. כעת, כשהדף בזיכרון וה-TLB וה-PTE מעודכנים, הגישה תצליח.\n\nב. בניסיון גישה *חוזר* לאותה כתובת וירטואלית 0xABCD1234, מיד לאחר השלמת הגישה הראשונה:\n1.  **קבלת הכתובת הווירטואלית:** ה-CPU מנסה שוב לגשת לכתובת הווירטואלית 0xABCD1234.\n2.  **בדיקת TLB:** ה-MMU בודק תחילה את ה-TLB. מכיוון שמערכת ההפעלה הוסיפה את המיפוי ל-TLB במהלך טיפול ב-Page Fault הקודם, הפעם יתרחש TLB Hit.\n3.  **תרגום כתובת מיידי:** ה-MMU משתמש ב-PFN שנמצא ב-TLB יחד עם ה-offset (0x234) מהכתובת הווירטואלית כדי ליצור באופן מיידי את הכתובת הפיזית.\n4.  **גישה לזיכרון:** ה-CPU ניגש לזיכרון הפיזי בכתובת שחושבה, והפקודה הושלמה במהירות רבה יותר מכיוון שלא היה צורך בגישה לטבלת הדפים או בטיפול ב-Page Fault."
    },
    "difficulty_estimation": "Medium"
  }
}