{
  "metadata": {
    "source": "ai_generated",
    "subject": "File Systems",
    "topic_hint": "File Systems",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 23:48:19",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2680,
      "output_tokens": 1186,
      "total_tokens": 7694
    }
  },
  "question": {
    "id": 101,
    "type": "CodeAnalysis",
    "topic": [
      "File Systems",
      "Links",
      "System Calls",
      "Inode"
    ],
    "content": {
      "text": "נתונה תוכנית ה-C הבאה. התוכנית מופעלת בספרייה ריקה. יש להניח שכל קריאות המערכת מצליחות.\n\nלאחר הרצת התוכנית, מה יהיה התוכן של הקובץ `hardlink.txt` ומה יקרה בניסיון לקרוא מהקובץ `softlink.txt`?",
      "code_snippet": "#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <fcntl.h>\n#include <sys/stat.h> // For S_IRUSR, etc.\n\nint main() {\n    const char *file_orig = \"original.txt\";\n    const char *hard_link_name = \"hardlink.txt\";\n    const char *soft_link_name = \"softlink.txt\";\n    int fd;\n\n    // 1. Create original.txt and write \"First line.\"\n    fd = open(file_orig, O_CREAT | O_WRONLY | O_TRUNC, 0644);\n    if (fd == -1) { perror(\"open original.txt\"); return 1; }\n    write(fd, \"First line.\\n\", 12);\n    close(fd);\n\n    // 2. Create a hard link to original.txt\n    if (link(file_orig, hard_link_name) == -1) { perror(\"link hardlink.txt\"); return 1; }\n\n    // 3. Create a symbolic link to original.txt\n    if (symlink(file_orig, soft_link_name) == -1) { perror(\"symlink softlink.txt\"); return 1; }\n\n    // 4. Append \"Second line.\" via the hard link\n    fd = open(hard_link_name, O_WRONLY | O_APPEND);\n    if (fd == -1) { perror(\"open hardlink.txt for append\"); return 1; }\n    write(fd, \"Second line.\\n\", 13);\n    close(fd);\n\n    // 5. Unlink the original file\n    if (unlink(file_orig) == -1) { perror(\"unlink original.txt\"); return 1; }\n\n    return 0;\n}"
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "הסבר:\n\n**תוכן הקובץ `hardlink.txt`:**\nהתוכן יהיה:\n```\nFirst line.\nSecond line.\n```\n\n**נימוק:** קישור קשיח (hard link) הוא שם נוסף לאותו קובץ (אותו inode) במערכת הקבצים. כאשר כותבים לקובץ `original.txt` (דרך הפתיחה הראשונית) או ל-`hardlink.txt` (דרך הפתיחה השנייה), בפועל כותבים לאותו מקום אחסון בדיסק. לכן, הוספת הטקסט 'Second line.' דרך `hardlink.txt` משנה את התוכן של ה-inode המשותף. הפעולה `unlink(file_orig)` מסירה רק את השם `original.txt` מהספרייה ומקטינה את מונה הקישורים (link count) של ה-inode. כיוון ש-`hardlink.txt` עדיין מצביע על אותו inode, הקובץ והתוכן שלו נשארים זמינים דרך `hardlink.txt`.\n\n**ניסיון לקרוא מהקובץ `softlink.txt`:**\nהניסיון לקרוא מהקובץ `softlink.txt` ייכשל עם שגיאה כגון `ENOENT` (No such file or directory).\n\n**נימוק:** קישור סימבולי (symbolic link או soft link) הוא קובץ מיוחד המכיל את הנתיב (path) לקובץ יעד אחר. במקרה זה, `softlink.txt` מכיל את הנתיב `original.txt`. כאשר `original.txt` נמחק (באמצעות `unlink`), השם `original.txt` כבר אינו קיים בספרייה. לכן, כאשר מנסים לגשת ל-`softlink.txt`, מערכת ההפעלה מנסה לפתור את הנתיב הפנימי `original.txt`, אך כיוון שקובץ בשם זה כבר לא קיים, הגישה נכשלת והשגיאה `ENOENT` מוחזרת. הקישור הסימבולי הופך ל'קישור שבור' (dangling link)."
    },
    "difficulty_estimation": "Medium"
  }
}