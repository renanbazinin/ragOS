{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Memory Management",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 21:48:54",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 1680,
      "total_tokens": 8217
    }
  },
  "question": {
    "id": 10,
    "type": "MultipleChoice",
    "topic": [
      "Memory Management",
      "Paging",
      "Multi-level Page Tables"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המשתמשת בטבלאות דפים רב-שכבתיות עם 3 רמות (P1 -> P2 -> P3 -> דף פיזי). כתובת וירטואלית היא באורך 48 ביטים. גודל דף הוא 4KB. גודל כניסת טבלת דפים (PTE) הוא 8 בתים. תהליך יחיד מקצה לעצמו 16GB של זיכרון וירטואלי, אך משתמש באופן פעיל (כלומר, דפי הנתונים שלו נמצאים בזיכרון פיזי) רק ב-512MB מתוכו. הזיכרון הפעיל מפוזר באופן דליל (sparsely distributed) על פני מרחב הכתובות הוירטואלי. בהנחה שמערכת ההפעלה מקצה טבלאות דפים באופן אופטימלי (כלומר, רק כאשר יש צורך), מהו נפח הזיכרון המינימלי (בבתים) הנדרש לאחסון כל טבלאות הדפים עבור תהליך זה?",
      "code_snippet": null,
      "options": [
        "א. 1,024,000 בתים",
        "ב. 1,032,000 בתים",
        "ג. 1,056,768 בתים",
        "ד. 1,048,576 בתים",
        "ה. 1,060,864 בתים"
      ]
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ג",
      "explanation": "הסבר:\n1.  **חישוב פרמטרים בסיסיים:**\n    *   גודל דף: 4KB = 2^12 בתים. לכן, 12 ביטים משמשים ל-offset בתוך הדף.\n    *   אורך כתובת וירטואלית: 48 ביטים.\n    *   מספר ביטי ה-Virtual Page Number (VPN): 48 - 12 = 36 ביטים.\n    *   גודל כניסת טבלת דפים (PTE): 8 בתים.\n    *   מספר כניסות טבלה לדף טבלה בודד: 4KB / 8 בתים = 512 כניסות.\n    *   מספר ביטים לכל אינדקס בדף טבלת דפים: 2^9 = 512, לכן 9 ביטים לאינדקס.\n\n2.  **חלוקת ביטי ה-VPN בין הרמות:**\n    *   נתונה טבלת דפים בעלת 3 רמות (P1 -> P2 -> P3 -> דף פיזי). זה אומר שה-VPN מחולק לשלושה אינדקסים: I1, I2, I3.\n    *   אינדקס לרמה 1 (I1): 9 ביטים (מצביע לדף P2).\n    *   אינדקס לרמה 2 (I2): 9 ביטים (מצביע לדף P3).\n    *   הביטים הנותרים עבור אינדקס לרמה 3 (I3): 36 - 9 - 9 = 18 ביטים (מצביע לדף נתונים פיזי).\n\n3.  **חישוב מספר דפי נתונים פעילים:**\n    *   זיכרון פעיל: 512MB.\n    *   מספר דפי נתונים = 512MB / 4KB = 2^29 בתים / 2^12 בתים לדף = 2^17 דפים = 131,072 דפים.\n\n4.  **חישוב נפח הזיכרון עבור טבלאות דפים (מלמטה למעלה, בהנחה של הקצאה אופטימלית עבור זיכרון מפוזר):**\n    *   **רמה 3 (P3):**\n        *   כל דף טבלה ברמה 3 מכיל 512 PTEs (כל PTE מצביע לדף נתונים). כלומר, דף P3 אחד יכול לשרת 512 דפי נתונים.\n        *   כדי לטפל ב-2^17 דפי נתונים פעילים, נצטרך: ceil(2^17 / 512) = ceil(2^17 / 2^9) = 2^8 = 256 דפי טבלה ברמה 3.\n        *   נפח זיכרון עבור דפי P3 = 256 * 4KB = 1024KB = 1MB.\n\n    *   **רמה 2 (P2):**\n        *   כל דף טבלה ברמה 2 מכיל 512 PTEs (כל PTE מצביע לדף טבלה ברמה 3). כלומר, דף P2 אחד יכול לשרת 512 דפי P3.\n        *   כדי לטפל ב-256 דפי טבלה ברמה 3, נצטרך: ceil(256 / 512) = 1 דף טבלה ברמה 2.\n        *   נפח זיכרון עבור דפי P2 = 1 * 4KB = 4KB.\n\n    *   **רמה 1 (P1 - טבלת הבסיס):**\n        *   כל דף טבלה ברמה 1 מכיל 512 PTEs (כל PTE מצביע לדף טבלה ברמה 2). כלומר, דף P1 אחד יכול לשרת 512 דפי P2.\n        *   כדי לטפל ב-1 דף טבלה ברמה 2, נצטרך: ceil(1 / 512) = 1 דף טבלה ברמה 1 (זהו דף טבלת הבסיס/השורש).\n        *   נפח זיכרון עבור דפי P1 = 1 * 4KB = 4KB.\n\n5.  **סה\"כ נפח זיכרון לטבלאות דפים:**\n    *   סה\"כ = נפח P1 + נפח P2 + נפח P3\n    *   סה\"כ = 4KB + 4KB + 1024KB = 1032KB.\n    *   המרת לבתים: 1032KB * 1024 בתים/KB = 1,056,768 בתים.\n\nלכן, התשובה הנכונה היא ג'."
    },
    "difficulty_estimation": "Hard"
  }
}