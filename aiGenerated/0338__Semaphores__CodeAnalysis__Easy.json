{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Semaphores",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Easy",
    "generated_at": "2026-02-07 20:56:34",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3853,
      "output_tokens": 798,
      "total_tokens": 6280
    }
  },
  "question": {
    "id": 8,
    "type": "CodeAnalysis",
    "topic": [
      "Synchronization",
      "Semaphores",
      "Concurrency",
      "Threads"
    ],
    "content": {
      "text": "נתונה תוכנית C הבאה המשתמשת בסמפורים וב-pthreads. יש לנתח את הקוד ולענות על השאלה: מה יהיה הפלט הסופי של התוכנית? הסבר מדוע.",
      "code_snippet": "#include <stdio.h>\n#include <pthread.h>\n#include <semaphore.h>\n\n#define N_ITERATIONS 100000\n\nint counter = 0;\nsem_t mutex; // A semaphore acting as a mutex\n\nvoid* increment_thread(void* arg) {\n    for (int i = 0; i < N_ITERATIONS; ++i) {\n        sem_wait(&mutex); // Acquire lock\n        counter++;\n        sem_post(&mutex); // Release lock\n    }\n    return NULL;\n}\n\nint main() {\n    pthread_t tid1, tid2;\n\n    // Initialize the semaphore to 1 (binary semaphore for mutual exclusion)\n    sem_init(&mutex, 0, 1);\n\n    pthread_create(&tid1, NULL, increment_thread, NULL);\n    pthread_create(&tid2, NULL, increment_thread, NULL);\n\n    pthread_join(tid1, NULL);\n    pthread_join(tid2, NULL);\n\n    printf(\"Final counter value: %d\\n\", counter);\n\n    sem_destroy(&mutex); // Destroy the semaphore\n    return 0;\n}"
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "התוכנית מאתחלת מונה גלובלי (counter) ל-0 וסמפור בינארי (mutex) לערך 1. נוצרים שני תהליכונים, שניהם מריצים את הפונקציה increment_thread. כל תהליכון מבצע N_ITERATIONS פעולות הגדלה למונה. קריאות ל-sem_wait(&mutex) לפני הגדלת המונה ול-sem_post(&mutex) לאחריה מבטיחות בלעדיות הדדית (mutual exclusion), כלומר, רק תהליכון אחד יכול לגשת ולשנות את המונה בכל רגע נתון. זה מונע תנאי מירוץ (race conditions).\nמכיוון שכל אחד משני התהליכונים מגדיל את המונה N_ITERATIONS פעמים, והגישה למונה מוגנת באמצעות הסמפור, הערך הסופי של המונה יהיה סך ההגדלות שבוצעו על ידי שני התהליכונים. עם N_ITERATIONS = 100000, כל תהליכון מגדיל את המונה 100,000 פעמים. לכן, הערך הסופי של המונה יהיה 2 * 100000 = 200000.\nהתוכנית תדפיס: \"Final counter value: 200000\"."
    },
    "difficulty_estimation": "Easy"
  }
}