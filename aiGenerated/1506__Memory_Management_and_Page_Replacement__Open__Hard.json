{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Memory Management and Page Replacement",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 10:58:15",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3221,
      "output_tokens": 4412,
      "total_tokens": 19269
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Memory Management",
      "Page Replacement",
      "Virtual Memory",
      "Paging",
      "TLB"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המשתמשת בזיכרון וירטואלי עם מרחב כתובות וירטואלי בגודל 42 ביטים. גודל דף הוא 4KB. הזיכרון הפיזי הכולל במערכת הוא 2GB. טבלת הדפים היא רב-רמתית (Multi-level page table) וכל כניסה בטבלת הדפים (PTE) בגודל 4 בתים ומכילה את מספר המסגרת הפיזית (PFN) וביטים נוספים (Valid, Present, Dirty, Accessed). כל טבלת דפים ברמה מסוימת מאוחסנת בדף פיזי אחד בלבד.\nבמערכת קיים TLB בגודל 16 כניסות, בשיטת Fully Associative, ומשתמש באלגוריתם LRU להחלפת כניסות.\nאלגוריתם החלפת הדפים בזיכרון הפיזי (Page Replacement) עבור תהליכים הוא \"LRU מועדף\" (Prioritized LRU): כאשר יש צורך לפנות דף מזיכרון פיזי, המערכת תבחר קודם כל את דף ה-LRU מבין כל הדפים ה\"נקיים\" (Clean). אם כל הדפים בזיכרון הם \"מלוכלכים\" (Dirty), המערכת תבחר את דף ה-LRU מבין כלל הדפים בזיכרון (שיהיה בהכרח דף מלוכלך).\nהערה: יש להתעלם מביט ה-Present עבור טבלאות דפים פנימיות (כלומר, נניח שכל טבלאות הדפים הקיימות בשימוש נמצאות בזיכרון הפיזי).",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "א. כמה רמות נדרשות לטבלת הדפים? פרטו את מספר הביטים לכל אינדקס רמה (P1, P2, P3) ואת מספר הביטים עבור ההיסט (Offset).\nב. מהו המספר המקסימלי של כניסות בכל טבלת דפים (ברמה בודדת)?\nג. מהו הגודל הכולל (בבתים) של טבלת דפים מלאה עבור תהליך בודד (כלומר, טבלה הממפה את כל מרחב הכתובות הוירטואלי)?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "נתון תהליך המקבל 4 מסגרות פיזיות (frames) בלבד. בתחילת הריצה, כל המסגרות ריקות.\nבצעו מעקב מפורט אחר רצף הגישות לזיכרון הוירטואלי הבא. עבור כל גישה, פרטו:\n1.  האם התרחש TLB Hit או TLB Miss?\n2.  האם התרחשה Page Fault?\n3.  אם התרחשה Page Fault ונדרשה החלפת דף, איזה דף (VPN) פונה, והאם הוא היה נקי/מלוכלך?\n4.  הציגו את מצב 4 המסגרות הפיזיות לאחר כל גישה (VPN+Dirty Bit).\n5.  הציגו את מצב ה-TLB לאחר כל גישה (VPN:PFN ו-Dirty Bit).\n\nרצף הגישות (VPN בבסיס 16, סוג גישה - R=קריאה, W=כתיבה):\n1.  0x100 (R)\n2.  0x200 (R)\n3.  0x100 (R)\n4.  0x300 (W)\n5.  0x400 (R)\n6.  0x100 (R)\n7.  0x500 (W)\n8.  0x200 (W)\n9.  0x300 (R)\n10. 0x600 (R)",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "פתרון:\n\n**סעיף 1.1: תצורת המערכת**\nא. חישוב ביטים לכתובת וירטואלית והיסט:\n   - גודל כתובת וירטואלית: 42 ביטים.\n   - גודל דף: 4KB = 2^12 בתים. לכן, ההיסט (Offset) הוא 12 ביטים.\n   - מספר ביטים לכתובת דף וירטואלי (VPN): 42 - 12 = 30 ביטים.\n   - גודל כניסה בטבלת דפים (PTE): 4 בתים.\n   - כל טבלת דפים מאוחסנת בדף פיזי אחד (4KB). לכן, מספר הכניסות המקסימלי בטבלת דפים בודדת הוא: 4KB / 4 בתים/כניסה = 1024 כניסות = 2^10 כניסות.\n   - כל אינדקס רמה בטבלת הדפים משתמש ב-10 ביטים.\n   - מספר הרמות הנדרש עבור 30 ביטים של VPN: 30 ביטים / 10 ביטים/רמה = 3 רמות.\n   - פירוט הביטים: P1 (10 ביטים), P2 (10 ביטים), P3 (10 ביטים), Offset (12 ביטים).\n\nב. מספר מקסימלי של כניסות בכל טבלת דפים (ברמה בודדת): 1024 כניסות (כפי שחושב לעיל).\n\nג. גודל כולל של טבלת דפים מלאה:\n   - רמה 1 (Page Directory): טבלת דפים אחת. גודל: 1024 כניסות * 4 בתים/כניסה = 4KB.\n   - רמה 2: כל כניסה ברמה 1 מצביעה על טבלת דפים ברמה 2. לכן, יש 1024 טבלאות ברמה 2. גודל כולל: 1024 * 4KB = 4MB.\n   - רמה 3: כל כניסה ברמה 2 מצביעה על טבלת דפים ברמה 3. לכן, יש 1024 * 1024 טבלאות ברמה 3. גודל כולל: 1024 * 4MB = 4GB.\n   - הגודל הכולל של טבלת דפים מלאה: 4KB + 4MB + 4GB = 4,299,161,600 בתים (כ-4GB).\n\n**סעיף 1.2: מעקב גישות לזיכרון**\nנשתמש בסימונים הבאים:\n-   `F0, F1, F2, F3`: מסגרות פיזיות (Physical Frames).\n-   `VPN`: מספר דף וירטואלי.\n-   `D`: ביט Dirty (T=מלוכלך, F=נקי).\n-   `TLB`: רשימת כניסות TLB בצורת `[VPN:PFN(D)]`, מסודרת לפי LRU (הכי פחות בשימוש ראשון, הכי בשימוש אחרון).\n-   `Frames`: רשימת דפים במסגרות פיזיות בצורת `[F0:VPN(D), F1:VPN(D), F2:VPN(D), F3:VPN(D)]`, מסודרת לפי LRU (הכי פחות בשימוש ראשון, הכי בשימוש אחרון).\n\n**מצב התחלתי:**\n-   `Frames`: `[null, null, null, null]`\n-   `TLB`: `[]`\n\n**מעקב גישות:**\n\n1.  **גישה 0x100 (R)**\n    -   **TLB**: Miss (TLB ריק).\n    -   **Page Fault**: כן (מסגרות ריקות).\n    -   **פעולה**: טעינת דף 0x100 למסגרת F0. דף נקי (R).\n    -   `Frames`: `[F1:null, F2:null, F3:null, F0:0x100(F)]`\n    -   `TLB`: `[0x100:F0(F)]`\n\n2.  **גישה 0x200 (R)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן.\n    -   **פעולה**: טעינת דף 0x200 למסגרת F1. דף נקי (R).\n    -   `Frames`: `[F2:null, F3:null, F0:0x100(F), F1:0x200(F)]`\n    -   `TLB`: `[0x100:F0(F), 0x200:F1(F)]`\n\n3.  **גישה 0x100 (R)**\n    -   **TLB**: Hit (עבור 0x100).\n    -   **Page Fault**: לא.\n    -   **פעולה**: עדכון ביט Accessed לדף 0x100. אין שינוי ב-Dirty bit.\n    -   `Frames`: `[F2:null, F3:null, F1:0x200(F), F0:0x100(F)]`\n    -   `TLB`: `[0x200:F1(F), 0x100:F0(F)]`\n\n4.  **גישה 0x300 (W)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן.\n    -   **פעולה**: טעינת דף 0x300 למסגרת F2. דף מלוכלך (W).\n    -   `Frames`: `[F3:null, F1:0x200(F), F0:0x100(F), F2:0x300(T)]`\n    -   `TLB`: `[0x200:F1(F), 0x100:F0(F), 0x300:F2(T)]`\n\n5.  **גישה 0x400 (R)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן.\n    -   **פעולה**: טעינת דף 0x400 למסגרת F3. דף נקי (R). כל המסגרות מלאות כעת.\n    -   `Frames`: `[F1:0x200(F), F0:0x100(F), F2:0x300(T), F3:0x400(F)]`\n    -   `TLB`: `[0x200:F1(F), 0x100:F0(F), 0x300:F2(T), 0x400:F3(F)]`\n\n6.  **גישה 0x100 (R)**\n    -   **TLB**: Hit (עבור 0x100).\n    -   **Page Fault**: לא.\n    -   **פעולה**: עדכון Accessed bit לדף 0x100. אין שינוי ב-Dirty bit.\n    -   `Frames`: `[F1:0x200(F), F2:0x300(T), F3:0x400(F), F0:0x100(F)]`\n    -   `TLB`: `[0x200:F1(F), 0x300:F2(T), 0x400:F3(F), 0x100:F0(F)]`\n\n7.  **גישה 0x500 (W)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן (מסגרות מלאות, נדרשת החלפה).\n    -   **אלגוריתם החלפה (Prioritized LRU)**:\n        -   דפים נקיים בזיכרון (לפי סדר LRU): 0x200 (F), 0x400 (F), 0x100 (F).\n        -   דפים מלוכלכים בזיכרון: 0x300 (T).\n        -   ה-LRU מבין הדפים הנקיים הוא 0x200. נבחר לפנות את 0x200.\n    -   **דף שפונה**: 0x200 (נקי).\n    -   **פעולה**: טעינת דף 0x500 למסגרת F1 (שפונתה). דף מלוכלך (W).\n    -   `Frames`: `[F2:0x300(T), F3:0x400(F), F0:0x100(F), F1:0x500(T)]`\n    -   `TLB`: `[0x300:F2(T), 0x400:F3(F), 0x100:F0(F), 0x500:F1(T)]` (ה-TLB מחליף את 0x200 אם היה שם, או את ה-LRU שלו. כאן 0x200 היה ה-LRU ב-TLB).\n\n8.  **גישה 0x200 (W)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן (0x200 אינו בזיכרון, מסגרות מלאות).\n    -   **אלגוריתם החלפה (Prioritized LRU)**:\n        -   דפים נקיים בזיכרון (לפי סדר LRU): 0x400 (F), 0x100 (F).\n        -   דפים מלוכלכים בזיכרון: 0x300 (T), 0x500 (T).\n        -   ה-LRU מבין הדפים הנקיים הוא 0x400. נבחר לפנות את 0x400.\n    -   **דף שפונה**: 0x400 (נקי).\n    -   **פעולה**: טעינת דף 0x200 למסגרת F3 (שפונתה). דף מלוכלך (W).\n    -   `Frames`: `[F2:0x300(T), F0:0x100(F), F1:0x500(T), F3:0x200(T)]`\n    -   `TLB`: `[0x300:F2(T), 0x100:F0(F), 0x500:F1(T), 0x200:F3(T)]` (ה-TLB מחליף את 0x400 אם היה שם, או את ה-LRU שלו. כאן 0x400 היה ה-LRU ב-TLB).\n\n9.  **גישה 0x300 (R)**\n    -   **TLB**: Hit (עבור 0x300).\n    -   **Page Fault**: לא.\n    -   **פעולה**: עדכון Accessed bit לדף 0x300. אין שינוי ב-Dirty bit (נשאר מלוכלך).\n    -   `Frames`: `[F0:0x100(F), F1:0x500(T), F3:0x200(T), F2:0x300(T)]`\n    -   `TLB`: `[0x100:F0(F), 0x500:F1(T), 0x200:F3(T), 0x300:F2(T)]`\n\n10. **גישה 0x600 (R)**\n    -   **TLB**: Miss.\n    -   **Page Fault**: כן (0x600 אינו בזיכרון, מסגרות מלאות).\n    -   **אלגוריתם החלפה (Prioritized LRU)**:\n        -   דפים נקיים בזיכרון (לפי סדר LRU): 0x100 (F).\n        -   דפים מלוכלכים בזיכרון: 0x500 (T), 0x200 (T), 0x300 (T).\n        -   ה-LRU מבין הדפים הנקיים הוא 0x100. נבחר לפנות את 0x100.\n    -   **דף שפונה**: 0x100 (נקי).\n    -   **פעולה**: טעינת דף 0x600 למסגרת F0 (שפונתה). דף נקי (R).\n    -   `Frames`: `[F1:0x500(T), F3:0x200(T), F2:0x300(T), F0:0x600(F)]`\n    -   `TLB`: `[0x500:F1(T), 0x200:F3(T), 0x300:F2(T), 0x600:F0(F)]`"
    },
    "difficulty_estimation": "Hard"
  }
}