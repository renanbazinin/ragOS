{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Processes and Memory Management",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 20:09:22",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1726,
      "output_tokens": 1649,
      "total_tokens": 8377
    }
  },
  "question": {
    "id": 10,
    "type": "Open",
    "topic": [
      "Processes",
      "Memory Management",
      "Virtual Memory",
      "Copy-On-Write"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המשתמשת בזיכרון וירטואלי עם מנגנון Copy-On-Write (COW) בעת יצירת תהליכים חדשים באמצעות `fork()`. גודל הדף במערכת הוא 4KB. תהליך אב (Parent) רץ ומחזיק בזיכרון 16MB של קוד (Text) ו-8MB של נתונים (Data) אשר ניתנים לכתיבה (writable). הזיכרון הפיזי הכולל במערכת הוא 2GB. טבלת הדפים היא לינארית (לא היררכית), וכל רשומת PTE תופסת 4 בתים.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "10.1",
        "text": "כמה מסגרות פיזיות (physical frames) תופסים הקוד והנתונים של תהליך האב בזיכרון הפיזי?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "10.2",
        "text": "מיד לאחר קריאת ה-`fork()` והחזרתה בהצלחה, כמה מסגרות פיזיות *נוספות* יוקצו במערכת עבור הקוד והנתונים של תהליך הבן? נמק את תשובתך.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "10.3",
        "text": "תהליך הבן מבצע שינוי ב-1MB של הנתונים שלו (Data segment). כמה מסגרות פיזיות *נוספות* יוקצו במערכת בעקבות שינוי זה? נמק את תשובתך.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "10.4",
        "text": "לאחר שהבן ביצע את השינוי בסעיף הקודם, האם הקוד והנתונים של תהליך האב עדיין משתפים את אותן מסגרות פיזיות עם הבן? הסבר.",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "פתרון:\n\n1.  **מסגרות פיזיות עבור קוד ונתונים של האב:**\n    *   גודל דף: 4KB.\n    *   קוד: 16MB = 16 * 1024 KB. מספר מסגרות: (16 * 1024 KB) / 4 KB = 4096 מסגרות.\n    *   נתונים: 8MB = 8 * 1024 KB. מספר מסגרות: (8 * 1024 KB) / 4 KB = 2048 מסגרות.\n    *   סה\"כ מסגרות פיזיות שהקוד והנתונים של האב תופסים: 4096 + 2048 = 6144 מסגרות.\n\n2.  **מסגרות פיזיות נוספות עבור קוד ונתונים לאחר `fork()`:**\n    *   0 מסגרות פיזיות נוספות יוקצו עבור הקוד והנתונים של תהליך הבן.\n    *   **נימוק:** מנגנון ה-Copy-On-Write (COW) גורם לכך שמיד לאחר קריאת ה-`fork()`, תהליך האב והבן חולקים את אותן מסגרות פיזיות עבור הקוד והנתונים שלהם. דפים אלו מסומנים כקריאה בלבד (read-only) בטבלאות הדפים של שני התהליכים. הקצאה של עותקים חדשים מתרחשת רק כאשר אחד מהתהליכים מנסה לכתוב לדף משותף (כלומר, נוצר Page Fault מסוג Write-Protection).\n    *   (הערה: טבלת הדפים של הבן עצמה תוקצה ותתפוס מסגרות פיזיות, אך השאלה מתייחסת ספציפית ל\"קוד ונתונים\" ולא לטבלאות הדפים).\n\n3.  **מסגרות פיזיות נוספות לאחר כתיבת הבן:**\n    *   תהליך הבן מבצע שינוי ב-1MB של הנתונים שלו. 1MB = 1 * 1024 KB.\n    *   מספר הדפים המושפעים: (1 * 1024 KB) / 4 KB = 256 דפים.\n    *   כיוון שהדפים הללו היו משותפים ומסומנים כ-COW, ניסיון הכתיבה של הבן לדף משותף יוביל ל-Page Fault. במסגרת הטיפול ב-Page Fault, המערכת תבצע העתקה של הדף המשותף למסגרת פיזית חדשה שהוקצתה באופן בלעדי לבן. תהליך זה יחזור על עצמו עבור כל אחד מ-256 הדפים בהם הבן כתב.\n    *   לכן, יוקצו 256 מסגרות פיזיות נוספות במערכת.\n\n4.  **השפעה על האב לאחר כתיבת הבן:**\n    *   **קוד:** כן, הקוד של תהליך האב עדיין משתף את אותן מסגרות פיזיות עם הבן. קוד הוא בדרך כלל read-only, ולכן לא מתבצעת כתיבה לדפי הקוד, ומנגנון COW אינו מופעל עבורם. הם נשארים משותפים.\n    *   **נתונים:** לא, עבור 1MB הנתונים שהבן שינה, האב והבן כבר לא חולקים את אותן מסגרות פיזיות. כל אחד מהם מחזיק עותק משלו. עבור שאר 7MB הנתונים (8MB - 1MB = 7MB) שלא שונו על ידי הבן, הם עדיין משותפים בין האב לבן ומסומנים כ-COW.\n    *   **נימוק:** מנגנון COW מבצע העתקה רק כאשר מתבצעת כתיבה לדף משותף. מכיוון שהקוד אינו נכתב, הוא נשאר משותף. רק הדפים הספציפיים מתוך הנתונים שהבן שינה הועתקו, והשאר נשארו משותפים עד לניסיון כתיבה נוסף."
    },
    "difficulty_estimation": "Medium"
  }
}