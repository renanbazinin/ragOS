{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Context Switching",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 07:08:35",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2388,
      "output_tokens": 1650,
      "total_tokens": 6883
    }
  },
  "question": {
    "id": 4,
    "type": "Open",
    "topic": [
      "Context Switching"
    ],
    "content": {
      "text": "הסבר בפירוט את תהליך החלפת הקשר (Context Switch) בין שני תהליכים (Processes) במערכת הפעלה מודרנית. ציין את השלבים העיקריים המעורבים בתהליך זה, אילו רכיבים של מערכת ההפעלה או החומרה לוקחים בו חלק פעיל, וכיצד תהליך זה משפיע על ביצועי המערכת הכוללים. התייחס להבדלים פוטנציאליים בין החלפת קשר בין תהליכים להחלפת קשר בין תהליכונים (Threads) באותו תהליך.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "הסבר מפורט של תהליך החלפת הקשר:\n\n**שלבים עיקריים בהחלפת קשר:**\n1.  **שמירת מצב התהליך הנוכחי:** כאשר מתרחשת סיבה להחלפת קשר (לדוגמה, פסיקה של טיימר, קריאת מערכת I/O חוסמת, או סיום קוונטום זמן), ליבת מערכת ההפעלה שומרת את המצב המלא של התהליך הרץ כעת (הקשר שלו). זה כולל: תוכן אוגרי ה-CPU (מונה התוכנית - PC, מצביע המחסנית - SP, אוגרים כלליים), מצב האוגרים צפים (floating point registers), מידע על מרחב הכתובות (אם רלוונטי), ועוד. מידע זה נשמר בבלוק בקרת התהליך (PCB - Process Control Block) של התהליך בזיכרון.\n2.  **בחירת התהליך הבא:** המתזמן (Scheduler) של מערכת ההפעלה בוחר את התהליך הבא שירוץ, בהתאם לאלגוריתם התזמון הנהוג.\n3.  **טעינת מצב התהליך החדש:** ליבת מערכת ההפעלה טוענת את המצב השמור (הקשר) של התהליך החדש שנבחר מתוך ה-PCB שלו אל אוגרי ה-CPU. זה כולל טעינה מחדש של ה-PC, ה-SP ושאר האוגרים.\n4.  **המשך ביצוע:** ה-CPU מתחיל לבצע את ההוראות של התהליך החדש, החל מהנקודה שבה הופסק בפעם האחרונה.\n\n**רכיבים פעילים בתהליך:**\n*   **מעבד (CPU):** מבצע את הוראות שמירת וטעינת הקשר, ומחזיק את האוגרים.\n*   **ליבת מערכת ההפעלה (OS Kernel):** אחראית על ניהול ה-PCBs/TCBs, הפעלת המתזמן, וביצוע פעולות השמירה והטעינה של הקשר.\n*   **יחידת ניהול זיכרון (MMU - Memory Management Unit):** במקרה של החלפת קשר בין תהליכים, ה-MMU עשויה להידרש לטעון מחדש את טבלאות הדפים (page tables) כדי למפות את מרחב הכתובות הווירטואלי של התהליך החדש לזיכרון הפיזי. זה כרוך לעיתים גם בניקוי ה-TLB (Translation Lookaside Buffer).\n*   **בקר פסיקות (Interrupt Controller):** יוזם לעיתים קרובות את הצורך בהחלפת קשר באמצעות פסיקות (לדוגמה, פסיקת טיימר).\n\n**השפעה על ביצועי המערכת:**\n*   **תקורה (Overhead):** החלפת קשר כרוכה בזמן CPU שאינו מוקדש לעבודה שימושית של התוכניות. זמן זה כולל את פעולות השמירה והטעינה של הקשר, הפעלת המתזמן, ופעולות נלוות כמו ניקוי מטמונים (cache) ו-TLB במקרה של תהליכים.\n*   **ירידה בתפוקה (Throughput):** ככל שיש יותר החלפות קשר, כך פחות זמן מוקדש לביצוע עבודת התוכניות בפועל, מה שמוביל לירידה בתפוקה הכוללת של המערכת.\n*   **השפעה על מטמונים (Cache/TLB):** כאשר מתבצעת החלפת קשר בין תהליכים, סביר להניח שהתהליך החדש יגש לנתונים והוראות שונים לחלוטין. הדבר עלול לגרום ל-\"Cache Misses\" רבים ול-\"TLB Flushes\", מה שמפחית את יעילות המטמונים ומאט את הגישה לזיכרון.\n*   **חיוניות:** למרות התקורה, החלפת קשר חיונית למערכות הפעלה מודרניות כדי לאפשר ריבוי משימות (multitasking), תגובתיות למשתמש, וניצול יעיל של ה-CPU.\n\n**הבדלים בין החלפת קשר בין תהליכים (Processes) להחלפת קשר בין תהליכונים (Threads) באותו תהליך:**\n*   **מרחב כתובות:** כאשר מתבצעת החלפת קשר בין תהליכים, יש צורך לשנות את מרחב הכתובות הווירטואלי. זה דורש עדכון של טבלאות הדפים ב-MMU ולעיתים קרובות ניקוי של ה-TLB, מה שמוסיף לתקורה. לעומת זאת, תהליכונים באותו תהליך חולקים את אותו מרחב כתובות, ולכן החלפת קשר ביניהם אינה דורשת שינוי של טבלאות הדפים או ניקוי TLB, מה שהופך אותה למהירה יותר ובעלת תקורה נמוכה יותר.\n*   **משאבים משותפים:** תהליכונים חולקים משאבים רבים (כגון קוד, נתונים, קבצים פתוחים) בעוד שתהליכים אינם חולקים אותם כברירת מחדל. לכן, שמירת וטעינת הקשר של תהליכון קטנה יותר מבחינת כמות המידע שיש לשמור/לטעון, שכן רק מצב ה-CPU הספציפי לתהליכון (אוגרים, מצביע מחסנית) צריך להישמר, ולא את כל מרחב הכתובות של התהליך."
    },
    "difficulty_estimation": "Medium"
  }
}