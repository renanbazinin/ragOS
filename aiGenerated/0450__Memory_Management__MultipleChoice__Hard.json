{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Memory Management",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 21:35:16",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 1364,
      "total_tokens": 6389
    }
  },
  "question": {
    "id": 1,
    "type": "MultipleChoice",
    "topic": [
      "Memory Management",
      "Heap Allocation",
      "Fragmentation"
    ],
    "content": {
      "text": "נתונה מערכת ניהול זיכרון המשתמשת באלגוריתם First-Fit להקצאת זיכרון, ומעגלת כל בקשת הקצאה לגודל הקרוב ביותר שהוא כפולה של 16 בתים. גודל הערימה (heap) הכולל הוא 256 בתים, ובתחילה הוא בלוק פנוי אחד בגודל 256 בתים.\nבוצעו הפעולות הבאות ברצף:\n",
      "code_snippet": "void* ptr1 = malloc(20);\nvoid* ptr2 = malloc(10);\nvoid* ptr3 = malloc(40);\nvoid* ptr4 = malloc(5);\nfree(ptr2);\nfree(ptr4);\nvoid* ptr5 = malloc(30);",
      "options": [
        "א. 0 בתים",
        "ב. 16 בתים",
        "ג. 32 בתים",
        "ד. 128 בתים",
        "ה. 144 בתים"
      ]
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ב",
      "explanation": "נבחן את מצב הערימה לאחר כל שלב, כאשר כל הקצאה מעוגלת לכפולה הקרובה ביותר של 16 בתים, והאלגוריתם הוא First-Fit:\n\n*   **התחלה**: [F: 256] (בלוק פנוי של 256 בתים)\n*   **1. `malloc(20)`**: מעוגל ל-32 בתים. הערימה: [U: 32 (ptr1)] [F: 224]\n*   **2. `malloc(10)`**: מעוגל ל-16 בתים. הערימה: [U: 32 (ptr1)] [U: 16 (ptr2)] [F: 208]\n*   **3. `malloc(40)`**: מעוגל ל-48 בתים. הערימה: [U: 32 (ptr1)] [U: 16 (ptr2)] [U: 48 (ptr3)] [F: 160]\n*   **4. `malloc(5)`**: מעוגל ל-16 בתים. הערימה: [U: 32 (ptr1)] [U: 16 (ptr2)] [U: 48 (ptr3)] [U: 16 (ptr4)] [F: 144]\n\n*   **5. `free(ptr2)`**: משחרר את הבלוק בגודל 16 בתים. אין איחוד (coalescing) כי הבלוק מוקף בבלוקים תפוסים.\n    הערימה: [U: 32 (ptr1)] [F: 16 (ptr2)] [U: 48 (ptr3)] [U: 16 (ptr4)] [F: 144]\n\n*   **6. `free(ptr4)`**: משחרר את הבלוק בגודל 16 בתים. הבלוק ששוחרר (`ptr4`) צמוד לבלוק הפנוי הגדול (144 בתים), ולכן מתבצע איחוד: [F: 16 (ptr4)] [F: 144] הופך ל- [F: 160].\n    הערימה: [U: 32 (ptr1)] [F: 16 (ptr2)] [U: 48 (ptr3)] [F: 160]\n    הבלוקים הפנויים כעת הם 16 בתים ו-160 בתים.\n\n*   **7. `malloc(30)`**: מעוגל ל-32 בתים. אלגוריתם First-Fit יחפש את הבלוק הפנוי הראשון בגודל מספק.\n    הבלוק הראשון (16 בתים) קטן מדי.\n    הבלוק השני (160 בתים) גדול מספיק. יוקצו ממנו 32 בתים, ויישאר בלוק פנוי של 128 בתים.\n    הערימה: [U: 32 (ptr1)] [F: 16 (ptr2)] [U: 48 (ptr3)] [U: 32 (ptr5)] [F: 128]\n\nבסיום כל הפעולות, קיימים שני בלוקים פנויים: אחד בגודל 16 בתים, ואחד בגודל 128 בתים.\n\n*   **סך הזיכרון הפנוי**: 16 + 128 = 144 בתים.\n*   **הבלוק הפנוי הגדול ביותר**: 128 בתים.\n\nפיצול חיצוני (external fragmentation) מוגדר כסך הזיכרון הפנוי שאינו יכול לשמש להקצאה אחת, כלומר סך הזיכרון הפנוי פחות גודל הבלוק הפנוי הגדול ביותר.\nפיצול חיצוני = (סך הזיכרון הפנוי) - (גודל הבלוק הפנוי הגדול ביותר)\nפיצול חיצוני = 144 - 128 = 16 בתים.\n\nלכן התשובה הנכונה היא ב'."
    },
    "difficulty_estimation": "Hard"
  }
}