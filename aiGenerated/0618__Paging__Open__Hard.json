{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 06:48:22",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4788,
      "output_tokens": 3880,
      "total_tokens": 15691
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Paging",
      "Virtual Memory",
      "TLB",
      "Memory Management"
    ],
    "content": {
      "text": "נתונה מערכת זיכרון וירטואלי המשתמשת בטבלת דפים היררכית דו-רמתית (Two-Level Paging). גודל הדף במערכת הוא 4KB. כתובות וירטואליות הן בגודל 32 ביטים וכתובות פיזיות הן בגודל 28 ביטים. כל כניסה בטבלת הדפים (PTE) היא בגודל 4 בתים (32 ביטים) ומכילה את השדות הבאים (מימין לשמאל):\n*   16 ביטים עבור PFN (מספר מסגרת פיזית)\n*   1 ביט Valid (V) - מציין אם הכניסה חוקית\n*   1 ביט Present (P) - מציין אם הדף נמצא בזיכרון פיזי\n*   1 ביט Dirty (D) - מציין אם הדף שונה\n*   1 ביט Accessed (A) - מציין אם הדף ניגש\n*   12 ביטים שמורים (Reserved)\n\nהמערכת משתמשת באוגר Page Table Root Register (PTRR) המכיל את הכתובת הפיזית של טבלת הדפים ברמה הראשונה (L1 Page Table).\n\nיש לפרט ולנמק את כל החישובים.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "נתון כי ה-PTRR מכיל את הכתובת הפיזית `0x10000000`.\n*   ה-PTE עבור כניסה מספר 1 בטבלת הדפים L1 (כלומר, עבור VPN L1 = 1) מכיל PFN=`0x20000` כאשר V=1, P=1, D=0, A=1.\n*   ה-PTE עבור כניסה מספר 1 בטבלת הדפים L2 (כלומר, עבור VPN L2 = 1) מכיל PFN=`0x30005` כאשר V=1, P=1, D=1, A=1.\nבצעו תרגום כתובת עבור הכתובת הוירטואלית `0x0040105C`. האם תתרחש פסיקת דף (Page Fault)? אם לא, מהי הכתובת הפיזית המתקבלת? פרטו את כל השלבים.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "המערכת כוללת גם Translation Lookaside Buffer (TLB) עם 4 כניסות, בשיטת Fully Associative, ואלגוריתם החלפה LRU.\nזמני גישה:\n*   זמן גישה ל-TLB: 10ns\n*   זמן גישה לזיכרון פיזי (לדף נתונים או לטבלת דפים): 80ns\nחשבו את זמן הגישה האפקטיבי הממוצע (Effective Access Time) עבור רצף הגישות הוירטואליות הבא:\n`0x0040105C`, `0x00401060`, `0x00402010`, `0x00501000`, `0x0040105C`, `0x00402010`\nיש להניח שה-TLB ריק בתחילת הרצף. פרטו את מצב ה-TLB ואת סוג הגישה (Hit/Miss) עבור כל פנייה.",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "**ניתוח מבנה הכתובת:**\n*   גודל דף: 4KB = 2^12 בתים. לכן, ההיסט (Offset) הוא 12 ביטים.\n*   כתובת וירטואלית: 32 ביטים. מספר הדף הוירטואלי (VPN) הוא 32 - 12 = 20 ביטים.\n*   גודל PTE: 4 בתים.\n*   גודל טבלת דפים (כמספר כניסות בדף אחד): 4KB / 4 בתים = 1024 כניסות.\n*   מכיוון שיש 1024 כניסות בכל טבלה, כל אינדקס (L1, L2) דורש 10 ביטים (2^10 = 1024).\n*   פירוק ה-VPN (20 ביטים): 10 ביטים לאינדקס L1, 10 ביטים לאינדקס L2.\n*   מבנה כתובת וירטואלית: `[L1 Index (10 ביטים)] [L2 Index (10 ביטים)] [Offset (12 ביטים)]`\n*   כתובת פיזית: 28 ביטים. PFN הוא 16 ביטים (28 - 12 = 16).\n\n**1. תרגום כתובת עבור 0x0040105C:**\nהכתובת הוירטואלית `0x0040105C` בבינארי: `0000 0000 0100 0000 0001 0000 0101 1100`\n*   **L1 Index**: 10 הביטים הראשונים = `0000000001` = 1 (בבסיס 10)\n*   **L2 Index**: 10 הביטים הבאים = `0000000001` = 1 (בבסיס 10)\n*   **Offset**: 12 הביטים האחרונים = `000001011100` = 156 (בבסיס 10) או `0x05C` (בבסיס 16)\n\n**שלבי התרגום:**\nא.  **גישה לטבלת דפים L1**:\n    *   ה-PTRR מכיל `0x10000000`.\n    *   כתובת ה-PTE בטבלת L1 עבור אינדקס 1: `PTRR + (L1_Index * sizeof(PTE))`\n        `0x10000000 + (1 * 4) = 0x10000004`\n    *   קריאת ה-PTE מכתובת זו: PFN = `0x20000`, V=1, P=1 (כלומר, הכניסה חוקית והדף קיים בזיכרון פיזי).\n    *   ה-PFN של ה-PTE ב-L1 מצביע על הכתובת הפיזית של טבלת L2.\n        כתובת בסיס טבלת L2: `0x20000` << 12 (להוספת ביטי היסט אפס) = `0x20000000`.\n\nב.  **גישה לטבלת דפים L2**:\n    *   כתובת בסיס טבלת L2: `0x20000000`.\n    *   כתובת ה-PTE בטבלת L2 עבור אינדקס 1: `Base_L2 + (L2_Index * sizeof(PTE))`\n        `0x20000000 + (1 * 4) = 0x20000004`\n    *   קריאת ה-PTE מכתובת זו: PFN = `0x30005`, V=1, P=1 (כלומר, הכניסה חוקית והדף קיים בזיכרון פיזי).\n    *   ה-PFN של ה-PTE ב-L2 הוא מספר המסגרת הפיזית של הדף המבוקש.\n\nג.  **בניית הכתובת הפיזית**:\n    *   מספר מסגרת פיזית (PFN) = `0x30005`\n    *   Offset = `0x05C`\n    *   כתובת פיזית = `(PFN << 12) | Offset`\n        `(0x30005 << 12) | 0x05C`\n        `0x30005000 | 0x05C = 0x3000505C`\n\n**מסקנה**: לא תתרחש פסיקת דף מכיוון שגם ה-PTE ב-L1 וגם ה-PTE ב-L2 תקינים (V=1) וקיימים בזיכרון (P=1). הכתובת הפיזית המתקבלת היא `0x3000505C`.\n\n**2. חישוב זמן גישה אפקטיבי עם TLB:**\n**מצב התחלתי**: TLB ריק.\n*   זמן גישה ל-TLB: 10ns\n*   זמן גישה לזיכרון פיזי: 80ns\n*   זמן גישה ב-TLB Hit: TLB Access + Memory Access = 10ns + 80ns = 90ns\n*   זמן גישה ב-TLB Miss (ללא Page Fault): TLB Access + L1 PT Access + L2 PT Access + Memory Access = 10ns + 80ns + 80ns + 80ns = 250ns\n*   זמן גישה ב-Page Fault: 10ms (הערכה גבוהה בהרבה)\n\n**רצף גישות וירטואליות (VPN, PFN עבורו, מצב TLB, זמן):**\n1.  **VA: `0x0040105C`** (VPN: `0x00401`, Offset: `0x05C`)\n    *   **TLB Miss**: TLB ריק. תרגום כתובת (כמו בסעיף 1) מוצא PFN=`0x30005`.\n    *   הוספה ל-TLB: `(VPN: 0x00401, PFN: 0x30005)`. מצב TLB: `[(0x00401, 0x30005) - LRU=0]`\n    *   זמן גישה: 250ns\n\n2.  **VA: `0x00401060`** (VPN: `0x00401`, Offset: `0x060`)\n    *   **TLB Hit**: ה-VPN `0x00401` נמצא ב-TLB.\n    *   זמן גישה: 90ns\n    *   עדכון LRU: `[(0x00401, 0x30005) - LRU=1]`\n\n3.  **VA: `0x00402010`** (VPN: `0x00402`, Offset: `0x010`)\n    *   **TLB Miss**: ה-VPN `0x00402` אינו ב-TLB. (נניח תרגום כתובת מוצא PFN=`0x30006` ללא Page Fault).\n    *   הוספה ל-TLB: `(VPN: 0x00402, PFN: 0x30006)`. מצב TLB: `[(0x00401, 0x30005) - LRU=1], [(0x00402, 0x30006) - LRU=0]`\n    *   זמן גישה: 250ns\n\n4.  **VA: `0x00501000`** (VPN: `0x00501`, Offset: `0x000`)\n    *   **TLB Miss**: ה-VPN `0x00501` אינו ב-TLB. (נניח תרגום כתובת מוצא PFN=`0x30007` ללא Page Fault).\n    *   הוספה ל-TLB: `(VPN: 0x00501, PFN: 0x30007)`. מצב TLB: `[(0x00401, 0x30005) - LRU=1], [(0x00402, 0x30006) - LRU=0], [(0x00501, 0x30007) - LRU=0]`\n    *   זמן גישה: 250ns\n\n5.  **VA: `0x0040105C`** (VPN: `0x00401`, Offset: `0x05C`)\n    *   **TLB Hit**: ה-VPN `0x00401` נמצא ב-TLB.\n    *   זמן גישה: 90ns\n    *   עדכון LRU (הכי לאחרונה בשימוש): `[(0x00401, 0x30005) - LRU=2], [(0x00402, 0x30006) - LRU=0], [(0x00501, 0x30007) - LRU=1]`\n\n6.  **VA: `0x00402010`** (VPN: `0x00402`, Offset: `0x010`)\n    *   **TLB Hit**: ה-VPN `0x00402` נמצא ב-TLB.\n    *   זמן גישה: 90ns\n    *   עדכון LRU: `[(0x00401, 0x30005) - LRU=1], [(0x00402, 0x30006) - LRU=2], [(0x00501, 0x30007) - LRU=0]`\n\n**סיכום זמנים:**\n*   סה\"כ TLB Misses: 3 (גישות 1, 3, 4)\n*   סה\"כ TLB Hits: 3 (גישות 2, 5, 6)\n*   זמן כולל עבור Misses: 3 * 250ns = 750ns\n*   זמן כולל עבור Hits: 3 * 90ns = 270ns\n*   סה\"כ זמן עבור 6 גישות: 750ns + 270ns = 1020ns\n*   זמן גישה אפקטיבי ממוצע: 1020ns / 6 = 170ns\n\n**הערה חשובה לגבי סעיף 2**: כדי לפשט את הפתרון ולא להוסיף מידע מפורט על ה-PTEs עבור ה-VPNs הנוספים, הנחנו שכל הגישות הללו אינן גורמות ל-Page Faults (כלומר, ה-V וה-P ביטים תמיד 1 עבור הדפים הרלוונטיים). הנחה זו סבירה בהיעדר מידע מפורש אחר, כאשר המיקוד הוא בחישובים הקשורים ל-TLB."
    },
    "difficulty_estimation": "Hard"
  }
}