{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Context Switching",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 07:06:31",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 1096,
      "total_tokens": 4692
    }
  },
  "question": {
    "id": 1,
    "type": "MultipleChoice",
    "topic": [
      "Context Switching",
      "Memory Hierarchy",
      "TLB",
      "Caches"
    ],
    "content": {
      "text": "בהתחלף הקשר (context switch) בין שני תהליכים נפרדים (ולא בין תהליכים מאותו תהליך), איזו מהטענות הבאות מתארת בצורה המדויקת ביותר את ההשפעה המיידית על מצב המעבד והיררכיית הזיכרון, בהנחה שארכיטקטורה מודרנית טיפוסית עם TLB מנוהל חומרה ומטמונים (L1, L2, L3) המתויגים פיזית (physically tagged)?",
      "code_snippet": null,
      "options": [
        "א. ה-TLB כולו חייב להישטף (flush), וכל רמות המטמון של המעבד (L1, L2, L3) המכילות נתונים ספציפיים לתהליך גם כן מבוטלות לחלוטין, מה שמוביל למטמונים ריקים (\"קרים\") עבור התהליך החדש.",
        "ב. ה-TLB בדרך כלל דורש שטיפה (flushing) או שינוי של רגיסטר הבסיס של טבלת הדפים של התהליך (לדוגמה, CR3 ב-x86) אשר מבטל באופן מרומז כניסות TLB רלוונטיות. מטמוני המעבד (L1, L2, L3) הם בדרך כלל ממוענים פיזית ואינם דורשים שטיפה מפורשת, אך התהליך החדש צפוי לחוות שיעור גבוה של החטאות מטמון (cache misses) בתחילה עקב גישה למיקומי זיכרון פיזיים שונים.",
        "ג. רק הרגיסטרים במצב משתמש (user-mode registers) צריכים להינצל ולשוחזר. לא ה-TLB ולא מטמוני המעבד מושפעים, שכן תוכנם משותף גלובלית לכל התהליכים.",
        "ד. ה-TLB אינו מושפע מכיוון שכתובות וירטואליות הן ספציפיות לתהליך, והחומרה מטפלת במיפוי באופן אוטומטי. מטמוני המעבד, לעומת זאת, חייבים להישטף לחלוטין כדי למנוע דליפת נתונים בין תהליכים."
      ]
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ב",
      "explanation": "ב. כאשר מתבצע התחלף הקשר בין שני תהליכים נפרדים, מרחב הכתובות הווירטואלי משתנה לחלוטין. ה-TLB (Translation Lookaside Buffer) שומר תרגומים אחרונים של כתובות וירטואליות לכתובות פיזיות. כדי למנוע מהתהליך החדש להשתמש בתרגומים מיושנים השייכים לתהליך הקודם, יש לבטל (invalidate) את כניסות ה-TLB. ברוב הארכיטקטורות המודרניות, שינוי רגיסטר בסיס טבלת הדפים (כגון CR3 ב-x86) גורם לביטול אוטומטי של כל או חלק גדול מה-TLB. לעומת זאת, מטמוני המעבד (L1, L2, L3) בדרך כלל מתויגים פיזית (physically tagged), כלומר הם שומרים נתונים לפי כתובות פיזיות. מכיוון שהתהליכים השונים פועלים במרחבי זיכרון פיזיים שונים (או במרחבים וירטואליים הממופים לפיזיים שונים), אין צורך לבצע שטיפה מפורשת של המטמונים. עם זאת, התהליך החדש יגש לנתונים במיקומים פיזיים שונים מאלה שהיו בשימוש התהליך הקודם, ולכן יחווה בתחילה מספר רב של החטאות מטמון (cache misses) עד שסט העבודה שלו ימלא מחדש את המטמון. זהו אפקט \"מטמון קר\" (cold cache) שמשפיע על הביצועים אך אינו דורש שטיפה מפורשת של המטמון."
    },
    "difficulty_estimation": "Hard"
  }
}