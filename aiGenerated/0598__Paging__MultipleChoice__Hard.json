{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 22:56:25",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 2216,
      "total_tokens": 8615
    }
  },
  "question": {
    "id": 10,
    "type": "MultipleChoice",
    "topic": [
      "Paging",
      "Virtual Memory",
      "Multi-level Paging",
      "Page Table Size"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המשתמשת בכתובות וירטואליות בגודל 64 ביט, ובכתובות פיזיות בגודל 48 ביט. המערכת מיישמת paging רב-שכבתי (multi-level paging) עם 4 רמות, כאשר כל טבלת דפים (page table) היא בגודל 4KB וכל ערך בטבלת דפים (PTE) הוא בגודל 8 בתים.\nתהליך מסוים ממפה באופן רציף 4GB של זיכרון וירטואלי, החל מכתובת 0.\nבהתבסס על ההנחה כי 16 הביטים העליונים של הכתובת הוירטואלית מוזנחים (canonical addressing), איזו מהטענות הבאות נכונה לגבי סך הזיכרון הנדרש לטבלאות הדפים עבור תהליך זה במקרים הבאים?",
      "code_snippet": null,
      "options": [
        "א. כאשר גודל דף הוא 4KB, נדרשים 8MB + 24KB לטבלאות הדפים. כאשר גודל דף הוא 2MB, נדרשים 24KB לטבלאות הדפים.",
        "ב. כאשר גודל דף הוא 4KB, נדרשים 8MB לטבלאות הדפים. כאשר גודל דף הוא 2MB, נדרשים 16KB לטבלאות הדפים.",
        "ג. כאשר גודל דף הוא 4KB, נדרשים 2MB + 24KB לטבלאות הדפים. כאשר גודל דף הוא 2MB, נדרשים 24KB לטבלאות הדפים.",
        "ד. כאשר גודל דף הוא 4KB, נדרשים 8MB + 16KB לטבלאות הדפים. כאשר גודל דף הוא 2MB, נדרשים 16KB לטבלאות הדפים.",
        "ה. אף אחת מהתשובות אינה נכונה."
      ]
    },
    "sub_questions": null,
    "points": 5,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "א",
      "explanation": "ההסבר מבוסס על חישוב הזיכרון הנדרש לטבלאות דפים עבור כל אחד מהמקרים:\n\n**נתונים:**\n*   כתובת וירטואלית אפקטיבית: 48 ביט (בהתעלם מ-16 הביטים העליונים, כפי שנהוג ב-canonical addressing).\n*   גודל טבלת דפים: 4KB (4096 בתים).\n*   גודל ערך בטבלת דפים (PTE): 8 בתים.\n*   מספר ערכים בטבלת דפים יחידה: 4096 / 8 = 512 ערכים.\n*   כל רמה בטבלת הדפים משתמשת ב- log2(512) = 9 ביטים לאינדוקס.\n*   תהליך ממפה 4GB של זיכרון וירטואלי רציף, החל מ-0 (כלומר 2^32 בתים).\n\n**מקרה א': גודל דף = 4KB**\n*   **Offset:** 12 ביטים (log2(4KB)).\n*   **מספר ביטים לכתובת דף וירטואלי (VPN):** 48 - 12 = 36 ביטים.\n*   מאחר שכל רמה משתמשת ב-9 ביטים, נדרשות 36 / 9 = 4 רמות של טבלאות דפים (בדרך כלל PML4, PDPT, PD, PT).\n*   **מספר דפים וירטואליים בגודל 4KB:** 4GB / 4KB = (2^32) / (2^12) = 2^20 דפים.\n\n1.  **טבלאות דפים (PTs - רמה 1):** כל PT מכיל 512 PTEs וממפה 512 דפים.\n    *   מספר ה-PTs הנדרשים: 2^20 דפים / 512 דפים ל-PT = 2^20 / 2^9 = 2^11 = 2048 PTs.\n    *   זיכרון עבור PTs: 2048 PTs * 4KB/PT = 8MB.\n\n2.  **מדרכי דפים (PDs - רמה 2):** כל PD מכיל 512 PTEs ומצביע על 512 PTs.\n    *   מספר ה-PDs הנדרשים: 2048 PTs / 512 PTs ל-PD = 4 PDs.\n    *   זיכרון עבור PDs: 4 PDs * 4KB/PD = 16KB.\n\n3.  **מדרכי דפים מצביעים (PDPTs - רמה 3):** כל PDPT מכיל 512 PTEs ומצביע על 512 PDs.\n    *   מספר ה-PDPTs הנדרשים: 4 PDs / 512 PDs ל-PDPT = 1 PDPT (כי 4 קטן מ-512).\n    *   זיכרון עבור PDPTs: 1 PDPT * 4KB/PDPT = 4KB.\n\n4.  **טבלת PML4 (רמה 4):** כל PML4 מכיל 512 PTEs ומצביע על 512 PDPTs.\n    *   מספר ה-PML4s הנדרשים: 1 PDPT / 512 PDPTs ל-PML4 = 1 PML4 (כי 1 קטן מ-512).\n    *   זיכרון עבור PML4s: 1 PML4 * 4KB/PML4 = 4KB.\n\n*   **סה\"כ זיכרון לטבלאות דפים במקרה א':** 8MB + 16KB + 4KB + 4KB = 8MB + 24KB.\n\n**מקרה ב': גודל דף = 2MB (דפים גדולים - Huge Pages)**\n*   **Offset:** 21 ביטים (log2(2MB)).\n*   **מספר ביטים לכתובת דף וירטואלי (VPN):** 48 - 21 = 27 ביטים.\n*   מאחר שכל רמה משתמשת ב-9 ביטים, נדרשות 27 / 9 = 3 רמות של טבלאות דפים. במקרה זה, הרמה הנמוכה ביותר (PD) מצביעה ישירות על דפים פיזיים בגודל 2MB.\n*   **מספר דפים וירטואליים בגודל 2MB:** 4GB / 2MB = (2^32) / (2^21) = 2^11 = 2048 דפים.\n\n1.  **מדרכי דפים (PDs - רמה 1, מצביעה על דפים פיזיים):** כל PD מכיל 512 PTEs וממפה 512 דפים בגודל 2MB.\n    *   מספר ה-PDs הנדרשים: 2^11 דפים / 512 דפים ל-PD = 2^11 / 2^9 = 2^2 = 4 PDs.\n    *   זיכרון עבור PDs: 4 PDs * 4KB/PD = 16KB.\n\n2.  **מדרכי דפים מצביעים (PDPTs - רמה 2):** כל PDPT מכיל 512 PTEs ומצביע על 512 PDs.\n    *   מספר ה-PDPTs הנדרשים: 4 PDs / 512 PDs ל-PDPT = 1 PDPT.\n    *   זיכרון עבור PDPTs: 1 PDPT * 4KB/PDPT = 4KB.\n\n3.  **טבלת PML4 (רמה 3):** כל PML4 מכיל 512 PTEs ומצביע על 512 PDPTs.\n    *   מספר ה-PML4s הנדרשים: 1 PDPT / 512 PDPTs ל-PML4 = 1 PML4.\n    *   זיכרון עבור PML4s: 1 PML4 * 4KB/PML4 = 4KB.\n\n*   **סה\"כ זיכרון לטבלאות דפים במקרה ב':** 16KB + 4KB + 4KB = 24KB.\n\nלכן, התשובה הנכונה היא א'."
    },
    "difficulty_estimation": "Hard"
  }
}