{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Semaphores",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Easy",
    "generated_at": "2026-02-07 20:56:48",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3853,
      "output_tokens": 925,
      "total_tokens": 6848
    }
  },
  "question": {
    "id": 1,
    "type": "CodeAnalysis",
    "topic": [
      "Semaphores",
      "Synchronization",
      "Threads",
      "Concurrency"
    ],
    "content": {
      "text": "נתונה התוכנית הבאה המשתמשת בסמפור. יש לנתח את קוד התוכנית ולענות על השאלה:\n\nמהו הפלט המובטח (Guaranteed Output) של התוכנית? הסבר מדוע.\n",
      "code_snippet": "#include <semaphore.h>\n#include <pthread.h>\n#include <stdio.h>\n#include <unistd.h>\n\nsem_t sem;\n\nvoid* thread_func1(void* arg) {\n    printf(\"A\\n\");\n    sem_post(&sem);\n    return NULL;\n}\n\nvoid* thread_func2(void* arg) {\n    sem_wait(&sem);\n    printf(\"B\\n\");\n    return NULL;\n}\n\nint main() {\n    pthread_t tid1, tid2;\n\n    // Initialize semaphore to 0\n    sem_init(&sem, 0, 0);\n\n    pthread_create(&tid1, NULL, thread_func1, NULL);\n    pthread_create(&tid2, NULL, thread_func2, NULL);\n\n    pthread_join(tid1, NULL);\n    pthread_join(tid2, NULL);\n\n    sem_destroy(&sem);\n\n    return 0;\n}\n",
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "הפלט המובטח של התוכנית הוא:\nA\nB\n\nההסבר:\n1.  הסמפור 'sem' מאותחל לערך 0. המשמעות היא שבתחילה, כל קריאה ל-`sem_wait` תחסום את התהליך הקורא עד שערך הסמפור יהפוך לחיובי.\n2.  `thread_func1` (הפונקציה של tid1) מדפיסה קודם כל את התו 'A' ולאחר מכן מבצעת `sem_post(&sem)`. פעולה זו מגדילה את ערך הסמפור מ-0 ל-1 (או מכל ערך קודם ב-1).\n3.  `thread_func2` (הפונקציה של tid2) מבצעת קודם כל `sem_wait(&sem)` ולאחר מכן מדפיסה את התו 'B'.\n4.  בגלל ש-`sem_wait` ב-`thread_func2` חייבת להצליח (כלומר, ערך הסמפור חייב להיות גדול מ-0) לפני ש-`thread_func2` יכולה להמשיך ולהדפיס 'B', ופעולת ה-`sem_post` שמעלה את ערך הסמפור מתבצעת רק לאחר הדפסת 'A' ב-`thread_func1`, מובטח ש-'A' תמיד יודפס לפני 'B'.\n5.  אם `thread_func2` תנסה לבצע `sem_wait` לפני ש-`thread_func1` ביצעה `sem_post`, היא תחסם. רק לאחר ש-`thread_func1` תדפיס 'A' ותבצע `sem_post`, ערך הסמפור יעלה ל-1, ו-`thread_func2` תוכל להמשיך (לקרוא `sem_wait`, להקטין את ערך הסמפור ל-0, ואז להדפיס 'B').\n\nלכן, הסדר 'A' ואחריו 'B' מובטח."
    },
    "difficulty_estimation": "Easy"
  }
}