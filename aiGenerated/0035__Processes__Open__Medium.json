{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Processes",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 18:17:26",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3602,
      "output_tokens": 902,
      "total_tokens": 5236
    }
  },
  "question": {
    "id": 7,
    "type": "Open",
    "topic": [
      "Processes",
      "Process Creation",
      "fork"
    ],
    "content": {
      "text": "לפניכם קוד בשפת C המשתמש בקריאות המערכת fork ו-wait. הניחו שכל קריאות המערכת מצליחות ושהתהליכים מתזמנים בצורה כזו שכל תהליך אב ממתין לסיום ילדיו לפני הדפסה.",
      "code_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/wait.h>\n\nint main() {\n    int x = 10;\n    pid_t pid1, pid2;\n\n    pid1 = fork();\n    if (pid1 == 0) {\n        x += 5;\n        pid2 = fork();\n        if (pid2 == 0) {\n            x += 5;\n            printf(\"C2: x=%d\\n\", x);\n        } else {\n            wait(NULL);\n            printf(\"C1: x=%d\\n\", x);\n        }\n    } else {\n        wait(NULL);\n        printf(\"P: x=%d\\n\", x);\n    }\n    return 0;\n}",
      "options": null
    },
    "sub_questions": [
      {
        "id": "7.1",
        "text": "כמה תהליכים נוצרו בסך הכל במהלך ריצת התוכנית, כולל התהליך הראשי?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "7.2",
        "text": "מה יהיה הפלט של התוכנית? יש לכתוב את השורות לפי סדר הדפסתן.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "7.3",
        "text": "הסבירו מדוע השינויים במשתנה x בתהליכי הבנים אינם משתקפים בערכו של x בתהליך האב (P).",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "7.1: נוצרו 3 תהליכים בסך הכל. התהליך הראשי (P) מבצע fork ויוצר את C1. התהליך C1 מבצע fork נוסף ויוצר את C2.\n\n7.2: הפלט יהיה:\nC2: x=20\nC1: x=15\nP: x=10\nהסבר: C2 יורש מ-C1 את x=15 ומוסיף 5. C1 מוסיף 5 ל-10 המקורי. האב P נשאר עם 10. בגלל קריאות ה-wait, הסדר מובטח מהנכד לסבא.\n\n7.3: כאשר מתבצע fork, נוצר עותק של מרחב הכתובות של תהליך האב עבור הבן. למרות שהם חולקים קוד, לכל תהליך יש מחסנית (stack) וסגמנט נתונים (data segment) נפרדים משלו. מנגנון Copy-on-Write מוודא שברגע שתהליך מנסה לשנות משתנה, נוצר עותק פיזי נפרד בזיכרון, ולכן שינוי ב-x בתהליך אחד לא ישפיע על האחרים."
    },
    "difficulty_estimation": "Medium"
  }
}