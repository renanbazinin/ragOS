{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Memory Management",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 21:54:40",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1964,
      "output_tokens": 1326,
      "total_tokens": 6480
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Memory Management",
      "Virtual Memory",
      "Paging"
    ],
    "content": {
      "text": "נתונה מערכת עם זיכרון וירטואלי של 2GB וגודל דף של 8KB. נתון שבכל דף/חלק של טבלת הדפים נכנסות 1024 רשומות (PTE / PDE), וגודל רשומת טבלת דפים הוא 4 בתים. יש לפרט ולנמק את כל החישובים.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "מהם הגדלים של ה-VPN וה-PFN במערכת זו?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "כמה רמות דרושות לטבלת הדפים במערכת זו, וכמה ביטים בכתובת הווירטואלית משמשים לכל רמה?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.3",
        "text": "תהליך ביצע הקצאת זיכרון דינמית (malloc) של 10MB. כמה מסגרות יתפסו בזיכרון הראשי בעקבות ביצוע פקודה זו, במקרה המקסימלי?",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": 25,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "1.1. זיכרון וירטואלי של 2GB הוא 2^31 בתים, לכן כתובת וירטואלית היא באורך 31 ביטים. גודל דף הוא 8KB, כלומר 2^13 בתים, לכן ההיסט (Offset) הוא באורך 13 ביטים. מכאן, VPN = 31 - 13 = 18 ביטים.\nגודל רשומת טבלת דפים (PTE) הוא 4 בתים (32 ביטים). בהינתן 5 ביטים של סטטוס (כמקובל במערכות רבות), ה-PFN הוא באורך 32 - 5 = 27 ביטים. (גודל ה-PFN נגזר מגודל ה-PTE ומספר ביטי הסטטוס, ומגדיר את הזיכרון הפיזי המקסימלי הנתמך על ידי ה-PTE).\n\n1.2. מספר הדפים הווירטואליים הכולל בתהליך הוא 2GB / 8KB = 2^31 / 2^13 = 2^18 דפים.\nבכל דף של טבלת הדפים נכנסות 1024 = 2^10 רשומות.\nכדי למפות 2^18 דפים, נצטרך (2^18) / (2^10) = 2^8 רשומות ברמה העליונה. מכיוון ש-2^8 הוא קטן מ-2^10 (מספר הרשומות בדף בודד של טבלת דפים), נצטרך שתי רמות לטבלת הדפים. עבור הרמה התחתונה (ה-VPN התחתון) נשתמש ב-10 ביטים, ועבור הרמה העליונה (ה-VPN העליון) נשתמש ב-8 ביטים. (סה\"כ 10+8=18 ביטים עבור VPN).\n\n1.3. הקצאה של 10MB היא למעשה הקצאה של 10MB / 8KB = (10 * 1024 KB) / 8KB = 10 * 128 = 1280 דפים.\nבמקרה המקסימלי, אם ההקצאה אינה מיושרת לתחילת דף (כלומר, מתחילה באמצע דף ונגמרת באמצע דף אחר), היא יכולה להתפרס על פני 1280 + 1 = 1281 דפים בזיכרון הווירטואלי.\nעבור טבלת הדפים: 1281 רשומות דרושות עבור הדפים שהוקצו. כל דף בטבלת הדפים מכיל 1024 רשומות. לכן, כדי לאחסן 1281 רשומות, נצטרך ⌈1281 / 1024⌉ = 2 דפים של טבלת דפים ברמה השנייה. (2^10 רשומות בדף אחד).\nהדפים הללו עצמם (של טבלת הדפים) צריכים להיות מוקצים בזיכרון הפיזי. הרמה הראשונה של טבלת הדפים (ה-Page Directory) קיימת תמיד ולא נספרת כהקצאה חדשה במקרה זה (אלא אם צוין אחרת).\nסה\"כ מסגרות בזיכרון הראשי במקרה המקסימלי: 1281 (עבור הנתונים) + 2 (עבור דפי טבלת הדפים ברמה השנייה) = 1283 מסגרות."
    },
    "difficulty_estimation": "Medium"
  }
}