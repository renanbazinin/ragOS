{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Synchronization",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 19:00:02",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3136,
      "output_tokens": 760,
      "total_tokens": 5304
    },
    "subject": "Concurrency"
  },
  "question": {
    "id": 10,
    "type": "CodeAnalysis",
    "topic": [
      "Synchronization",
      "Semaphores",
      "Threads"
    ],
    "content": {
      "text": "לפניכם קטע קוד המשתמש בסמפורים לתיאום בין שני חוטים (threads). מה יהיה הפלט של התוכנית בהנחה שכל קריאות המערכת מצליחות והחוטים מסיימים את ריצתם כסדרם?",
      "code_snippet": "#include <stdio.h>\n#include <pthread.h>\n#include <semaphore.h>\n\nsem_t s1, s2;\nint count = 0;\n\nvoid* threadA(void* arg) {\n    for(int i = 0; i < 2; i++) {\n        sem_wait(&s1);\n        printf(\"A\");\n        count++;\n        sem_post(&s2);\n    }\n    return NULL;\n}\n\nvoid* threadB(void* arg) {\n    for(int i = 0; i < 2; i++) {\n        sem_wait(&s2);\n        printf(\"B\");\n        count++;\n        sem_post(&s1);\n    }\n    return NULL;\n}\n\nint main() {\n    sem_init(&s1, 0, 1);\n    sem_init(&s2, 0, 0);\n    pthread_t t1, t2;\n    pthread_create(&t1, NULL, threadA, NULL);\n    pthread_create(&t2, NULL, threadB, NULL);\n    pthread_join(t1, NULL);\n    pthread_join(t2, NULL);\n    printf(\"%d\", count);\n    return 0;\n}",
      "options": [
        "א. ABAB4",
        "ב. BABA4",
        "ג. AABB4",
        "ד. התוכנית תיכנס למצב של Deadlock",
        "ה. ABAB2"
      ]
    },
    "sub_questions": null,
    "points": 10,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "א",
      "explanation": "הסמפור s1 מאותחל ל-1 והסמפור s2 מאותחל ל-0. חוט A הוא היחיד שיכול להתחיל את הלולאה שלו כי sem_wait(&s1) יצליח מיד. חוט A מדפיס 'A', מעלה את count ל-1, ומבצע sem_post(&s2). כעת הערך של s2 הוא 1, מה שמאפשר לחוט B לבצע sem_wait(&s2), להדפיס 'B', להעלות את count ל-2 ולבצע sem_post(&s1). הסמפורים יוצרים סנכרון מסוג 'פינג-פונג' בין החוטים. מכיוון שכל חוט רץ פעמיים, הפלט יהיה ABAB והערך הסופי של count יהיה 4."
    },
    "difficulty_estimation": "Medium"
  }
}