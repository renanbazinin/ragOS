{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Semaphores",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 20:48:16",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2630,
      "output_tokens": 1115,
      "total_tokens": 6530
    },
    "subject": "Concurrency"
  },
  "question": {
    "id": 10,
    "type": "Open",
    "topic": [
      "Synchronization",
      "Semaphores"
    ],
    "content": {
      "text": "מערכת הפעלה מנהלת N מדפסות משותפות המשרתות מספר רב של תהליכונים (threads). כל תהליכון המעוניין להדפיס מסמך חייב לתפוס מדפסת זמינה, להשתמש בה (למשל, לבצע פעולת הדפסה), ולבסוף לשחרר אותה. בכל רגע נתון, רק N תהליכונים יכולים להשתמש במדפסת במקביל. עליך לממש את הפונקציות `acquire_printer()` ו-`release_printer()` תוך שימוש בסמפורים, על מנת להבטיח סנכרון נכון ולמנוע מצב בו יותר מ-N תהליכונים משתמשים במדפסות בו זמנית. הנח כי N הוא מספר שלם חיובי, וכי הסמפורים הדרושים מאותחלים כראוי.",
      "code_snippet": "#include <semaphore.h>\n\n// Assume 'N_PRINTERS' is defined elsewhere, e.g., #define N_PRINTERS 5\n// Assume 'sem_t available_printers;' is declared globally and initialized with N_PRINTERS.\n\nvoid acquire_printer();\nvoid release_printer();",
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "כדי לפתור בעיה זו, נשתמש בסמפור מונה (counting semaphore). סמפור זה ישמש לייצוג מספר המדפסות הזמינות. הוא יאותחל לערך N, המייצג את המספר הכולל של המדפסות במערכת.\n\n**מימוש הפונקציות:**\n\n```c\n#include <semaphore.h>\n#include <stdio.h> // for example usage, not strictly required for the functions themselves\n#include <stdlib.h> // for example usage\n#include <unistd.h> // for sleep in example usage\n\n// הגדרה והאתחול של הסמפור יבוצעו מחוץ לפונקציות, לדוגמה:\n// #define N_PRINTERS 5\n// sem_t available_printers;\n// void init_printers_semaphore() {\n//     sem_init(&available_printers, 0, N_PRINTERS); // 0 for shared within a process\n// }\n\nvoid acquire_printer() {\n    sem_wait(&available_printers); // מקטין את ערך הסמפור; אם ערכו 0, התהליכון נחסם.\n}\n\nvoid release_printer() {\n    sem_post(&available_printers); // מגדיל את ערך הסמפור; אם יש תהליכונים חסומים, אחד מהם ישוחרר.\n}\n```\n\n**הסבר:**\n1.  **סמפור `available_printers`**: סמפור זה מאותחל ל-N, שהוא המספר המקסימלי של מדפסות זמינות.\n2.  **פונקציה `acquire_printer()`**: כאשר תהליכון רוצה להדפיס, הוא קורא ל-`sem_wait(&available_printers)`. פעולה זו מנסה להקטין את ערך הסמפור. אם ערך הסמפור גדול מ-0, הוא מוקטן והתהליכון ממשיך. אם ערך הסמפור הוא 0 (כלומר, כל המדפסות תפוסות), התהליכון נחסם וממתין עד שמדפסת תתפנה.\n3.  **פונקציה `release_printer()`**: לאחר שתהליכון מסיים להשתמש במדפסת, הוא קורא ל-`sem_post(&available_printers)`. פעולה זו מגדילה את ערך הסמפור. אם היו תהליכונים חסומים הממתינים למדפסת, אחד מהם (התלוי בלוח הזמנים של מערכת ההפעלה) ישוחרר כעת ויוכל להמשיך להשתמש במדפסת.\n\nמנגנון זה מבטיח שבכל רגע נתון, לא יותר מ-N תהליכונים יוכלו לגשת למדפסות, ובכך נשמר הסנכרון הנדרש."
    },
    "difficulty_estimation": "Medium"
  }
}