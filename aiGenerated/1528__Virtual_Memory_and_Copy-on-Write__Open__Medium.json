{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Virtual Memory and Copy-on-Write",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 11:10:25",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2412,
      "output_tokens": 1359,
      "total_tokens": 6490
    }
  },
  "question": {
    "id": 10,
    "type": "Open",
    "topic": [
      "Virtual Memory",
      "Copy-on-Write"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה התומכת בזיכרון וירטואלי ובמנגנון Copy-on-Write (CoW). גודל הדף במערכת הוא 4KB. תהליך P1 מקצה מערך בגודל 16MB ומאתחל אותו כולו בערכים מסוימים. לאחר מכן, P1 מבצע קריאת מערכת `fork()` ויוצר תהליך בן P2. בהמשך, תהליך P2 משנה בית בודד בדף יחיד בתוך המערך שהוקצה (לדוגמה, בכתובת המקבילה ל-P2).",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "10.1",
        "text": "כמה דפים פיזיים נצרכים בסך הכל על ידי P1 ו-P2 *מיד לאחר קריאת ה-fork()*, בהנחה שהמערך הוא החלק היחיד שרלוונטי לצריכת זיכרון משותפת? נמק.",
        "code_snippet": null,
        "options": null,
        "solution": {
          "is_present_in_file": true,
          "correct_option": null,
          "explanation": "גודל המערך הוא 16MB וגודל הדף הוא 4KB. לכן, מספר הדפים הנדרשים למערך הוא 16MB / 4KB = (16 * 1024KB) / 4KB = 4 * 1024 = 4096 דפים.\nמיד לאחר קריאת ה-fork(), ובזכות מנגנון ה-Copy-on-Write, תהליך P1 ותהליך P2 חולקים את אותם 4096 דפים פיזיים המכילים את נתוני המערך. כניסות טבלת הדפים (PTEs) עבור דפים אלו מסומנות כ'לקריאה בלבד' (read-only) בשני התהליכים. לכן, סך הכל נצרכים 4096 דפים פיזיים עבור המערך."
        }
      },
      {
        "id": "10.2",
        "text": "כמה דפים פיזיים נצרכים בסך הכל על ידי P1 ו-P2 *לאחר ש-P2 משנה את הבית הבודד בדף המערך שלו*? הסבר את המנגנון של CoW שמתרחש בנקודה זו.",
        "code_snippet": null,
        "options": null,
        "solution": {
          "is_present_in_file": true,
          "correct_option": null,
          "explanation": "כאשר P2 מנסה לשנות בית בדף כלשהו במערך, מתרחשת 'הפרעת דף' (page fault) מכיוון שכניסת טבלת הדפים עבור דף זה מסומנת כ'לקריאה בלבד'. מערכת ההפעלה מטפלת בהפרעה זו:\n1.  היא מקצה דף פיזי חדש עבור P2.\n2.  היא מעתיקה את התוכן של הדף הפיזי המקורי (שנחלק עם P1) לדף הפיזי החדש שהוקצה.\n3.  היא מעדכנת את כניסת טבלת הדפים של P2 עבור אותו דף וירטואלי, כך שתצביע לדף הפיזי החדש, ומסמנת אותו כ'לכתיבה' (writable).\nהדף הפיזי המקורי נשאר ללא שינוי וממשיך להיות משותף (ולקריאה בלבד) על ידי P1. לכן, נוסף דף פיזי אחד לסך הדפים. בסך הכל נצרכים 4096 (דפים משותפים מקוריים) + 1 (דף חדש ל-P2) = 4097 דפים פיזיים."
        }
      },
      {
        "id": "10.3",
        "text": "מה היה קורה מבחינת צריכת דפים פיזיים *מיד לאחר קריאת ה-fork()* אם המערכת *לא* הייתה תומכת במנגנון Copy-on-Write?",
        "code_snippet": null,
        "options": null,
        "solution": {
          "is_present_in_file": true,
          "correct_option": null,
          "explanation": "אם המערכת לא הייתה תומכת במנגנון Copy-on-Write, קריאת ה-fork() הייתה גורמת לשכפול מלא של כל מרחב הכתובות של P1, כולל המערך בגודל 16MB. המשמעות היא ש-P2 היה מקבל עותק מלא ופרטי משלו של 4096 הדפים הפיזיים המרכיבים את המערך.\nלכן, P1 היה משתמש ב-4096 דפים פיזיים ו-P2 היה משתמש ב-4096 דפים פיזיים משלו. סך הכל היו נצרכים 4096 + 4096 = 8192 דפים פיזיים מיד לאחר ה-fork()."
        }
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": null
    },
    "difficulty_estimation": "Medium"
  }
}