{
  "metadata": {
    "source": "ai_generated",
    "subject": "File Systems",
    "topic_hint": "File Systems",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 23:32:42",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2275,
      "output_tokens": 1423,
      "total_tokens": 6414
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "File Systems",
      "Journaling",
      "Consistency"
    ],
    "content": {
      "text": "משתמש כותב קובץ גדול (מספר ג'יגה-בייטים) למערכת קבצים מסוג ext3 המוגדרת במצב 'ordered' (ברירת המחדל). במהלך הכתיבה, מתרחשת הפסקת חשמל פתאומית.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "תארו מהו המצב הסביר של הקובץ לאחר הפסקת החשמל והפעלת המערכת מחדש. אילו מנגנונים במערכת הקבצים מבטיחים את שלמות המערכת במצב זה?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "מה היה קורה באותו תרחיש אם מערכת הקבצים הייתה מסוג ext2 (ללא Journaling)? פרטו את ההבדלים והסיכונים.",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "1.1: במצב 'ordered' של ext3, מערכת הקבצים מבטיחה שבלוקי הנתונים (data blocks) יכתבו לדיסק לפני שבלוקי המטא-דאטה (metadata blocks) המצביעים עליהם יכתבו ליומן (journal) וייעשו קומטינג (commit). לאחר הפסקת חשמל והפעלת המערכת מחדש, ה-ext3 תבצע שחזור מהיומן. מכיוון שרק שינויי מטא-דאטה נרשמים ביומן (ולא הנתונים עצמם במצב ordered), היומן ישמש לשחזור עקבי של המטא-דאטה. המצב הסביר של הקובץ יהיה אחד משניים:\n1. הקובץ יופיע כקובץ תקין, אך הוא יהיה קטום (truncated) לגודלו האחרון לפני הכתיבה שהושלמה במלואה ובוצעה לה התחייבות (commit) ליומן. כלומר, החלקים שנכתבו אך לא הספיקו להתחייב, לא יופיעו בקובץ.\n2. במקרה שבלוקי נתונים נכתבו אך המטא-דאטה לא הספיקה להתעדכן כלל, הבלוקים הללו יהפכו לבלוקים \"אבודים\" (lost blocks) שניתן למצוא אותם בעזרת כלי כמו `fsck` ולשחזר אותם (אם כי לרוב הם לא יהיו שימושיים).\nהמנגנון שמבטיח את שלמות המערכת הוא ה-Journal. הוא מבטיח שכל שינויי המטא-דאטה יבוצעו באופן אטומי: או שכולם יבוצעו או שאף אחד לא יבוצע. במצב 'ordered', הוא גם מבטיח שהנתונים יהיו על הדיסק לפני שהמטא-דאטה תצביע עליהם, ובכך נמנע מצב שבו המטא-דאטה מצביעה על נתונים לא מעודכנים או \"זבל\" (garbage).\n\n1.2: אם מערכת הקבצים הייתה ext2 (ללא Journaling), התרחיש היה שונה באופן מהותי:\n1. **חוסר עקביות במערכת הקבצים:** ללא יומן, אין דרך פשוטה ובטוחה להבטיח אטומיות של שינויים. הפסקת חשמל עלולה להשאיר את המטא-דאטה במצב לא עקבי, לדוגמה: Inode עודכן כדי להצביע על בלוקי נתונים חדשים, אך מפת הבלוקים הפנויים (free block bitmap) לא עודכנה, מה שגורם לבלוקים אלו להיראות גם פנויים וגם בשימוש (in use). Inode לא עודכן, אך בלוקי נתונים נכתבו, מה שגורם לבלוקים להיות \"אבודים\" (לא מקושרים לאף קובץ). מפת הבלוקים הפנויים עודכנה, אך ה-inode לא (או להפך), מה שמוביל לנתונים שגויים או בלוקים דלופים (leaked blocks).\n2. **צורך ב-`fsck`:** לאחר הפסקת חשמל, חובה להריץ את כלי ה-`fsck` (File System Check) כדי לסרוק את כל מערכת הקבצים, לזהות ולתקן אי-עקביויות. תהליך זה יכול להיות ארוך מאוד (תלוי בגודל מערכת הקבצים) ובמהלכו מערכת הקבצים אינה זמינה.\n3. **אובדן נתונים וקורפציה:** קיים סיכון גבוה יותר לאובדן נתונים או לקורפציה של קבצים. ייתכן שהקובץ יהיה פגום, יכיל מידע חלקי או שגוי, או שחלקים ממנו יהפכו לבלוקים אבודים. במקרים חמורים, אי-עקביות עלולה להוביל לקריסת מערכת הקבצים כולה או לחוסר יכולת לעלות (mount) אותה.\nההבדל המרכזי הוא ש-ext3 עם journaling מספקת הבטחה חזקה יותר לעקביות המטא-דאטה וזמן שחזור מהיר לאחר קריסה, בעוד ext2 מסתמכת על סריקה מלאה ופגיעה יותר לאובדן נתונים."
    },
    "difficulty_estimation": "Medium"
  }
}