{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 23:03:11",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4788,
      "output_tokens": 4505,
      "total_tokens": 23319
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Paging",
      "Virtual Memory",
      "Memory Management",
      "TLB",
      "Shared Memory"
    ],
    "content": {
      "text": "נתונה מערכת זיכרון וירטואלי עם המאפיינים הבאים:\n*   כתובת וירטואלית בגודל 48 ביטים.\n*   גודל דף: 4KB.\n*   גודל כניסה בטבלת דפים (PTE): 8 בתים.\n*   טבלת דפים היררכית בעלת 4 רמות. כל טבלת דפים (או תת-טבלה) מכילה 512 כניסות ומוקצית לדף פיזי אחד.\n*   TLB (Translation Lookaside Buffer) בעל 16 כניסות, בשיטת אסוציאטיבית מלאה, עם מדיניות החלפה LRU (Least Recently Used). כל כניסה ב-TLB כוללת מזהה תהליך (ASID).\n*   זמן גישה ל-TLB: 10 ננו-שניות.\n*   זמן גישה לזיכרון פיזי (לקריאת PTE או נתונים): 100 ננו-שניות.\n*   זמן טיפול בפסיקת דף (Page Fault): 10 מילי-שניות (כולל טעינה מהדיסק ועדכון PTE).\n\nבמערכת רצים שני תהליכים, P1 ו-P2. לשניהם יש קטע קוד משותף וקטעי נתונים פרטיים:\n*   **קטע קוד משותף (Shared Code Segment):** משתרע מכתובת וירטואלית `0x0000_1000_0000_0000` עד `0x0000_1000_0000_FFFF`. קטע זה מכיל 16 דפים (64KB).\n*   **קטע נתונים פרטי P1 (P1 Private Data Segment):** משתרע מכתובת וירטואלית `0x0000_2000_0000_0000` עד `0x0000_2000_0000_FFFF`. קטע זה מכיל 16 דפים (64KB).\n*   **קטע נתונים פרטי P2 (P2 Private Data Segment):** משתרע מכתובת וירטואלית `0x0000_3000_0000_0000` עד `0x0000_3000_0000_FFFF`. קטע זה מכיל 16 דפים (64KB).\n\n**מצב התחלתי:**\n*   כל דפי הקוד והנתונים של המשתמש אינם נמצאים בזיכרון הפיזי (כלומר, ה-Present Bit ב-PTE שלהם הוא 0).\n*   מבני טבלאות הדפים הנדרשים עבור קטעי הזיכרון המוקצים לתהליכים (קוד ונתונים) כבר הוקצו בזיכרון הפיזי, אך רק הדפים של טבלאות הדפים עצמן (ולא דפי המשתמש) נמצאים בזיכרון.\n*   ה-TLB ריק.\n\n**רצף גישות לכתובות וירטואליות (לפי הסדר):**\n1.  P1 ניגש לכתובת: `0x0000_1000_0000_1000`\n2.  P1 ניגש לכתובת: `0x0000_1000_0000_2000`\n3.  P1 ניגש לכתובת: `0x0000_2000_0000_1000`\n4.  P2 ניגש לכתובת: `0x0000_1000_0000_1000`\n5.  P2 ניגש לכתובת: `0x0000_3000_0000_1000`\n6.  P1 ניגש לכתובת: `0x0000_1000_0000_1000`\n7.  P1 ניגש לכתובת: `0x0000_2000_0000_2000`\n8.  P2 ניגש לכתובת: `0x0000_1000_0000_2000`\n\n**נדרש:**\nא.  מהו סך הזיכרון הפיזי המינימלי הנדרש להחזיק את כל מבני טבלאות הדפים של שני התהליכים (P1 ו-P2) יחד, בטרם בוצעה כל גישה לדפי קוד/נתונים של המשתמש? פרט את חישוביך.\nב.  עבור כל גישה ברצף הנתון, ציין האם התרחש TLB Hit או TLB Miss, והאם התרחשה פסיקת דף (Page Fault). הסבר בקצרה לכל מקרה.\nג.  מהו זמן הגישה האפקטיבי הכולל (Total Effective Access Time) עבור רצף הגישות כולו? פרט את חישוביך.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "**פתרון:**\n\n**ניתוח מבנה הזיכרון הווירטואלי וטבלאות הדפים:**\n*   כתובת וירטואלית (VA) בגודל 48 ביטים.\n*   גודל דף: 4KB = 2^12 בתים. לכן, ה-Offset הוא 12 ביטים.\n*   מספר דף וירטואלי (VPN) הוא 48 - 12 = 36 ביטים.\n*   גודל כניסה בטבלת דפים (PTE): 8 בתים.\n*   גודל טבלת דפים: 4KB. מספר כניסות בכל טבלה: 4KB / 8 בתים = 512 כניסות.\n*   גודל אינדקס לכל רמה: log2(512) = 9 ביטים.\n*   מערכת בעלת 4 רמות של טבלאות דפים, כאשר כל רמה משתמשת ב-9 ביטים לאינדקס. סה\"כ: 9 * 4 = 36 ביטים, תואם ל-VPN.\n    *   P1 Index: 9 ביטים\n    *   P2 Index: 9 ביטים\n    *   P3 Index: 9 ביטים\n    *   P4 Index: 9 ביטים\n\n**א. חישוב סך הזיכרון הפיזי המינימלי הנדרש למבני טבלאות הדפים:**\nכל טבלת דפים (בכל רמה) תופסת דף פיזי אחד (4KB).\n\nננתח את הצרכים עבור כל קטע זיכרון:\n*   **עבור תהליך P1:**\n    *   **טבלת דפים ראשית (P1 Root Page Table):** 1 דף (4KB). (ייחודית ל-P1)\n    *   **עבור קטע קוד משותף (16 דפים):**\n        *   P1 entry בטבלה הראשית מצביע לטבלת P2. דורש 1 דף P2.\n        *   P2 entry בטבלת P2 מצביע לטבלת P3. דורש 1 דף P3.\n        *   P3 entry בטבלת P3 מצביע לטבלת P4. דורש 1 דף P4.\n        *   סה\"כ 3 דפים עבור מבנה טבלאות הדפים של קטע הקוד של P1 (P2, P3, P4).\n    *   **עבור קטע נתונים פרטי P1 (16 דפים):**\n        *   P1 entry בטבלה הראשית מצביע לטבלת P2. דורש 1 דף P2.\n        *   P2 entry בטבלת P2 מצביע לטבלת P3. דורש 1 דף P3.\n        *   P3 entry בטבלת P3 מצביע לטבלת P4. דורש 1 דף P4.\n        *   סה\"כ 3 דפים עבור מבנה טבלאות הדפים של קטע הנתונים של P1 (P2, P3, P4).\n\n*   **עבור תהליך P2:**\n    *   **טבלת דפים ראשית (P1 Root Page Table):** 1 דף (4KB). (ייחודית ל-P2)\n    *   **עבור קטע קוד משותף (16 דפים):**\n        *   ה-P1 entry של P2 עבור קטע הקוד יצביע לאותה טבלת P2 פיזית שנוצרה עבור P1. לכן, אין צורך בדפים פיזיים נוספים עבור טבלאות P2, P3, P4 של קטע הקוד.\n        *   סה\"כ 0 דפים נוספים.\n    *   **עבור קטע נתונים פרטי P2 (16 דפים):**\n        *   P1 entry בטבלה הראשית מצביע לטבלת P2. דורש 1 דף P2.\n        *   P2 entry בטבלת P2 מצביע לטבלת P3. דורש 1 דף P3.\n        *   P3 entry בטבלת P3 מצביע לטבלת P4. דורש 1 דף P4.\n        *   סה\"כ 3 דפים עבור מבנה טבלאות הדפים של קטע הנתונים של P2 (P2, P3, P4).\n\n**סך הכל דפים פיזיים עבור טבלאות דפים:**\n1 (P1 Root) + 3 (P1 Code P2/P3/P4) + 3 (P1 Data P2/P3/P4) + 1 (P2 Root) + 0 (P2 Code P2/P3/P4) + 3 (P2 Data P2/P3/P4) = 11 דפים.\n\n**סך הזיכרון הפיזי הנדרש:** 11 דפים * 4KB/דף = 44KB.\n\n**ב. ניתוח רצף הגישות וג. חישוב זמן גישה אפקטיבי כולל:**\n\nנשתמש ב: TLB Access = 10ns, Memory Access = 100ns, Page Fault = 10,000,000ns. (עלות גישה במקרה של TLB Miss היא: TLB Access + 4*Memory Access + [Page Fault אם P=0] + Memory Access)\nTLB מכיל 16 כניסות, LRU, ASID-aware (כלומר, כניסה ב-TLB כוללת גם את מזהה התהליך, ASID).\n\n| # | תהליך | כתובת וירטואלית | VPN (לצורך מעקב) | TLB Hit/Miss | Page Fault? | הסבר | עלות (ns) |\n|---|---|---|---|---|---|---|---|\n| 1 | P1 | `0x0000_1000_0000_1000` | `0x1000_0000_0` | Miss | כן | TLB ריק. הליכה בטבלת דפים (4 גישות זיכרון). ה-PTE מצביע על P=0 (דף קוד P1). פסיקת דף וטעינת הדף (ל-F1). PTE מעודכן (P=1, PFN=F1). כניסה ל-TLB: (VPN 0x1000_0000_0, ASID 1) -> F1. | 10 + 4*100 + 10,000,000 + 100 = 10,000,510 |\n| 2 | P1 | `0x0000_1000_0000_2000` | `0x1000_0000_1` | Miss | כן | (P1 Code page 1). TLB Miss. הליכה בטבלת דפים. ה-PTE מצביע על P=0. פסיקת דף (ל-F2). PTE מעודכן (P=1, PFN=F2). כניסה ל-TLB: (VPN 0x1000_0000_1, ASID 1) -> F2. | 10 + 4*100 + 10,000,000 + 100 = 10,000,510 |\n| 3 | P1 | `0x0000_2000_0000_1000` | `0x2000_0000_0` | Miss | כן | (P1 Data page 0). TLB Miss. הליכה בטבלת דפים. ה-PTE מצביע על P=0. פסיקת דף (ל-F3). PTE מעודכן (P=1, PFN=F3). כניסה ל-TLB: (VPN 0x2000_0000_0, ASID 1) -> F3. | 10 + 4*100 + 10,000,000 + 100 = 10,000,510 |\n| 4 | P2 | `0x0000_1000_0000_1000` | `0x1000_0000_0` | Miss | לא | (P2 Code page 0). TLB Miss (ה-ASID שונה מגישה 1). הליכה בטבלת דפים (4 גישות). ה-PTE (המשותף עם P1) מצביע על P=1 (כבר נטען בגישה 1). אין פסיקת דף. כניסה ל-TLB: (VPN 0x1000_0000_0, ASID 2) -> F1. | 10 + 4*100 + 100 = 510 |\n| 5 | P2 | `0x0000_3000_0000_1000` | `0x3000_0000_0` | Miss | כן | (P2 Data page 0). TLB Miss. הליכה בטבלת דפים. ה-PTE מצביע על P=0. פסיקת דף (ל-F4). PTE מעודכן (P=1, PFN=F4). כניסה ל-TLB: (VPN 0x3000_0000_0, ASID 2) -> F4. | 10 + 4*100 + 10,000,000 + 100 = 10,000,510 |\n| 6 | P1 | `0x0000_1000_0000_1000` | `0x1000_0000_0` | Hit | לא | (P1 Code page 0). TLB Hit (כניסה (VPN 0x1000_0000_0, ASID 1) -> F1 קיימת ב-TLB). | 10 + 100 = 110 |\n| 7 | P1 | `0x0000_2000_0000_2000` | `0x2000_0000_1` | Miss | כן | (P1 Data page 1). TLB Miss. הליכה בטבלת דפים. ה-PTE מצביע על P=0. פסיקת דף (ל-F5). PTE מעודכן (P=1, PFN=F5). כניסה ל-TLB: (VPN 0x2000_0000_1, ASID 1) -> F5. | 10 + 4*100 + 10,000,000 + 100 = 10,000,510 |\n| 8 | P2 | `0x0000_1000_0000_2000` | `0x1000_0000_1` | Miss | לא | (P2 Code page 1). TLB Miss (ה-ASID שונה מגישה 2). הליכה בטבלת דפים. ה-PTE (המשותף עם P1) מצביע על P=1 (כבר נטען בגישה 2). אין פסיקת דף. כניסה ל-TLB: (VPN 0x1000_0000_1, ASID 2) -> F2. | 10 + 4*100 + 100 = 510 |\n\n**סיכום:**\n*   סה\"כ TLB Hits: 1\n*   סה\"כ TLB Misses: 7\n*   סה\"כ Page Faults: 5\n\n**חישוב זמן הגישה האפקטיבי הכולל:**\n*   5 גישות עם Page Fault: 5 * 10,000,510 ns = 50,002,550 ns\n*   2 גישות עם TLB Miss ללא Page Fault: 2 * 510 ns = 1,020 ns\n*   1 גישה עם TLB Hit: 1 * 110 ns = 110 ns\n\n**זמן גישה אפקטיבי כולל = 50,002,550 + 1,020 + 110 = 50,003,680 ננו-שניות.**",
      "difficulty_estimation": "Hard"
    }
  }
}