{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Threads",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 18:47:17",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1969,
      "output_tokens": 670,
      "total_tokens": 3834
    }
  },
  "question": [
    {
      "id": 10,
      "type": "CodeAnalysis",
      "topic": [
        "Threads",
        "Concurrency",
        "Memory Sharing",
        "Pthreads"
      ],
      "content": {
        "text": "לפניך קטע קוד בשפת C המשתמש בספריית pthreads. מה מהבאים מתאר נכונה את הפלטים האפשריים של התוכנית? הניחו כי כל הקריאות למערכת מצליחות.",
        "code_snippet": "#include <pthread.h>\n#include <stdio.h>\n#include <unistd.h>\n\nvoid* print_val(void* arg) {\n    int val = *((int*)arg);\n    printf(\"%d\", val);\n    return NULL;\n}\n\nint main() {\n    pthread_t threads[3];\n    for (int i = 0; i < 3; i++) {\n        pthread_create(&threads[i], NULL, print_val, &i);\n    }\n    for (int i = 0; i < 3; i++) {\n        pthread_join(threads[i], NULL);\n    }\n    return 0;\n}",
        "options": [
          "א. הפלט תמיד יהיה 012 (בסדר כלשהו).",
          "ב. הפלט תמיד יהיה 333.",
          "ג. ייתכנו פלטים כמו 123, 333, או 023.",
          "ד. התוכנית תדפיס תמיד 000 כיוון שזה הערך ההתחלתי של i."
        ]
      },
      "sub_questions": null,
      "points": 10,
      "solution": {
        "is_present_in_file": true,
        "correct_option": "ג",
        "explanation": "הבעיה המרכזית בקוד היא שכל שלושת החוטים (threads) מקבלים כארגומנט את הכתובת של אותו משתנה מקומי i (כלומר &i). כיוון שהחוטים רצים במקביל ללולאת ה-main, הערך בכתובת זו עשוי להשתנות על ידי לולאת ה-for בטרם החוט הספיק לקרוא אותו. בסיום הלולאה הראשונה, ערכו של i הוא 3. לכן, כל חוט עשוי לקרוא כל ערך ש-i קיבל במהלך הריצה (0, 1, 2) או את הערך הסופי (3), תלוי בתזמון (scheduling) של החוטים ביחס ללולאה ב-main. לכן פלטים המכילים 3 או חזרות על מספרים הם אפשריים בהחלט."
      },
      "difficulty_estimation": "Medium"
    }
  ]
}