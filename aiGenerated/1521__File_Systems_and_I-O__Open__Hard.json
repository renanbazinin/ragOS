{
  "metadata": {
    "source": "ai_generated",
    "subject": "File Systems",
    "topic_hint": "File Systems and I/O",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 11:05:07",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4088,
      "output_tokens": 2830,
      "total_tokens": 19517
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "File Systems",
      "I/O"
    ],
    "content": {
      "text": "מערכת קבצים חדשה, OptimalFS, תוכננה על מנת למקסם ביצועים בקריאה וכתיבה של קבצים גדולים. במערכת זו:\n1.  **Inode:** כל Inode בגודל 256 בתים. ה-Inode מכיל מטא-דאטה סטנדרטי (גודל קובץ, הרשאות, זמני גישה ושינוי), ובמקום מצביעים ישירים ועקיפים לבלוקי נתונים, הוא מכיל 1 מצביע ל-EDB ישיר (8 בתים), ו-1 מצביע ל-EDB עקיף (8 בתים).\n2.  **Extent Descriptor Block (EDB):** זהו בלוק בגודל 4KB.\n    *   **EDB ישיר (Direct EDB):** מכיל רשימה של תיאורי Extent. כל תיאור Extent מורכב מ-2 שדות: `start_block_id` (מזהה בלוק התחלה, 8 בתים) ו-`length_in_blocks` (אורך ה-Extent בבלוקים, 2 בתים).\n    *   **EDB עקיף (Indirect EDB):** מכיל רשימה של מצביעים (8 בתים כל אחד) ל-EDBs ישירים נוספים.\n3.  **הקצאת בלוקים:** מערכת הקבצים שואפת להקצות בלוקים של נתונים ברצף (Extents) ככל הניתן.\n4.  **Journaling:** המערכת משתמשת ב-metadata journaling. כל שינוי ל-inodes ול-EDBs נרשם ל-journal לפני כתיבתו למיקומו הסופי. בלוקי נתונים נכתבים ישירות למיקומם הסופי.\n\nנתונים נוספים:\n*   גודל בלוק: 4KB.\n*   גודל מצביע: 8 בתים.\n*   מהירות סיבוב הדיסק (RPM): 7500.\n*   זמן Seek ממוצע: 15ms.\n*   קצב העברה מקסימלי: 1MB/s.\n*   זמן סיבוב מלא של הדיסק: 60 / 7500 = 0.008 שניות = 8ms.\n*   זמן השהייה סיבובית (Rotational Latency) ממוצע: 8ms / 2 = 4ms.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "מהו הגודל המקסימלי של קובץ (בבתים) הנתמך על ידי מערכת קבצים זו? פרטו את החישובים.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "משתמש מבצע פעולת יצירה וכתיבה של קובץ חדש בגודל 120MB. הדיסק מפוצל (fragmented) מאוד, ולכן מערכת הקבצים נאלצת להקצות את בלוקי הנתונים של הקובץ ב-100 Extents שונים, כאשר כל Extent ממוקם במיקום אקראי על הדיסק (כלומר, בין כל שני Extents עוקבים יש צורך ב-seek ו-rotational latency מלאים). יתרה מכך, כל Extent ממוקם בבלוק פיזי שונה מבלוקי ה-EDB. נתון שאף cache אינו מכיל מידע רלוונטי לביצוע הפעולה. יש להתעלם מכתיבת ה-journal עצמה וממחיקת בלוקים פנויים (free blocks bitmap) מהחישוב.\nמה הזמן המינימלי שתיקח פעולה זו? פרטו את כל החישובים והנחותיכם.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.3",
        "text": "נניח שצוות הפיתוח שקל לשנות את מדיניות ה-journaling כך שגם בלוקי הנתונים (DATA blocks) ייכתבו ל-journal לפני כתיבתם למיקומם הסופי. הציעו יתרון וחיסרון אחד לשינוי זה בהשוואה ל-metadata journaling הקיים במערכת OptimalFS. הסבירו בקצרה.",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": false,
      "correct_option": null,
      "explanation": "פתרון:\n\n**8.1 חישוב גודל קובץ מקסימלי:**\n*   **גודל תיאור Extent:** 8 בתים (start_block_id) + 2 בתים (length_in_blocks) = 10 בתים.\n*   **מספר תיאורי Extent ב-EDB ישיר:** EDB בגודל 4KB = 4096 בתים. EDB ישיר מכיל רק תיאורי Extent. לכן, `4096 / 10 = 409` תיאורי Extent (בהתעלם מהשארית).\n*   **מספר מצביעים ב-EDB עקיף:** EDB בגודל 4KB. EDB עקיף מכיל רק מצביעים ל-EDBs ישירים. כל מצביע הוא 8 בתים. לכן, `4096 / 8 = 512` מצביעים ל-EDBs ישירים.\n*   **אורך מקסימלי של Extent יחיד:** השדה `length_in_blocks` הוא 2 בתים, ולכן יכול לייצג עד `2^16 - 1 = 65535` בלוקים.\n\n*   **סה\"כ Extents מה-Inode:**\n    *   מהמצביע הישיר ל-EDB ישיר: `409` Extents.\n    *   מהמצביע העקיף ל-EDB עקיף: `512` מצביעים ל-EDBs ישירים. כל EDB ישיר כזה מכיל `409` Extents. לכן, `512 * 409 = 209408` Extents.\n    *   **סה\"כ Extents בקובץ:** `409 + 209408 = 209817` Extents.\n\n*   **גודל קובץ מקסימלי (בבלוקים):** `209817 * (2^16 - 1)` בלוקים = `209817 * 65535` בלוקים = `13757820855` בלוקים.\n*   **גודל קובץ מקסימלי (בבתים):** `13757820855` בלוקים * `4KB/בלוק` = `13757820855 * 4096` בתים = `56359995545600` בתים (כ-56.36 טרה-בייט).\n\n**8.2 חישוב זמן יצירה וכתיבה של הקובץ:**\n*   **גודל קובץ:** 120MB.\n*   **גודל בלוק:** 4KB.\n*   **מספר בלוקי נתונים:** `120MB / 4KB = 120 * 1024KB / 4KB = 30 * 1024 = 30720` בלוקים.\n*   **מספר Extents:** 100.\n*   **מספר EDBs נדרשים:** כל EDB ישיר יכול להכיל 409 תיאורי Extent. מכיוון שנדרשים 100 Extents, נצטרך רק EDB ישיר אחד (100 < 409).\n\n**פעולות כתיבה לדיסק והזמנים שלהן (בהתעלם מ-journal ומ-bitmap):**\n1.  **כתיבת בלוק ה-Inode:** המערכת כותבת את בלוק ה-Inode המעודכן עם פרטי הקובץ החדש (כולל מצביע ל-EDB). זוהי פעולת כתיבה אחת.\n2.  **כתיבת בלוק ה-EDB הישיר:** המערכת כותבת את בלוק ה-EDB הישיר המכיל את 100 תיאורי ה-Extent. זוהי פעולת כתיבה אחת.\n3.  **כתיבת בלוקי הנתונים של 100 ה-Extents:** המערכת כותבת את כל 30720 בלוקי הנתונים ב-100 פעולות כתיבה נפרדות (אחת לכל Extent).\n\n*   **סה\"כ פעולות כתיבה עצמאיות (דורשות Seek ו-Rotational Latency):** `1 (Inode) + 1 (EDB) + 100 (Extents) = 102` פעולות.\n*   **זמן Seek ממוצע:** 15ms.\n*   **זמן Rotational Latency ממוצע:** 4ms.\n*   **זמן כולל עבור Seek ו-Rotational Latency:** `102 * (15ms + 4ms) = 102 * 19ms = 1938ms`.\n\n*   **סה\"כ נתונים להעברה:** 120MB.\n*   **קצב העברה מקסימלי:** 1MB/s.\n*   **זמן העברה כולל:** `120MB / 1MB/s = 120 שניות = 120,000ms`.\n\n*   **זמן מינימלי כולל לביצוע הפעולה:** `1938ms (Seek + Rotational) + 120000ms (Transfer) = 121938ms = 121.938 שניות`.\n\n**8.3 יתרון וחיסרון בשינוי מדיניות ה-Journaling ל-Full Data Journaling:**\n*   **יתרון:** **שלמות נתונים משופרת (Enhanced Data Integrity):** במקרה של קריסה, Full Data Journaling מבטיח שבלוקי הנתונים יהיו תמיד במצב עקבי. או שכל הנתונים החדשים נכתבו בהצלחה (מתוך ה-journal), או שאף שינוי לא יוחל (revert) – דבר המונע מצבים של \"כתיבות קרועות\" (torn writes) או נתונים חלקיים/משובשים בבלוקי הנתונים לאחר התאוששות. זהו רמה גבוהה יותר של אמינות לנתונים עצמם, בנוסף למטא-דאטה.\n*   **חיסרון:** **פגיעה משמעותית בביצועים (Significant Performance Degradation):** כתיבת בלוקי נתונים ל-journal לפני כתיבתם למיקומם הסופי בדיסק גורמת לכך שכל בלוק נתונים נכתב פעמיים לדיסק. הדבר מכפיל את עומס ה-I/O עבור פעולות כתיבה של נתונים, ובכך מפחית באופן דרמטי את מהירות הכתיבה, במיוחד עבור קבצים גדולים או עומסי עבודה עתירי כתיבה."
    },
    "difficulty_estimation": "Hard"
  }
}