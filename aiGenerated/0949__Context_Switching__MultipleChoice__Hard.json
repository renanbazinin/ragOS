{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Context Switching",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 07:05:22",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 1224,
      "total_tokens": 6284
    }
  },
  "question": {
    "id": 101,
    "type": "MultipleChoice",
    "topic": [
      "Context Switching",
      "Virtual Memory",
      "Performance"
    ],
    "content": {
      "text": "תהליך P1 נמצא כעת במצב ריצה. מערכת ההפעלה מחליטה לבצע החלפת הקשר (context switch) לתהליך P2. בהנחה ש-P1 ו-P2 הם תהליכים נפרדים (לא ת'רדים של אותו תהליך) ויש להם מרחבי כתובות וירטואליים שונים, איזו מהטענות הבאות נכונה בהכרח לגבי ההשפעה של החלפת הקשר זו על ביצועי המערכת, בהתחשב ברכיבי חומרה מודרניים?",
      "code_snippet": null,
      "options": [
        "א. ה-TLB (Translation Lookaside Buffer) ירוקן תמיד לחלוטין, מה שיגרום לעלייה משמעותית בזמן גישה לזיכרון עבור P2 בתחילה.",
        "ב. ה-TLB ירוקן רק אם תהליך P2 משתמש במרחב כתובות וירטואלי שונה באופן מהותי מ-P1; אחרת, רוב הערכים יישארו תקפים.",
        "ג. רק נתוני הליבה (kernel data) יישארו ב-TLB, וכל הערכים הקשורים למרחב המשתמש ירוקנו.",
        "ד. CPU Caches (L1, L2, L3) ירוקנו כמעט לחלוטין כתוצאה מהחלפת הקשר, מכיוון שהם מכילים נתונים המשתייכים למרחב הכתובות של P1.",
        "ה. כל התשובות האחרות אינן נכונות."
      ]
    },
    "sub_questions": null,
    "points": 5,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "א",
      "explanation": "החלפת הקשר בין תהליכים נפרדים (עם מרחבי כתובות וירטואליים שונים) מחייבת שינוי של טבלת הדפים הפעילה עבור ה-CPU (לדוגמה, על ידי שינוי ערך הרגיסטר CR3 במעבדי x86). פעולה זו, או שינוי הקשר התהליך הכללי, גורמת לכך שרשומות ה-TLB (Translation Lookaside Buffer) המשתייכות לתהליך הקודם (P1) הופכות ללא רלוונטיות לתהליך החדש (P2).\n\nברוב המכריע של הארכיטקטורות המודרניות, שינוי טבלת הדפים הפעילה מוביל לריקון מלא או חלקי (אינוולידציה) של ה-TLB. גם במערכות התומכות ב-ASIDs (Address Space IDs) כדי למנוע ריקון מלא, רשומות P1 הופכות לבלתי נגישות עבור P2. לכן, תהליך P2 יתחיל עם TLB 'קר' (cold), כלומר, יחווה מספר רב של 'החטאות TLB' (TLB misses) בגישה ראשונית לזיכרון, מה שיגרום לעלייה משמעותית בזמן הגישה לזיכרון ויפגע בביצועים עד שרשומות ה-TLB הרלוונטיות עבורו יטענו מחדש.\n\nלגבי שאר האפשרויות:\nב. לא נכון. P1 ו-P2 הם תהליכים נפרדים עם מרחבי כתובות וירטואליים שונים מטבעם. לכן, ה-TLB תמיד יושפע באופן משמעותי.\nג. לא נכון. בעוד שרשומות ליבה (kernel entries) עשויות להישאר ב-TLB אם הן מסומנות כ-'global', הטענה מתייחסת לריקון כל הערכים הקשורים למרחב המשתמש, וההשפעה על P2 היא בעיקר במרחב המשתמש. התשובה 'א' מתארת את ההשפעה הכוללת והקריטית לביצועים.\nד. לא נכון. זיכרונות המטמון של ה-CPU (L1, L2, L3) בדרך כלל אינם מרוקנים באופן מפורש בהחלפת הקשר בין תהליכים. הם מאחסנים נתונים לפי כתובות פיזיות. נתונים של P1 עשויים להישאר במטמון, אך כשתהליך P2 יתחיל לגשת לנתונים שלו, נתונים אלו יחליפו בהדרגה את נתוני P1, מה שיגרום ל'החטאות מטמון' (cache misses) עבור P2, אך לא לריקון מפורש של המטמון כולו. ריקון מלא של המטמונים הוא פעולה יקרה מאוד ונמנעת בדרך כלל."
    },
    "difficulty_estimation": "Hard"
  }
}