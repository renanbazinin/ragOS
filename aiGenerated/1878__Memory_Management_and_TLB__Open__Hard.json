{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Memory Management and TLB",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 21:23:03",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3221,
      "output_tokens": 2309,
      "total_tokens": 11610
    }
  },
  "question": {
    "id": 101,
    "type": "Open",
    "topic": [
      "Memory Management",
      "TLB",
      "Paging",
      "Virtual Memory"
    ],
    "content": {
      "text": "נתונה מערכת מחשב עם זיכרון וירטואלי בגודל 2^48 בתים וזיכרון פיזי בגודל 2^40 בתים. גודל הדף במערכת הוא 4KB. כל כניסה בטבלת הדפים (PTE) היא בגודל 8 בתים ומכילה את מספר המסגרת הפיזית (PFN) וביטי בקרה (כמו Valid, Dirty, Accessed).\nבמערכת קיים TLB בגודל 256 כניסות, בעל אסוציאטיביות של 4-דרכים (4-way set associative), המשתמש במדיניות החלפה LRU.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "101.1",
        "text": "פרטו את מבנה טבלת הדפים במערכת זו: כמה רמות של טבלאות דפים נדרשות? כמה ביטים מיועדים לכל אינדקס רמה ב-VPN? מהו מספר הכניסות המקסימלי בטבלת דפים ברמה הראשונה?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "101.2",
        "text": "פרטו את מבנה ה-TLB מבחינת חלוקת הביטים: כמה ביטים מיועדים ל-Index וכמה ל-Tag עבור כניסה ב-TLB? (הניחו שה-TLB מתויג ומואינדקס על בסיס הכתובת הוירטואלית).",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "101.3",
        "text": "תהליך ניגש לכתובת וירטואלית כלשהי. מהו המספר הכולל של גישות לזיכרון (כולל גישות ל-TLB, לזיכרון הראשי עבור טבלאות דפים, ולזיכרון הראשי עבור הנתונים/הוראה) ולדיסק (אם רלוונטי) בכל אחד מהתרחישים הבאים? נמקו כל חישוב.\nא. פגיעה ב-TLB (TLB Hit).\nב. החמאה ב-TLB (TLB Miss), אך כל כניסות טבלת הדפים הדרושות נמצאות בזיכרון הראשי (אין Page Fault).\nג. החמאה ב-TLB (TLB Miss), ומתרחש Page Fault עבור דף הנתונים/הוראה המבוקש. הניחו שבמקרה של Page Fault, מערכת ההפעלה מבצעת פתיון (page-out) של דף מלוכלך (Dirty Page) לדיסק, ולאחר מכן טוענת (page-in) את הדף המבוקש מהדיסק, מעדכנת את ה-PTE המתאים בזיכרון הראשי, ואז הפקודה מופעלת מחדש (מה שמוביל לגישה מוצלחת לנתונים/הוראה).",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "פתרון לשאלה 101:\n\n**101.1. מבנה טבלת הדפים:**\n*   **גודל דף:** 4KB = 2^12 בתים. לכן, ההיסט בתוך הדף (Page Offset) הוא 12 ביטים.\n*   **מרחב כתובות וירטואלי:** 48 ביטים. לכן, מספר הדף הוירטואלי (VPN) הוא 48 - 12 = 36 ביטים.\n*   **גודל כניסת טבלת דפים (PTE):** 8 בתים (64 ביטים).\n*   **מספר כניסות PTE בדף אחד:** גודל דף / גודל PTE = 4KB / 8 בתים = 4096 / 8 = 512 כניסות.\n*   **מספר ביטים לאינדקס רמה:** log2(512) = 9 ביטים.\n*   **מספר רמות טבלת הדפים:** מכיוון שה-VPN הוא 36 ביטים וכל אינדקס רמה משתמש ב-9 ביטים, מספר הרמות הנדרש הוא 36 / 9 = 4 רמות.\n*   **מספר כניסות מקסימלי בטבלת דפים ברמה הראשונה:** טבלת הדפים ברמה הראשונה מכילה כניסות המצביעות על טבלאות ברמה השנייה. מספר הכניסות המקסימלי בדף אחד הוא 512, ולכן טבלת הדפים ברמה הראשונה תכיל 512 כניסות לכל היותר (כיוון שהיא מאוחסנת בדף אחד).\n\n**101.2. מבנה ה-TLB:**\n*   **מספר כניסות TLB:** 256 כניסות.\n*   **אסוציאטיביות:** 4-דרכים.\n*   **מספר הסטים (Sets) ב-TLB:** מספר כניסות / אסוציאטיביות = 256 / 4 = 64 סטים.\n*   **מספר ביטים ל-Index ב-TLB:** log2(64) = 6 ביטים. (ה-Index משמש לבחירת הסט ב-TLB).\n*   **מספר ביטים ל-Tag ב-TLB:** ה-Tag מורכב משארית ביטי ה-VPN לאחר הפחתת ביטי ה-Index. מספר ביטי ה-VPN הוא 36. לכן, מספר ביטי ה-Tag הוא 36 - 6 = 30 ביטים.\n\n**101.3. מספר גישות לזיכרון ולדיסק:**\n\n**א. פגיעה ב-TLB (TLB Hit):**\n*   **גישות ל-TLB:** 1 (פגיעה).\n*   **גישות לזיכרון ראשי (PTEs):** 0 (המיפוי נמצא ב-TLB).\n*   **גישות לזיכרון ראשי (נתונים/הוראה):** 1 (לגישה לנתון/הוראה המבוקש).\n*   **גישות לדיסק:** 0.\n*   **סה\"כ:** 1 גישת TLB, 1 גישת זיכרון ראשי.\n\n**ב. החמאה ב-TLB (TLB Miss), אך כל כניסות טבלת הדפים הדרושות נמצאות בזיכרון הראשי (אין Page Fault):**\n*   **גישות ל-TLB:** 1 (החמאה).\n*   **גישות לזיכרון ראשי (PTEs):** 4 (גישה אחת לכל רמה של טבלת הדפים, מכיוון שיש 4 רמות).\n*   **גישות לזיכרון ראשי (נתונים/הוראה):** 1 (לאחר מציאת ה-PFN בטבלת הדפים, יש לגשת לזיכרון הראשי עבור הנתון/הוראה).\n*   **גישות לדיסק:** 0.\n*   **סה\"כ:** 1 גישת TLB, 5 גישות זיכרון ראשי.\n\n**ג. החמאה ב-TLB (TLB Miss), ומתרחש Page Fault עבור דף הנתונים/הוראה המבוקש:**\n*   **גישות ל-TLB:** 1 (החמאה).\n*   **גישות לזיכרון ראשי (PTEs) לפני Page Fault:** 4 (גישה אחת לכל רמה של טבלת הדפים כדי למצוא את ה-PTE הסופי של דף הנתונים/הוראה, שמתגלה כלא נוכח בזיכרון).\n*   **פעולות Page Fault:**\n    *   **גישת דיסק (כתיבה):** 1 (לפתיון דף מלוכלך מהזיכרון לדיסק, אם נדרש לפנות מקום).\n    *   **גישת דיסק (קריאה):** 1 (לטעינת הדף המבוקש מהדיסק לזיכרון הראשי).\n    *   **גישת זיכרון ראשי (עדכון PTE):** 1 (לעדכון ה-PTE של דף הנתונים/הוראה בטבלת הדפים בזיכרון הראשי, לאחר טעינת הדף).\n*   **גישת זיכרון ראשי (נתונים/הוראה) לאחר Page Fault:** 1 (לאחר שהדף טעון וה-PTE עודכן, הפקודה מופעלת מחדש, ה-TLB מעודכן, ומתבצעת גישה מוצלחת לנתון/הוראה).\n*   **סה\"כ:** 1 גישת TLB, 6 גישות זיכרון ראשי (4 ל-PTEs + 1 לעדכון PTE + 1 לנתון/הוראה), 2 גישות דיסק (1 כתיבה, 1 קריאה).\n"
    },
    "difficulty_estimation": "Hard"
  }
}