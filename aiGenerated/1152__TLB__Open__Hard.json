{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "TLB",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-08 08:20:02",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4186,
      "output_tokens": 4935,
      "total_tokens": 20148
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "TLB",
      "Memory Management",
      "Virtual Memory"
    ],
    "content": {
      "text": "נתונה מערכת זיכרון וירטואלי בעלת כתובת וירטואלית בגודל 32 ביטים וכתובת פיזית בגודל 20 ביטים. גודל דף הוא 4KB. המערכת משתמשת ב-TLB בגודל 8 כניסות, בשיטת אסוציאטיביות חלקית (Set-Associative) של 2-דרכים (2-way), ומדיניות החלפה LRU (Least Recently Used) בתוך כל סט. ה-TLB ריק בתחילת התהליך.\nלצורך פשטות, נניח שכל המיפויים הנדרשים נמצאים בטבלת הדפים בזיכרון הראשי ואין Page Faults.\nהביטים לזיהוי הסט ב-TLB נלקחים מ-2 הביטים הפחות משמעותיים של ה-VPN (Virtual Page Number).\nלהלן מיפויים של VPN ל-PFN (Physical Frame Number) מתוך טבלת הדפים:\n*   VPN 0x12345 ממופה ל-PFN 0xAB\n*   VPN 0x12346 ממופה ל-PFN 0xCD\n*   VPN 0x12347 ממופה ל-PFN 0xEF\n*   VPN 0x12348 ממופה ל-PFN 0x12\n*   VPN 0x12349 ממופה ל-PFN 0x34\n*   VPN 0x1234A ממופה ל-PFN 0x56\n*   VPN 0x1234B ממופה ל-PFN 0x78\n*   VPN 0x1234C ממופה ל-PFN 0x9A\n*   VPN 0x1234D ממופה ל-PFN 0xBC\n\nנתונה סדרת גישות לכתובות וירטואליות (כולן בבסיס 16):\n1.  0x12345000\n2.  0x12346010\n3.  0x12345020\n4.  0x12347030\n5.  0x12348040\n6.  0x12346050\n7.  0x12349060\n8.  0x1234A070\n9.  0x1234B080\n10. 0x1234C090\n11. 0x1234D0A0\n12. 0x123480B0\n\nיש לפרט ולנמק את כל החישובים:\nא. עבור כל גישה, יש לציין האם זו פגיעה (Hit) או החטאה (Miss) ב-TLB.\nב. עבור כל גישה, יש לציין את הכתובת הפיזית המתקבלת.\nג. יש לתאר את מצב ה-TLB (עבור כל סט) לאחר כל גישה, כולל ערכי ה-Tag וה-PFN השמורים, וכן את מצב ה-LRU בתוך כל סט.\nד. מהו אחוז הפגיעות (Hit Rate) הכולל בסדרת גישות זו?",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "ניתוח המערכת:\n*   **גודל כתובת וירטואלית (VA):** 32 ביטים.\n*   **גודל כתובת פיזית (PA):** 20 ביטים.\n*   **גודל דף:** 4KB = 2^12 בתים.\n*   **היסט דף (Offset):** 12 ביטים (הביטים הפחות משמעותיים של הכתובת).\n*   **מספר דף וירטואלי (VPN):** 32 - 12 = 20 ביטים.\n*   **מספר מסגרת פיזית (PFN):** 20 - 12 = 8 ביטים.\n*   **TLB:** 8 כניסות, 2-דרכים אסוציאטיבי.\n*   **מספר סטים ב-TLB:** 8 כניסות / 2 דרכים = 4 סטים.\n*   **ביטים לזיהוי סט (Set Index):** log2(4) = 2 ביטים.\n*   **מיקום ביטים לזיהוי סט:** 2 הביטים הפחות משמעותיים של ה-VPN (VPN[1:0]).\n*   **Tag ב-TLB:** שאר ביטי ה-VPN, כלומר VPN[19:2]. גודל ה-Tag הוא 18 ביטים.\n*   **מדיניות החלפה:** LRU בתוך כל סט. (0 מייצג את ה-MRU, 1 מייצג את ה-LRU בסט של 2 כניסות).\n\nחישוב Tag ו-Set Index עבור ה-VPNs הרלוונטיים:\n| VPN (hex) | VPN (binary, last 2 bits) | Set Index (dec) | Tag (hex) (VPN[19:2]) | PFN (hex) |\n|-----------|---------------------------|-----------------|-----------------------|-----------|\n| 0x12345   | ...01                     | 1               | 0x48D1                | 0xAB      |\n| 0x12346   | ...10                     | 2               | 0x48D1                | 0xCD      |\n| 0x12347   | ...11                     | 3               | 0x48D1                | 0xEF      |\n| 0x12348   | ...00                     | 0               | 0x48D2                | 0x12      |\n| 0x12349   | ...01                     | 1               | 0x48D2                | 0x34      |\n| 0x1234A   | ...10                     | 2               | 0x48D2                | 0x56      |\n| 0x1234B   | ...11                     | 3               | 0x48D2                | 0x78      |\n| 0x1234C   | ...00                     | 0               | 0x48D3                | 0x9A      |\n| 0x1234D   | ...01                     | 1               | 0x48D3                | 0xBC      |\n\nמעקב אחר גישות לזיכרון והשפעתן על ה-TLB:\nמצב התחלתי: כל כניסות ה-TLB אינן תקפות (Invalid).\n\n1.  **גישה ל-VA 0x12345000**\n    *   VPN = 0x12345, Set = 1, Tag = 0x48D1, Offset = 0x000\n    *   **TLB Miss:** סט 1 ריק. \n    *   הוספה ל-TLB: {Valid=1, Tag=0x48D1, PFN=0xAB, LRU=0} בסט 1, Way 0.\n    *   **PA = 0xAB000**\n    *   **מצב TLB (סט 1):** Way 0: {V=1, T=0x48D1, PFN=0xAB, LRU=0}, Way 1: {V=0}\n\n2.  **גישה ל-VA 0x12346010**\n    *   VPN = 0x12346, Set = 2, Tag = 0x48D1, Offset = 0x010\n    *   **TLB Miss:** סט 2 ריק.\n    *   הוספה ל-TLB: {Valid=1, Tag=0x48D1, PFN=0xCD, LRU=0} בסט 2, Way 0.\n    *   **PA = 0xCD010**\n    *   **מצב TLB (סט 2):** Way 0: {V=1, T=0x48D1, PFN=0xCD, LRU=0}, Way 1: {V=0}\n\n3.  **גישה ל-VA 0x12345020**\n    *   VPN = 0x12345, Set = 1, Tag = 0x48D1, Offset = 0x020\n    *   **TLB Hit:** נמצא בסט 1, Way 0.\n    *   עדכון LRU: הכניסה ב-Way 0 הופכת ל-MRU (LRU=0). (אין שינוי בפועל מכיוון שהיא כבר ה-MRU היחידה בסט).\n    *   **PA = 0xAB020**\n    *   **מצב TLB (סט 1):** Way 0: {V=1, T=0x48D1, PFN=0xAB, LRU=0}, Way 1: {V=0}\n\n4.  **גישה ל-VA 0x12347030**\n    *   VPN = 0x12347, Set = 3, Tag = 0x48D1, Offset = 0x030\n    *   **TLB Miss:** סט 3 ריק.\n    *   הוספה ל-TLB: {Valid=1, Tag=0x48D1, PFN=0xEF, LRU=0} בסט 3, Way 0.\n    *   **PA = 0xEF030**\n    *   **מצב TLB (סט 3):** Way 0: {V=1, T=0x48D1, PFN=0xEF, LRU=0}, Way 1: {V=0}\n\n5.  **גישה ל-VA 0x12348040**\n    *   VPN = 0x12348, Set = 0, Tag = 0x48D2, Offset = 0x040\n    *   **TLB Miss:** סט 0 ריק.\n    *   הוספה ל-TLB: {Valid=1, Tag=0x48D2, PFN=0x12, LRU=0} בסט 0, Way 0.\n    *   **PA = 0x12040**\n    *   **מצב TLB (סט 0):** Way 0: {V=1, T=0x48D2, PFN=0x12, LRU=0}, Way 1: {V=0}\n\n6.  **גישה ל-VA 0x12346050**\n    *   VPN = 0x12346, Set = 2, Tag = 0x48D1, Offset = 0x050\n    *   **TLB Hit:** נמצא בסט 2, Way 0.\n    *   עדכון LRU: הכניסה ב-Way 0 הופכת ל-MRU (LRU=0).\n    *   **PA = 0xCD050**\n    *   **מצב TLB (סט 2):** Way 0: {V=1, T=0x48D1, PFN=0xCD, LRU=0}, Way 1: {V=0}\n\n7.  **גישה ל-VA 0x12349060**\n    *   VPN = 0x12349, Set = 1, Tag = 0x48D2, Offset = 0x060\n    *   **TLB Miss:** Tag 0x48D2 לא נמצא בסט 1. \n    *   הוספה ל-TLB: סט 1, Way 1 ריק. הוספת {Valid=1, Tag=0x48D2, PFN=0x34, LRU=0} ל-Way 1.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D1) הופך ל-LRU (LRU=1), Way 1 (עם Tag 0x48D2) הופך ל-MRU (LRU=0).\n    *   **PA = 0x34060**\n    *   **מצב TLB (סט 1):** Way 0: {V=1, T=0x48D1, PFN=0xAB, LRU=1}, Way 1: {V=1, T=0x48D2, PFN=0x34, LRU=0}\n\n8.  **גישה ל-VA 0x1234A070**\n    *   VPN = 0x1234A, Set = 2, Tag = 0x48D2, Offset = 0x070\n    *   **TLB Miss:** Tag 0x48D2 לא נמצא בסט 2.\n    *   הוספה ל-TLB: סט 2, Way 1 ריק. הוספת {Valid=1, Tag=0x48D2, PFN=0x56, LRU=0} ל-Way 1.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D1) הופך ל-LRU (LRU=1), Way 1 (עם Tag 0x48D2) הופך ל-MRU (LRU=0).\n    *   **PA = 0x56070**\n    *   **מצב TLB (סט 2):** Way 0: {V=1, T=0x48D1, PFN=0xCD, LRU=1}, Way 1: {V=1, T=0x48D2, PFN=0x56, LRU=0}\n\n9.  **גישה ל-VA 0x1234B080**\n    *   VPN = 0x1234B, Set = 3, Tag = 0x48D2, Offset = 0x080\n    *   **TLB Miss:** Tag 0x48D2 לא נמצא בסט 3.\n    *   הוספה ל-TLB: סט 3, Way 1 ריק. הוספת {Valid=1, Tag=0x48D2, PFN=0x78, LRU=0} ל-Way 1.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D1) הופך ל-LRU (LRU=1), Way 1 (עם Tag 0x48D2) הופך ל-MRU (LRU=0).\n    *   **PA = 0x78080**\n    *   **מצב TLB (סט 3):** Way 0: {V=1, T=0x48D1, PFN=0xEF, LRU=1}, Way 1: {V=1, T=0x48D2, PFN=0x78, LRU=0}\n\n10. **גישה ל-VA 0x1234C090**\n    *   VPN = 0x1234C, Set = 0, Tag = 0x48D3, Offset = 0x090\n    *   **TLB Miss:** Tag 0x48D3 לא נמצא בסט 0.\n    *   הוספה ל-TLB: סט 0, Way 1 ריק. הוספת {Valid=1, Tag=0x48D3, PFN=0x9A, LRU=0} ל-Way 1.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D2) הופך ל-LRU (LRU=1), Way 1 (עם Tag 0x48D3) הופך ל-MRU (LRU=0).\n    *   **PA = 0x9A090**\n    *   **מצב TLB (סט 0):** Way 0: {V=1, T=0x48D2, PFN=0x12, LRU=1}, Way 1: {V=1, T=0x48D3, PFN=0x9A, LRU=0}\n\n11. **גישה ל-VA 0x1234D0A0**\n    *   VPN = 0x1234D, Set = 1, Tag = 0x48D3, Offset = 0x0A0\n    *   **TLB Miss:** Tag 0x48D3 לא נמצא בסט 1. שני ה-Ways מלאים: Way 0 (0x48D1, LRU=1), Way 1 (0x48D2, LRU=0).\n    *   החלפה לפי LRU: Way 0 (עם Tag 0x48D1) הוא ה-LRU, ולכן יוחלף.\n    *   הוספה ל-TLB: {Valid=1, Tag=0x48D3, PFN=0xBC, LRU=0} בסט 1, Way 0.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D3) הופך ל-MRU (LRU=0), Way 1 (עם Tag 0x48D2) הופך ל-LRU (LRU=1).\n    *   **PA = 0xBC0A0**\n    *   **מצב TLB (סט 1):** Way 0: {V=1, T=0x48D3, PFN=0xBC, LRU=0}, Way 1: {V=1, T=0x48D2, PFN=0x34, LRU=1}\n\n12. **גישה ל-VA 0x123480B0**\n    *   VPN = 0x12348, Set = 0, Tag = 0x48D2, Offset = 0x0B0\n    *   **TLB Hit:** נמצא בסט 0, Way 0.\n    *   עדכון LRU: Way 0 (עם Tag 0x48D2) הופך ל-MRU (LRU=0), Way 1 (עם Tag 0x48D3) הופך ל-LRU (LRU=1).\n    *   **PA = 0x120B0**\n    *   **מצב TLB (סט 0):** Way 0: {V=1, T=0x48D2, PFN=0x12, LRU=0}, Way 1: {V=1, T=0x48D3, PFN=0x9A, LRU=1}\n\nסיכום פגיעות והחטאות:\n*   סה\"כ גישות: 12\n*   פגיעות (Hits): 3 (גישות 3, 6, 12)\n*   החטאות (Misses): 9 (גישות 1, 2, 4, 5, 7, 8, 9, 10, 11)\n\nאחוז פגיעות (Hit Rate):\n(מספר פגיעות / סה\"כ גישות) * 100% = (3 / 12) * 100% = 25%"
    },
    "difficulty_estimation": "Hard"
  }
}