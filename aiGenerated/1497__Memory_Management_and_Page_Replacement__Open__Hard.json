{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Memory Management and Page Replacement",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-09 20:44:09",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3221,
      "output_tokens": 6797,
      "total_tokens": 30148
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Memory Management",
      "Paging",
      "Page Replacement",
      "TLB"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המממשת זיכרון וירטואלי עם טבלת דפים היררכית דו-מפלסית. פרטי המערכת הם כדלהלן:\n*   **מרחב כתובות וירטואלי**: 32 ביט.\n*   **גודל דף**: 4KB (קילו-בתים).\n*   **גודל כניסה בטבלת דפים (PTE)**: 4 בתים.\n*   כל טבלת דפים (בכל רמה) מאוחסנת בדף אחד בדיוק.\n*   התהליך הנתון מקצה לעצמו 3 מסגרות פיזיות עבור דפי נתונים בלבד (לא כולל מסגרות עבור טבלאות דפים).\n*   המערכת כוללת **TLB (Translation Lookaside Buffer)** בעל 2 כניסות, בשיטת אסוציאטיבית מלאה (Fully Associative). אלגוריתם ההחלפה ב-TLB הוא **LRU**.\n*   אלגוריתם החלפת הדפים (עבור דפי נתונים) הוא **LRU**.\n*   **מצב התחלתי**: כל כניסות ה-TLB אינן תקפות. אף דף נתונים אינו טעון לזיכרון הפיזי. רק טבלת הדפים של הרמה העליונה (P1) טעונה למסגרת בזיכרון הפיזי. כל טבלאות הדפים של הרמה השנייה (P2) נמצאות על הדיסק.\n\nנתונה סדרת הגישות הבאה לכתובות וירטואליות (מספרי דפים וירטואליים בלבד):\n`0x0000A, 0x00014, 0x0000A, 0x00018, 0x0000C, 0x00014, 0x00018, 0x0000A`\n\nעבור כל גישה בסדרה, יש לפרט את השלבים המתבצעים במערכת, כולל:\n1.  **בדיקת TLB**: האם יש פגיעה (hit) או החמצה (miss)? אם החמצה, יש לפרט את עדכון ה-TLB ואת סדר ה-LRU.\n2.  **תרגום כתובת דרך טבלאות הדפים**: כמה גישות לזיכרון הראשי נדרשות? האם נדרשות גישות לדיסק עבור טעינת טבלת דפים (P2)?\n3.  **טיפול ב-Page Fault**: האם מתרחשת פסיקת דף (page fault)? אם כן, יש לפרט את תהליך החלפת הדפים (LRU) ואת המסגרת המפונה (אם קיימת). כמה גישות לדיסק נדרשות עבור טעינת/שמירת דף נתונים?\n4.  **עדכון מצב הזיכרון הפיזי וטבלאות הדפים**: יש לציין את מצב מסגרות הזיכרון הפיזי לדפי נתונים ואת סדר ה-LRU.\n\nבסיום הניתוח, יש לסכם ולציין:\n*   סה\"כ פגיעות ב-TLB (TLB Hits).\n*   סה\"כ החמצות ב-TLB (TLB Misses).\n*   סה\"כ פסיקות דף (Page Faults).\n*   סה\"כ גישות לזיכרון הראשי (Main Memory Accesses).\n*   סה\"כ גישות לדיסק (Disk Accesses).",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "**ניתוח פרמטרי המערכת:**\n*   מרחב כתובות וירטואלי: 32 ביט.\n*   גודל דף: 4KB = 2^12 בתים. לכן, ההיסט (Offset) הוא 12 ביטים.\n*   מספר דף וירטואלי (VPN): 32 - 12 = 20 ביטים.\n*   גודל כניסה בטבלת דפים (PTE): 4 בתים.\n*   מספר כניסות בטבלת דפים לדף: 4KB / 4 בתים = 1024 כניסות. לכן, כל אינדקס ברמה הוא 10 ביטים (log2(1024)).\n*   טבלת דפים דו-מפלסית: VPN באורך 20 ביטים יחולק ל-P1 (ביטים [31:22] - 10 ביטים) ו-P2 (ביטים [21:12] - 10 ביטים).\n*   מסגרות פיזיות לדפי נתונים: 3 מסגרות (נסמן כ-F0, F1, F2).\n*   TLB: 2 כניסות, LRU. טבלת דפים (P2) תטען למסגרת נפרדת (נסמן כ-FPT_0).\n\n**מעקב אחר מצב המערכת וסטטיסטיקות:**\n*   `TLB`: רשימת זוגות (VPN, PFN) עם סדר LRU (הישן ביותר בהתחלה).\n*   `DataFrames`: רשימת זוגות (VPN, PFN) במסגרות הפיזיות, עם סדר LRU (הישן ביותר בהתחלה). נניח שכל דפי הנתונים נטענים כ-Dirty=0 (לא שונו) אלא אם צוין אחרת.\n*   `P2_Tables_Loaded`: רשימת אינדקסי P1 שטבלת ה-P2 שלהם טעונה לזיכרון הפיזי.\n*   `Stats`: מונים עבור TLB Hits/Misses, Page Faults, MM Accesses, Disk Accesses.\n\n**מצב התחלתי:**\n*   `TLB`: `[]`\n*   `DataFrames`: `[]` (קיבולת 3: F0, F1, F2)\n*   `P2_Tables_Loaded`: `[]`\n*   `Stats`: `{'TLB_Hits': 0, 'TLB_Misses': 0, 'Page_Faults': 0, 'MM_Accesses': 0, 'Disk_Accesses': 0}`\n\n--- כלל ספירה: גישה לזיכרון הראשי (MM Access) כוללת קריאה/כתיבה ל-PTE, טעינת דף ל-MM, גישה לנתונים בפועל. גישה לדיסק כוללת קריאה/כתיבה של דף מהדיסק. --- \n\n**גישה 1: 0x0000A (P1=0, P2=10)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (1).\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (1). (P1 נמצא בזיכרון הראשי)\n    *   טבלת P2 עבור P1_0 אינה טעונה (לפי מצב התחלתי).\n        *   **Page Fault עבור טבלת P2_0**: `Stats['Page_Faults']++` (1).\n        *   טעינת טבלת P2_0 מהדיסק: `Stats['Disk_Accesses']++` (1).\n        *   הקצאת מסגרת (נניח FPT_0) וכתיבת P2_0 אליה: `Stats['MM_Accesses']++` (2).\n        *   עדכון P1[0] שיצביע על FPT_0: `Stats['MM_Accesses']++` (3).\n        *   הוספת P1_0 ל-`P2_Tables_Loaded`: `[0]`.\n    *   גישה ל-P2_0[10]: `Stats['MM_Accesses']++` (4).\n    *   דף נתונים 0x0000A אינו טעון (P2_0[10] לא תקף).\n        *   **Page Fault עבור דף נתונים 0x0000A**: `Stats['Page_Faults']++` (2).\n        *   מסגרות פנויות: כן (F0, F1, F2). טעינת דף 0x0000A למסגרת F0.\n        *   טעינת דף 0x0000A מהדיסק: `Stats['Disk_Accesses']++` (2).\n        *   כתיבת דף 0x0000A ל-F0: `Stats['MM_Accesses']++` (5).\n        *   עדכון P2_0[10] (Valid=1, PFN=F0, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (6).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (7).\n4.  **עדכון TLB**: הוספת (0x0000A, F0). `TLB = [(0x0000A, F0)]`. סדר LRU: 0x0000A.\n5.  **עדכון DataFrames**: הוספת (0x0000A, F0). `DataFrames = [(0x0000A, F0)]`. סדר LRU: 0x0000A.\n**מצב ביניים**: TLB Hits: 0, TLB Misses: 1, Page Faults: 2, MM Accesses: 7, Disk Accesses: 2\n\n**גישה 2: 0x00014 (P1=0, P2=20)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (2).\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (8). (P1_0 כבר בזיכרון).\n    *   טבלת P2_0 כבר טעונה.\n    *   גישה ל-P2_0[20]: `Stats['MM_Accesses']++` (9).\n    *   דף נתונים 0x00014 אינו טעון (P2_0[20] לא תקף).\n        *   **Page Fault עבור דף נתונים 0x00014**: `Stats['Page_Faults']++` (3).\n        *   מסגרות פנויות: כן (F1, F2). טעינת דף 0x00014 למסגרת F1.\n        *   טעינת דף 0x00014 מהדיסק: `Stats['Disk_Accesses']++` (3).\n        *   כתיבת דף 0x00014 ל-F1: `Stats['MM_Accesses']++` (10).\n        *   עדכון P2_0[20] (Valid=1, PFN=F1, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (11).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (12).\n4.  **עדכון TLB**: הוספת (0x00014, F1). `TLB = [(0x0000A, F0), (0x00014, F1)]`. סדר LRU: 0x0000A, 0x00014.\n5.  **עדכון DataFrames**: הוספת (0x00014, F1). `DataFrames = [(0x0000A, F0), (0x00014, F1)]`. סדר LRU: 0x0000A, 0x00014.\n**מצב ביניים**: TLB Hits: 0, TLB Misses: 2, Page Faults: 3, MM Accesses: 12, Disk Accesses: 3\n\n**גישה 3: 0x0000A (P1=0, P2=10)**\n1.  **TLB**: פגיעה (0x0000A, F0). `Stats['TLB_Hits']++` (1).\n    *   עדכון סדר LRU ב-TLB: 0x00014, 0x0000A.\n2.  **תרגום כתובת**: אין צורך ב-Page Table Walk.\n3.  **Page Fault**: לא מתרחש. דף 0x0000A כבר ב-F0.\n4.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (13).\n5.  **עדכון PTE (Accessed bit)**: עדכון P2_0[10] (Accessed=1): `Stats['MM_Accesses']++` (14).\n6.  **עדכון DataFrames**: עדכון סדר LRU: 0x00014, 0x0000A.\n**מצב ביניים**: TLB Hits: 1, TLB Misses: 2, Page Faults: 3, MM Accesses: 14, Disk Accesses: 3\n\n**גישה 4: 0x00018 (P1=0, P2=24)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (3).\n    *   TLB מלא. ה-LRU הוא (0x00014, F1). כניסה זו תוחלף.\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (15).\n    *   גישה ל-P2_0[24]: `Stats['MM_Accesses']++` (16).\n    *   דף נתונים 0x00018 אינו טעון (P2_0[24] לא תקף).\n        *   **Page Fault עבור דף נתונים 0x00018**: `Stats['Page_Faults']++` (4).\n        *   מסגרות פנויות: כן (F2). טעינת דף 0x00018 למסגרת F2.\n        *   טעינת דף 0x00018 מהדיסק: `Stats['Disk_Accesses']++` (4).\n        *   כתיבת דף 0x00018 ל-F2: `Stats['MM_Accesses']++` (17).\n        *   עדכון P2_0[24] (Valid=1, PFN=F2, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (18).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (19).\n4.  **עדכון TLB**: החלפת (0x00014, F1) ב-(0x00018, F2). `TLB = [(0x0000A, F0), (0x00018, F2)]`. סדר LRU: 0x0000A, 0x00018.\n5.  **עדכון DataFrames**: הוספת (0x00018, F2). `DataFrames = [(0x00014, F1), (0x0000A, F0), (0x00018, F2)]`. סדר LRU: 0x00014, 0x0000A, 0x00018.\n**מצב ביניים**: TLB Hits: 1, TLB Misses: 3, Page Faults: 4, MM Accesses: 19, Disk Accesses: 4\n\n**גישה 5: 0x0000C (P1=0, P2=12)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (4).\n    *   TLB מלא. ה-LRU הוא (0x0000A, F0). כניסה זו תוחלף.\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (20).\n    *   גישה ל-P2_0[12]: `Stats['MM_Accesses']++` (21).\n    *   דף נתונים 0x0000C אינו טעון. מסגרות מלאות (F0, F1, F2).\n        *   **Page Fault עבור דף נתונים 0x0000C**: `Stats['Page_Faults']++` (5).\n        *   בחירת קורבן: דף 0x00014 (ב-F1) הוא ה-LRU ב-`DataFrames`. דף 0x00014 נקי (Dirty=0), אין צורך בכתיבה לדיסק.\n        *   עדכון P2_0[20] (Valid=0 עבור 0x00014): `Stats['MM_Accesses']++` (22).\n        *   טעינת דף 0x0000C מהדיסק: `Stats['Disk_Accesses']++` (5).\n        *   כתיבת דף 0x0000C ל-F1: `Stats['MM_Accesses']++` (23).\n        *   עדכון P2_0[12] (Valid=1, PFN=F1, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (24).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (25).\n4.  **עדכון TLB**: החלפת (0x0000A, F0) ב-(0x0000C, F1). `TLB = [(0x00018, F2), (0x0000C, F1)]`. סדר LRU: 0x00018, 0x0000C.\n5.  **עדכון DataFrames**: הסרת (0x00014, F1), הוספת (0x0000C, F1). `DataFrames = [(0x0000A, F0), (0x00018, F2), (0x0000C, F1)]`. סדר LRU: 0x0000A, 0x00018, 0x0000C.\n**מצב ביניים**: TLB Hits: 1, TLB Misses: 4, Page Faults: 5, MM Accesses: 25, Disk Accesses: 5\n\n**גישה 6: 0x00014 (P1=0, P2=20)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (5).\n    *   TLB מלא. ה-LRU הוא (0x00018, F2). כניסה זו תוחלף.\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (26).\n    *   גישה ל-P2_0[20]: `Stats['MM_Accesses']++` (27). (PTE עבור 0x00014 אינו תקף כעת).\n    *   דף נתונים 0x00014 אינו טעון. מסגרות מלאות.\n        *   **Page Fault עבור דף נתונים 0x00014**: `Stats['Page_Faults']++` (6).\n        *   בחירת קורבן: דף 0x0000A (ב-F0) הוא ה-LRU ב-`DataFrames`. דף 0x0000A נקי (Dirty=0), אין צורך בכתיבה לדיסק.\n        *   עדכון P2_0[10] (Valid=0 עבור 0x0000A): `Stats['MM_Accesses']++` (28).\n        *   טעינת דף 0x00014 מהדיסק: `Stats['Disk_Accesses']++` (6).\n        *   כתיבת דף 0x00014 ל-F0: `Stats['MM_Accesses']++` (29).\n        *   עדכון P2_0[20] (Valid=1, PFN=F0, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (30).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (31).\n4.  **עדכון TLB**: החלפת (0x00018, F2) ב-(0x00014, F0). `TLB = [(0x0000C, F1), (0x00014, F0)]`. סדר LRU: 0x0000C, 0x00014.\n5.  **עדכון DataFrames**: הסרת (0x0000A, F0), הוספת (0x00014, F0). `DataFrames = [(0x00018, F2), (0x0000C, F1), (0x00014, F0)]`. סדר LRU: 0x00018, 0x0000C, 0x00014.\n**מצב ביניים**: TLB Hits: 1, TLB Misses: 5, Page Faults: 6, MM Accesses: 31, Disk Accesses: 6\n\n**גישה 7: 0x00018 (P1=0, P2=24)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (6).\n    *   TLB מלא. ה-LRU הוא (0x0000C, F1). כניסה זו תוחלף.\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (32).\n    *   גישה ל-P2_0[24]: `Stats['MM_Accesses']++` (33). (PTE עבור 0x00018 תקף ומצביע ל-F2).\n    *   דף נתונים 0x00018 כבר טעון (ב-F2).\n3.  **Page Fault**: לא מתרחש.\n4.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (34).\n5.  **עדכון PTE (Accessed bit)**: עדכון P2_0[24] (Accessed=1): `Stats['MM_Accesses']++` (35).\n6.  **עדכון TLB**: החלפת (0x0000C, F1) ב-(0x00018, F2). `TLB = [(0x00014, F0), (0x00018, F2)]`. סדר LRU: 0x00014, 0x00018.\n7.  **עדכון DataFrames**: עדכון סדר LRU: 0x0000C, 0x00014, 0x00018.\n**מצב ביניים**: TLB Hits: 1, TLB Misses: 6, Page Faults: 6, MM Accesses: 35, Disk Accesses: 6\n\n**גישה 8: 0x0000A (P1=0, P2=10)**\n1.  **TLB**: החמצה. `Stats['TLB_Misses']++` (7).\n    *   TLB מלא. ה-LRU הוא (0x00014, F0). כניסה זו תוחלף.\n2.  **תרגום כתובת (Page Table Walk)**:\n    *   גישה ל-P1[0]: `Stats['MM_Accesses']++` (36).\n    *   גישה ל-P2_0[10]: `Stats['MM_Accesses']++` (37). (PTE עבור 0x0000A אינו תקף כעת).\n    *   דף נתונים 0x0000A אינו טעון. מסגרות מלאות.\n        *   **Page Fault עבור דף נתונים 0x0000A**: `Stats['Page_Faults']++` (7).\n        *   בחירת קורבן: דף 0x0000C (ב-F1) הוא ה-LRU ב-`DataFrames`. דף 0x0000C נקי (Dirty=0), אין צורך בכתיבה לדיסק.\n        *   עדכון P2_0[12] (Valid=0 עבור 0x0000C): `Stats['MM_Accesses']++` (38).\n        *   טעינת דף 0x0000A מהדיסק: `Stats['Disk_Accesses']++` (7).\n        *   כתיבת דף 0x0000A ל-F1: `Stats['MM_Accesses']++` (39).\n        *   עדכון P2_0[10] (Valid=1, PFN=F1, Accessed=1, Dirty=0): `Stats['MM_Accesses']++` (40).\n3.  **גישה לנתונים בפועל**: `Stats['MM_Accesses']++` (41).\n4.  **עדכון TLB**: החלפת (0x00014, F0) ב-(0x0000A, F1). `TLB = [(0x00018, F2), (0x0000A, F1)]`. סדר LRU: 0x00018, 0x0000A.\n5.  **עדכון DataFrames**: הסרת (0x0000C, F1), הוספת (0x0000A, F1). `DataFrames = [(0x00014, F0), (0x00018, F2), (0x0000A, F1)]`. סדר LRU: 0x00014, 0x00018, 0x0000A.\n\n**סיכום סופי:**\n*   **סה\"כ פגיעות ב-TLB**: 1\n*   **סה\"כ החמצות ב-TLB**: 7\n*   **סה\"כ פסיקות דף**: 7 (אחת עבור טעינת טבלת P2_0, שש עבור טעינת דפי נתונים)\n*   **סה\"כ גישות לזיכרון הראשי**: 41\n*   **סה\"כ גישות לדיסק**: 7",
      "difficulty_estimation": "Hard"
    }
  }
}