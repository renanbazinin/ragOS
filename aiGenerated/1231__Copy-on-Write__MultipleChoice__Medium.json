{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Copy-on-Write",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 08:51:23",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1142,
      "output_tokens": 970,
      "total_tokens": 4806
    }
  },
  "question": {
    "id": 6,
    "type": "MultipleChoice",
    "topic": [
      "Copy-on-Write",
      "Virtual Memory",
      "Processes"
    ],
    "content": {
      "text": "נתון קטע קוד ב-C המבצע את הפעולות הבאות:\n1. הקצאת דף זיכרון אחד ואיפוסו בכתובת וירטואלית מסוימת.\n2. קריאה לפונקציה `fork()`.\n3. תהליך הבן (child) כותב לכתובת הזיכרון שהוקצתה.\n\nבהנחה שהמערכת משתמשת במנגנון Copy-on-Write (CoW), מהי הטענה הנכונה ביותר לגבי מצב הזיכרון מיד לאחר כתיבת הנתונים על ידי תהליך הבן?",
      "code_snippet": "int* ptr = (int*)malloc(4096); // Assume this allocates exactly one page\nif (ptr) {\n    *ptr = 10; // Initialize the page\n}\n\npid_t pid = fork();\n\nif (pid == 0) { // Child process\n    if (ptr) {\n        *ptr = 20; // Child writes to the page\n    }\n}",
      "options": [
        "א. הדף בכתובת המקורית נשאר משותף לשני התהליכים, והשינוי מתבצע ישירות עליו.",
        "ב. נוצר עותק חדש של הדף עבור תהליך הבן, וטבלת הדפים של הבן מתעדכנת להצביע על הדף החדש. הדף המקורי נשאר משותף לשני התהליכים אך רק לקריאה.",
        "ג. נוצר עותק חדש של הדף עבור תהליך הבן. טבלת הדפים של הבן מתעדכנת להצביע על הדף החדש עם הרשאת כתיבה, וטבלת הדפים של האב מתעדכנת כך שהדף המקורי הופך להיות פרטי לאב עם הרשאת כתיבה.",
        "ד. נוצר עותק חדש של הדף עבור תהליך האב. טבלת הדפים של האב מתעדכנת להצביע על הדף החדש עם הרשאת כתיבה, והדף המקורי נשאר פרטי לבן עם הרשאת קריאה וכתיבה."
      ]
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ג",
      "explanation": "ההסבר הנכון הוא ג'. כאשר תהליך אב מבצע fork, ומערכת ההפעלה משתמשת במנגנון Copy-on-Write, דפי הזיכרון הניתנים לכתיבה (writable pages) משותפים בין האב לבן ומוגדרים כקריאה בלבד (read-only) בטבלאות הדפים של שני התהליכים. כאשר תהליך הבן מנסה לכתוב לכתובת זו בפעם הראשונה, מתרחשת 'תקלת דף' (page fault). מערכת ההפעלה מטפלת בתקלה על ידי יצירת עותק פיזי חדש של הדף עבור תהליך הבן. לאחר יצירת העותק, טבלת הדפים של הבן מתעדכנת כך שהכתובת הווירטואלית הרלוונטית תצביע על הדף הפיזי החדש, וההרשאה שלו משתנה לקריאה וכתיבה (read/write). במקביל, טבלת הדפים של האב מתעדכנת כך שהדף הפיזי המקורי יישאר בבעלותו הבלעדית (לאחר שהיה משותף), וההרשאה שלו משתנה בחזרה לקריאה וכתיבה. כך, כל תהליך יכול לשנות את הנתונים שלו באופן עצמאי מבלי להשפיע על האחר."
    },
    "difficulty_estimation": "Medium"
  }
}