{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "TLB",
    "requested_type": "Open",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-08 08:11:51",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 2223,
      "output_tokens": 1527,
      "total_tokens": 5204
    }
  },
  "question": {
    "id": 10,
    "type": "Open",
    "topic": [
      "Memory Management",
      "Virtual Memory",
      "TLB",
      "Context Switching"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המריצה מספר תהליכים במקביל, ומתבצעות בה החלפות הקשר (context switches) תכופות בין התהליכים. המערכת משתמשת בזיכרון וירטואלי וב-TLB (Translation Lookaside Buffer) לזירוז תרגום כתובות.",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "10.1",
        "text": "כיצד החלפת הקשר משפיעה בדרך כלל על ה-TLB ועל ביצועי המערכת?",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "10.2",
        "text": "תאר שני מנגנונים שונים בהם מערכות הפעלה וחומרה יכולות לטפל ב-TLB בזמן החלפת הקשר.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "10.3",
        "text": "עבור כל אחד מהמנגנונים שתארת בסעיף הקודם, פרט את אופן פעולתו, יתרונותיו וחסרונותיו.",
        "code_snippet": null,
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "10.1: כאשר מתרחשת החלפת הקשר, מערכת ההפעלה עוברת מהקשר של תהליך אחד להקשר של תהליך אחר. לכל תהליך יש מרחב כתובות וירטואלי משלו, ולכן מיפויי הכתובות הווירטואליות לכתובות פיזיות שונים. כתוצאה מכך, הערכים ב-TLB (המכילים מיפויים מהתהליך הקודם) הופכים להיות לא רלוונטיים, ואף עלולים להיות שגויים או להוביל לשגיאות הגנה אם לא מטופלים. הדבר גורם למספר גבוה של TLB misses עבור התהליך החדש, שצריך למלא מחדש את ה-TLB במיפויים הרלוונטיים לו. כל TLB miss דורש גישה לטבלאות הדפים בזיכרון הראשי, מה שמאט משמעותית את תרגום הכתובות ופוגע בביצועי המערכת.\n\n10.2 ו-10.3:\nקיימים שני מנגנונים עיקריים לטיפול ב-TLB בזמן החלפת הקשר:\n\n1.  **ניקוי (Flush) של ה-TLB:**\n    *   **אופן פעולה:** במנגנון זה, בכל פעם שמתרחשת החלפת הקשר, כל הכניסות ב-TLB מנוקות (מוכרזות כלא תקפות). הדבר מבטיח שהתהליך החדש לא ישתמש במיפויים שגויים או מיושנים. לאחר הניקוי, ה-TLB יתמלא מחדש בהדרגה במיפויים של התהליך הנוכחי.\n    *   **יתרונות:** פשוט ליישום בחומרה ובתוכנה. מבטיח נכונות מוחלטת של תרגום הכתובות – אין חשש לשימוש במיפויים שגויים.\n    *   **חסרונות:** פגיעה משמעותית בביצועים. מכיוון שה-TLB מתרוקן לחלוטין בכל החלפת הקשר, התהליך החדש יסבול ממספר רב של TLB misses בתחילת ריצתו, עד שה-TLB יתמלא מחדש. זהו עונש ביצועי כבד, במיוחד במערכות עם החלפות קשר תכופות.\n\n2.  **שימוש במזהי מרחב כתובות (ASID - Address Space Identifier):**\n    *   **אופן פעולה:** במנגנון זה, לכל כניסה ב-TLB מצורף מזהה ייחודי (ASID) של מרחב הכתובות (התהליך) אליו היא שייכת. כאשר ה-MMU מבצע חיפוש ב-TLB, הוא בודק לא רק את הכתובת הווירטואלית אלא גם שה-ASID של הכניסה ב-TLB תואם ל-ASID של התהליך הנוכחי (שמאוחסן ברגיסטר ייעודי). בזמן החלפת קשר, מערכת ההפעלה פשוט מעדכנת את רגיסטר ה-ASID הפעיל, ואין צורך לנקות את ה-TLB. כניסות של תהליכים אחרים נשארות ב-TLB אך אינן נגישות.\n    *   **יתרונות:** שיפור דרמטי בביצועים. כניסות TLB של תהליכים שאינם פעילים כרגע יכולות להישאר ב-TLB. אם תהליך חוזר לפעילות, ייתכן שמיפויים שלו עדיין יהיו ב-TLB, מה שיחסוך TLB misses יקרים. זה משפר את תפוקת המערכת הכוללת.\n    *   **חסרונות:** מורכבות חומרתית גבוהה יותר ליישום ה-TLB. מספר ה-ASIDs הזמינים מוגבל (לרוב מספר ביטים קטן), כך שאם רצים במערכת תהליכים רבים מאוד, ייתכן שיהיה צורך למחזר ASIDs. במקרה של מיחזור ASID, יש לוודא שכל הכניסות הישנות ב-TLB המקושרות ל-ASID זה (אך שייכות לתהליך קודם) יסומנו כלא תקפות או ינוקו, כדי למנוע שימוש שגוי. הדבר עדיין יכול לדרוש ניקוי חלקי של ה-TLB במקרים מסוימים."
    },
    "difficulty_estimation": "Medium"
  }
}