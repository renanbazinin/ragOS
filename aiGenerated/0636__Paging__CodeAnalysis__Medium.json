{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 23:15:59",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 3180,
      "output_tokens": 1276,
      "total_tokens": 9927
    }
  },
  "question": {
    "id": 8,
    "type": "CodeAnalysis",
    "topic": [
      "Paging",
      "Memory Management",
      "Virtual Memory",
      "Page Faults"
    ],
    "content": {
      "text": "נתונה תוכנית C המבצעת איטרציה על מערך דו-ממדי גדול. התוכנית רצה על מערכת עם זיכרון וירטואלי.\n\nנתונים:\n- גודל דף: 4 קילובייט (KB).\n- גודל משתנה `int`: 4 בתים.\n- זיכרון פיזי זמין לדפי נתונים (user data pages) של התהליך: 128 קילובייט (KB).\n- מדיניות החלפת דפים: LRU (Least Recently Used).\n- ניתן להניח שהמערך `arr` מיושר לגבול דף (page boundary).\n- ניתן להניח שקטעי קוד, מחסנית (stack) וטבלת הדפים של התהליך אינם מתחרים על הזיכרון הפיזי המוקצה לדפי הנתונים.\n\nכמה Page Faults (כשלים בדף) יתרחשו במהלך ריצת הלולאות בתוכנית הנתונה? נמק את תשובתך.",
      "code_snippet": "int arr[1024][1024];\n\nvoid access_array() {\n    for (int i = 0; i < 1024; ++i) {\n        for (int j = 0; j < 1024; ++j) {\n            arr[i][j] = i + j;\n        }\n    }\n}",
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "גודל המערך `arr` הוא `1024 * 1024 * 4` בתים = 4 מגה-בייט (MB).\nגודל דף הוא 4 קילובייט (KB).\nלכן, המערך תופס `4MB / 4KB = 1024` דפים.\nכל שורה במערך `arr[i]` תופסת `1024 * 4 = 4096` בתים, שהם בדיוק גודל של דף אחד. כלומר, שורה `i` של המערך נמצאת כולה בדף `i`.\n\nהזיכרון הפיזי הזמין לדפי נתונים הוא 128 קילובייט (KB).\nמספר מסגרות הזיכרון הפיזי (frames) הזמינות לדפי נתונים הוא `128KB / 4KB = 32` מסגרות.\n\nהלולאה החיצונית עוברת על השורות (`i`), והלולאה הפנימית עוברת על העמודות (`j`).\nכאשר `i=0`, התוכנית ניגשת לאלמנטים `arr[0][0]` עד `arr[0][1023]`. כל אלה נמצאים בדף 0.\n- הגישה הראשונה ל-`arr[0][0]` תגרום ל-Page Fault אחד, מכיוון שדף 0 אינו בזיכרון. דף 0 נטען לאחת המסגרות.\n- כל הגישות הבאות בדף 0 (כלומר `arr[0][1]` עד `arr[0][1023]`) הן Page Hits ולא יגרמו ל-Page Faults נוספים.\nסה\"כ 1 Page Fault עבור `i=0`.\n\nבאופן דומה, עבור `i=1` עד `i=31`:\n- בכל איטרציה של `i`, ניגשים לדף חדש (דף `i`).\n- הגישה הראשונה לדף `i` תגרום ל-Page Fault אחד.\n- לאחר `i=31`, 32 דפים (0 עד 31) נטענו ל-32 המסגרות הפיזיות. כל המסגרות מלאות.\n\nהחל מ-`i=32`:\n- ניגשים לדף 32, והוא אינו בזיכרון. תתרחש Page Fault.\n- מכיוון שמדיניות ההחלפה היא LRU והדף הכי פחות בשימוש הוא דף 0 (שנטען ראשון ולא היה בשימוש מאז), דף 0 יפונה מהזיכרון הפיזי, ודף 32 יטען במקומו.\n- תבנית זו חוזרת על עצמה עבור כל `i` עד `1023`. בכל איטרציה של הלולאה החיצונית (עבור כל שורה), ניגשים לדף חדש שלא נמצא בזיכרון הפיזי (עקב הגבלת מספר המסגרות ושימוש ב-LRU), ולכן תתרחש Page Fault אחת.\n\nסה\"כ מספר ה-Page Faults הוא 1024, אחד עבור כל אחת מ-1024 השורות (דפים) במערך, כאשר כל שורה נטענת לראשונה (או נטענת מחדש לאחר פינוי) במהלך האיטרציה שלה.",
      "code_snippet": null
    },
    "difficulty_estimation": "Medium"
  }
}