{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 23:09:28",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4788,
      "output_tokens": 6114,
      "total_tokens": 24449
    }
  },
  "question": {
    "id": 8,
    "type": "Open",
    "topic": [
      "Paging",
      "Virtual Memory",
      "TLB",
      "Page Replacement"
    ],
    "content": {
      "text": "נתונה מערכת זיכרון וירטואלי עם טבלת דפים היררכית בעלת 2 רמות, ו-TLB.\nגודל דף: 4KB.\nגודל כתובת וירטואלית: 32 ביטים.\nגודל כתובת פיזית: 20 ביטים.\nכל כניסה בטבלת הדפים (PTE) היא בגודל 4 בתים (32 ביטים), ומבנה ה-PTE הוא כדלקמן:\n[PFN (8 ביטים)] [V (Valid)] [P (Present)] [D (Dirty)] [A (Accessed)] [R/W (Read/Write)] [שאר 19 ביטים שמורים/לא בשימוש]\nה-TLB הוא בעל 4 כניסות, fully associative, ומשתמש באלגוריתם LRU להחלפה.\nנתון כי למערכת יש 8 מסגרות פיזיות זמינות עבור דפי נתונים של תהליך (לא כולל מסגרות עבור טבלאות דפים עצמן). מסגרות אלו ממוספרות מ-0x20 עד 0x27 (כולל).\n\n**תת-שאלה 1:**\nבהתבסס על הנתונים, פרטו את מבנה הכתובת הוירטואלית (מספר ביטים ל-P1, P2, Offset).\n\n**תת-שאלה 2:**\nנתונה טבלת הדפים הבאה עבור תהליך מסוים (המספרים בבסיס 16):\n**טבלת דפים רמה 1 (P1):**\nP1_Entry[0x0] -> PFN = 0x10, V=1, P=1, D=0, A=0, R/W=1\nP1_Entry[0x1] -> PFN = 0x11, V=1, P=1, D=0, A=0, R/W=1\nP1_Entry[0x2] -> PFN = 0x00, V=0, P=0, D=0, A=0, R/W=0 (לא בשימוש)\n...\n**טבלת דפים רמה 2 (P2) הממוקמת ב-PFN 0x10 (עבור P1_Entry[0x0]):**\nP2_Entry[0x0] -> PFN = 0x20, V=1, P=1, D=0, A=0, R/W=1\nP2_Entry[0x1] -> PFN = 0x21, V=1, P=1, D=0, A=0, R/W=1\nP2_Entry[0x2] -> PFN = 0x22, V=1, P=1, D=0, A=0, R/W=1\nP2_Entry[0x3] -> PFN = 0x23, V=1, P=1, D=0, A=0, R/W=1\n...\n**טבלת דפים רמה 2 (P2) הממוקמת ב-PFN 0x11 (עבור P1_Entry[0x1]):**\nP2_Entry[0x0] -> PFN = 0x24, V=1, P=1, D=0, A=0, R/W=1\nP2_Entry[0x1] -> PFN = 0x25, V=1, P=1, D=0, A=0, R/W=1\nP2_Entry[0x2] -> PFN = 0x00, V=0, P=0, D=0, A=0, R/W=0 (לא בשימוש)\n...\n\nנתונה הכתובת הוירטואלית `0x00101020`. פרטו את כל שלבי התרגום לכתובת פיזית. מהי הכתובת הפיזית הסופית? האם תתרחש פסיקת דף (Page Fault) במהלך הגישה לנתונים? הסבירו.\n\n**תת-שאלה 3:**\nהתהליך מבצע את סדרת הגישות (קריאה) לכתובות הוירטואליות הבאות:\n`0x00000000`, `0x00001000`, `0x00002000`, `0x00003000`, `0x00100000`, `0x00101000`, `0x00000000`, `0x00001000`, `0x00102000`, `0x00004000`\n\nבהנחה שה-TLB ריק בתחילה, וטבלת הדפים ברמות 1 ו-2 (כפי שמוצגות לעיל) כבר טעונות בזיכרון הפיזי. כמו כן, כל דפי הנתונים שאינם מופיעים באופן מפורש בטבלאות הדפים הנתונות (P2_Entry[X]) אינם Present (כלומר ה-P ביט שלהם הוא 0). כאשר מתרחשת פסיקת דף עבור דף נתונים, הוא נטען למסגרת הפנויה הבאה מבין 0x20-0x27 (אם יש) או מחליף את דף הנתונים ה-LRU בזיכרון הפיזי. יש לעדכן את ה-PTE המתאים.\nעקבו אחר סדרת הגישות וחשבו:\nא. כמה TLB Misses יתרחשו?\nב. כמה Page Faults יתרחשו עבור דפי הנתונים?\nג. הציגו את מצב ה-TLB ואת רשימת המסגרות הפיזיות (עבור דפי נתונים בלבד) לאחר כל גישה. יש להציג את ה-TLB ואת המסגרות כרשימות LRU, כאשר האלמנט האחרון הוא ה-MRU (Most Recently Used).",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "**פתרון תת-שאלה 1:**\nגודל דף הוא 4KB, כלומר 2^12 בתים. לכן, ההיסט (Offset) הוא 12 ביטים.\nגודל כתובת וירטואלית הוא 32 ביטים. נותרו 32 - 12 = 20 ביטים עבור מספרי הדפים (P1 ו-P2).\nכל טבלת דפים מכילה 1024 כניסות (4KB / 4 בתים לכניסה). לכן, כל רמה בטבלת הדפים צריכה 10 ביטים (2^10 = 1024).\nמבנה הכתובת הוירטואלית:\n*   P1: 10 ביטים (ביטים 22-31)\n*   P2: 10 ביטים (ביטים 12-21)\n*   Offset: 12 ביטים (ביטים 0-11)\n**מבנה כללי:** [P1 (10 ביטים) | P2 (10 ביטים) | Offset (12 ביטים)]\n\n**פתרון תת-שאלה 2:**\nהכתובת הוירטואלית `0x00101020` בבינארי (32 ביטים): `0000 0000 0001 0000 0001 0000 0010 0000`\nנחלק לפי המבנה:\n*   P1 = `0000000000` (ביטים 22-31) = `0x0`\n*   P2 = `0100000000` (ביטים 12-21) = `0x40`\n*   Offset = `00100000` (ביטים 0-11) = `0x20`\n\n**שלבי התרגום:**\n1.  **גישה לטבלת דפים רמה 1 (P1):** המערכת ניגשת לכניסה מספר `0x0` בטבלת דפים רמה 1.\n    *   לפי הנתון: `P1_Entry[0x0]` מכיל `PFN = 0x10` עם ביטים `V=1, P=1`. ה-PTE תקין ומפנה למסגרת הפיזית `0x10` המכילה את טבלת דפים רמה 2.\n    *   אין Page Fault בשלב זה.\n2.  **גישה לטבלת דפים רמה 2 (P2):** המערכת ניגשת לכניסה מספר `0x40` בטבלת דפים רמה 2, הממוקמת ב-PFN 0x10.\n    *   הכתובת הפיזית של ה-PTE בטבלת דפים רמה 2 תהיה: `(PFN_P1 << 12) + (P2_Index * sizeof(PTE))` = `(0x10 << 12) + (0x40 * 4)` = `0x10000 + 0x100` = `0x10100`.\n    *   הערך של `P2_Entry[0x40]` אינו מופיע באופן מפורש בטבלה הנתונה. לפי ההנחיה בשאלה, כל דפי הנתונים שאינם מופיעים מפורשות הם `P=0` (לא Present).\n    *   **תוצאה:** תתרחש **פסיקת דף (Page Fault)** עבור דף הנתונים, מכיוון שהביט `P` ב-PTE המתאים הוא 0. לא ניתן לחשב כתובת פיזית סופית מכיוון שהדף אינו בזיכרון הפיזי.\n\n**פתרון תת-שאלה 3:**\n**מיפוי כתובות וירטואליות למספרי דפים וירטואליים (VP):**\n*   `0x00000000` -> P1=`0x0`, P2=`0x0` (VP `0x000`) -> PFN `0x20` (P=1)\n*   `0x00001000` -> P1=`0x0`, P2=`0x1` (VP `0x001`) -> PFN `0x21` (P=1)\n*   `0x00002000` -> P1=`0x0`, P2=`0x2` (VP `0x002`) -> PFN `0x22` (P=1)\n*   `0x00003000` -> P1=`0x0`, P2=`0x3` (VP `0x003`) -> PFN `0x23` (P=1)\n*   `0x00100000` -> P1=`0x0`, P2=`0x40` (VP `0x040`) -> P=0 (לא מפורש)\n*   `0x00101000` -> P1=`0x0`, P2=`0x41` (VP `0x041`) -> P=0 (לא מפורש)\n*   `0x00102000` -> P1=`0x0`, P2=`0x42` (VP `0x042`) -> P=0 (לא מפורש)\n*   `0x00004000` -> P1=`0x0`, P2=`0x4` (VP `0x004`) -> P=0 (לא מפורש)\n\n**מעקב אחר גישות (TLB ו-Data Frames כרשימות LRU, האחרון הוא MRU):**\n**מצב התחלתי:**\n*   TLB: `[]`\n*   Data Frames (VP, PFN): `[]` (8 מסגרות זמינות: 0x20-0x27)\n*   TLB Misses: 0, Page Faults: 0\n\n1.  **גישה: `0x00000000` (VP `0x000`)**\n    *   **TLB Miss.** (ריק). Page Walk: P1[0x0]->PFN 0x10, P2[0x0]->PFN 0x20 (P=1).\n    *   אין Page Fault.\n    *   TLB: `[(0x000, 0x20)]`\n    *   Data Frames: `[(0x000, 0x20)]`\n    *   סה\"כ: TLB Misses: 1, Page Faults: 0\n\n2.  **גישה: `0x00001000` (VP `0x001`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x1]->PFN 0x21 (P=1).\n    *   אין Page Fault.\n    *   TLB: `[(0x000, 0x20), (0x001, 0x21)]`\n    *   Data Frames: `[(0x000, 0x20), (0x001, 0x21)]`\n    *   סה\"כ: TLB Misses: 2, Page Faults: 0\n\n3.  **גישה: `0x00002000` (VP `0x002`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x2]->PFN 0x22 (P=1).\n    *   אין Page Fault.\n    *   TLB: `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22)]`\n    *   Data Frames: `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22)]`\n    *   סה\"כ: TLB Misses: 3, Page Faults: 0\n\n4.  **גישה: `0x00003000` (VP `0x003`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x3]->PFN 0x23 (P=1).\n    *   אין Page Fault.\n    *   TLB: `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22), (0x003, 0x23)]`\n    *   Data Frames: `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22), (0x003, 0x23)]`\n    *   סה\"כ: TLB Misses: 4, Page Faults: 0\n\n5.  **גישה: `0x00100000` (VP `0x040`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x40]->P=0.\n    *   **Page Fault!** (PF #1). הקצאת PFN 0x24 ל-VP 0x040. עדכון P2[0x40] ל-PFN 0x24, P=1.\n    *   TLB: פינוי (0x000, 0x20) (LRU). הוספת (0x040, 0x24).\n        `[(0x001, 0x21), (0x002, 0x22), (0x003, 0x23), (0x040, 0x24)]`\n    *   Data Frames: הוספת (0x040, 0x24) כ-MRU. (0x000, 0x20) הופך ל-LRU אך לא מפונה (עדיין יש מקום).\n        `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22), (0x003, 0x23), (0x040, 0x24)]`\n    *   סה\"כ: TLB Misses: 5, Page Faults: 1\n\n6.  **גישה: `0x00101000` (VP `0x041`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x41]->P=0.\n    *   **Page Fault!** (PF #2). הקצאת PFN 0x25 ל-VP 0x041. עדכון P2[0x41] ל-PFN 0x25, P=1.\n    *   TLB: פינוי (0x001, 0x21) (LRU). הוספת (0x041, 0x25).\n        `[(0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25)]`\n    *   Data Frames: הוספת (0x041, 0x25).\n        `[(0x000, 0x20), (0x001, 0x21), (0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25)]`\n    *   סה\"כ: TLB Misses: 6, Page Faults: 2\n\n7.  **גישה: `0x00000000` (VP `0x000`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x0]->PFN 0x20 (P=1).\n    *   אין Page Fault.\n    *   TLB: פינוי (0x002, 0x22) (LRU). הוספת (0x000, 0x20).\n        `[(0x003, 0x23), (0x040, 0x24), (0x041, 0x25), (0x000, 0x20)]`\n    *   Data Frames: (0x000, 0x20) הופך ל-MRU.\n        `[(0x001, 0x21), (0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25), (0x000, 0x20)]`\n    *   סה\"כ: TLB Misses: 7, Page Faults: 2\n\n8.  **גישה: `0x00001000` (VP `0x001`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x1]->PFN 0x21 (P=1).\n    *   אין Page Fault.\n    *   TLB: פינוי (0x003, 0x23) (LRU). הוספת (0x001, 0x21).\n        `[(0x040, 0x24), (0x041, 0x25), (0x000, 0x20), (0x001, 0x21)]`\n    *   Data Frames: (0x001, 0x21) הופך ל-MRU.\n        `[(0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25), (0x000, 0x20), (0x001, 0x21)]`\n    *   סה\"כ: TLB Misses: 8, Page Faults: 2\n\n9.  **גישה: `0x00102000` (VP `0x042`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x42]->P=0.\n    *   **Page Fault!** (PF #3). הקצאת PFN 0x26 ל-VP 0x042. עדכון P2[0x42] ל-PFN 0x26, P=1.\n    *   TLB: פינוי (0x040, 0x24) (LRU). הוספת (0x042, 0x26).\n        `[(0x041, 0x25), (0x000, 0x20), (0x001, 0x21), (0x042, 0x26)]`\n    *   Data Frames: הוספת (0x042, 0x26).\n        `[(0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25), (0x000, 0x20), (0x001, 0x21), (0x042, 0x26)]`\n    *   סה\"כ: TLB Misses: 9, Page Faults: 3\n\n10. **גישה: `0x00004000` (VP `0x004`)**\n    *   **TLB Miss.** Page Walk: P1[0x0]->PFN 0x10, P2[0x4]->P=0.\n    *   **Page Fault!** (PF #4). הקצאת PFN 0x27 ל-VP 0x004. עדכון P2[0x4] ל-PFN 0x27, P=1.\n    *   TLB: פינוי (0x041, 0x25) (LRU). הוספת (0x004, 0x27).\n        `[(0x000, 0x20), (0x001, 0x21), (0x042, 0x26), (0x004, 0x27)]`\n    *   Data Frames: הוספת (0x004, 0x27).\n        `[(0x002, 0x22), (0x003, 0x23), (0x040, 0x24), (0x041, 0x25), (0x000, 0x20), (0x001, 0x21), (0x042, 0x26), (0x004, 0x27)]`\n    *   סה\"כ: TLB Misses: 10, Page Faults: 4\n\n**סיכום תת-שאלה 3:**\nא. סך הכל TLB Misses: **10**\nב. סך הכל Page Faults עבור דפי נתונים: **4**\nג. מצב ה-TLB ורשימת המסגרות הפיזיות (עבור דפי נתונים בלבד) לאחר כל גישה – מפורט לעיל."
    },
    "difficulty_estimation": "Hard"
  }
}