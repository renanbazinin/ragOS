{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "Open",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 23:11:11",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 4788,
      "output_tokens": 4174,
      "total_tokens": 19656
    }
  },
  "question": {
    "id": 1,
    "type": "Open",
    "topic": [
      "Paging",
      "Virtual Memory",
      "Memory Management",
      "TLB",
      "Page Faults"
    ],
    "content": {
      "text": "נתונה מערכת זיכרון וירטואלי עם המאפיינים הבאים:\n*   גודל כתובת וירטואלית (VA): 32 ביטים.\n*   גודל כתובת פיזית (PA): 30 ביטים.\n*   גודל דף: 4KB.\n*   טבלת דפים היררכית עם שתי רמות (P1 ו-P2).\n*   גודל כניסה בטבלת הדפים (PTE): 4 בתים.\n*   TLB (Translation Lookaside Buffer): 2 כניסות, אסוציאטיבי מלא, מדיניות החלפה LRU.\n*   פורמט PTE כולל: Present bit (P), Read/Write bit (R/W), Accessed bit (A), Dirty bit (D), וכן PFN (מספר מסגרת פיזית).\n    *   P=1: הדף נמצא בזיכרון פיזי. P=0: הדף אינו נמצא בזיכרון פיזי.\n    *   R/W=1: ניתן לקרוא ולכתוב לדף. R/W=0: ניתן לקרוא בלבד.\n    *   A: מוגדר ל-1 בעת גישה לדף (קריאה או כתיבה).\n    *   D: מוגדר ל-1 בעת כתיבה לדף.\n\n**מצב התחלתי:**\n*   ה-TLB ריק.\n*   מצב טבלאות הדפים (רק כניסות רלוונטיות, שאר הכניסות אינן Valid או אינן בשימוש): \n    *   PTE עבור דף וירטואלי `0x00000` (P1=0, P2=0): PFN=0x100, P=1, R/W=1, A=0, D=0\n    *   PTE עבור דף וירטואלי `0x00001` (P1=0, P2=1): PFN=0x101, P=1, R/W=0, A=0, D=0\n    *   PTE עבור דף וירטואלי `0x00400` (P1=1, P2=0): PFN=0x200, P=0, R/W=1, A=0, D=0\n    *   PTE עבור דף וירטואלי `0x00401` (P1=1, P2=1): PFN=0x201, P=1, R/W=1, A=0, D=0",
      "code_snippet": null,
      "options": null
    },
    "sub_questions": [
      {
        "id": "1.1",
        "text": "כמה ביטים מוקצים לכל אחד מהשדות הבאים בכתובת הוירטואלית: אינדקס P1, אינדקס P2, והיסט (Offset)? מהו המספר המקסימלי של כניסות בכל רמה של טבלת הדפים? פרט את חישוביך.",
        "code_snippet": null,
        "options": null
      },
      {
        "id": "1.2",
        "text": "עקוב אחר סדרת הגישות הבאות לכתובות וירטואליות. עבור כל גישה, פרט את השלבים המתרחשים (בדיקת TLB, מעבר בטבלאות דפים), האם מתרחשת פסיקת דף (Page Fault) או שגיאת הגנה (Protection Fault), ואם לא, מהי הכתובת הפיזית המתקבלת. כמו כן, הצג את מצב ה-TLB לאחר כל גישה (אם הוא משתנה) ואת עדכוני ה-PTE הרלוונטיים (A ו-D ביטים).\n(הערה: הגישות הן לפי סדר, ו-LRU מחושב על בסיס הגישות המוצלחות שמעדכנות את ה-TLB).",
        "code_snippet": "גישה 1: קריאה לכתובת `0x00000010`\nגישה 2: כתיבה לכתובת `0x00001010`\nגישה 3: קריאה לכתובת `0x00400010`\nגישה 4: קריאה לכתובת `0x00000010`\nגישה 5: כתיבה לכתובת `0x00401010`\nגישה 6: קריאה לכתובת `0x00001010`",
        "options": null
      }
    ],
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": null,
      "explanation": "פתרון:\n\n**1. חלוקת כתובת וירטואלית:**\n*   **גודל דף**: 4KB = 2^12 בתים. לכן, ההיסט (Offset) הוא 12 ביטים.\n*   **גודל כתובת וירטואלית**: 32 ביטים. מספר הביטים הנותרים למספרי דפים הוא 32 - 12 = 20 ביטים.\n*   **גודל כניסה בטבלת הדפים (PTE)**: 4 בתים.\n*   **מספר הכניסות המקסימלי בכל טבלת דפים** (שגודלה כגודל דף, 4KB): 4KB / 4B = 1024 כניסות.\n*   לכן, כל אינדקס ברמת טבלת הדפים (P1 ו-P2) דורש `log2(1024) = 10` ביטים.\n*   **חלוקת הכתובת הוירטואלית (32 ביטים)**:\n    *   אינדקס P1: 10 ביטים.\n    *   אינדקס P2: 10 ביטים.\n    *   היסט (Offset): 12 ביטים.\n*   **מספר הכניסות המקסימלי בכל רמה של טבלת הדפים**: 1024.\n\n**2. מעקב גישות לזיכרון:**\n\n**מצב התחלתי:**\n*   TLB: ריק. (רשימת LRU: []).\n*   PTEs רלוונטיים:\n    *   דף וירטואלי `0x00000` (P1=0, P2=0): PFN=0x100, P=1, R/W=1, A=0, D=0\n    *   דף וירטואלי `0x00001` (P1=0, P2=1): PFN=0x101, P=1, R/W=0, A=0, D=0\n    *   דף וירטואלי `0x00400` (P1=1, P2=0): PFN=0x200, P=0, R/W=1, A=0, D=0\n    *   דף וירטואלי `0x00401` (P1=1, P2=1): PFN=0x201, P=1, R/W=1, A=0, D=0\n\n**גישה 1: קריאה לכתובת `0x00000010`**\n*   מספר דף וירטואלי: `0x00000` (P1=0, P2=0). היסט: `0x10`.\n*   **בדיקת TLB**: Miss (ריק).\n*   **מעבר בטבלת דפים (Page Table Walk)**:\n    *   גישה ל-P1[0] (נניח תקין ומצביע לטבלת P2).\n    *   גישה ל-P2[0]. PTE שנמצא: PFN=0x100, P=1, R/W=1, A=0, D=0.\n    *   **בדיקת הרשאות**: גישת קריאה מותרת (R/W=1).\n    *   **בדיקת Present bit**: P=1, הדף נמצא בזיכרון. אין Page Fault.\n    *   **עדכון PTE**: A=1. ה-PTE הופך ל: PFN=0x100, P=1, R/W=1, A=1, D=0.\n*   **כתובת פיזית**: PFN `0x100` (18 ביטים) + היסט `0x10` (12 ביטים) = `0x04000010`.\n*   **עדכון TLB**: הוספת (VA Page `0x00000`, PFN `0x100`, R/W=1) ל-TLB.\n    *   מצב TLB: `[(0x00000, 0x100, R/W=1)]` (החדש ביותר מימין).\n*   **תוצאה**: כתובת פיזית `0x04000010`.\n\n**גישה 2: כתיבה לכתובת `0x00001010`**\n*   מספר דף וירטואלי: `0x00001` (P1=0, P2=1). היסט: `0x10`.\n*   **בדיקת TLB**: Miss.\n*   **מעבר בטבלת דפים**: \n    *   גישה ל-P1[0].\n    *   גישה ל-P2[1]. PTE שנמצא: PFN=0x101, P=1, R/W=0, A=0, D=0.\n    *   **בדיקת הרשאות**: ניסיון כתיבה, אך R/W=0 (קריאה בלבד).\n*   **תוצאה**: **שגיאת הגנה (Protection Fault)**. לא נוצרת כתובת פיזית. ה-TLB וה-PTE נשארים ללא שינוי.\n*   מצב TLB: `[(0x00000, 0x100, R/W=1)]`.\n\n**גישה 3: קריאה לכתובת `0x00400010`**\n*   מספר דף וירטואלי: `0x00400` (P1=1, P2=0). היסט: `0x10`.\n*   **בדיקת TLB**: Miss.\n*   **מעבר בטבלת דפים**: \n    *   גישה ל-P1[1].\n    *   גישה ל-P2[0]. PTE שנמצא: PFN=0x200, P=0, R/W=1, A=0, D=0.\n    *   **בדיקת הרשאות**: גישת קריאה מותרת (R/W=1).\n    *   **בדיקת Present bit**: P=0, הדף אינו נמצא בזיכרון.\n*   **תוצאה**: **פסיקת דף (Page Fault)**. לא נוצרת כתובת פיזית. ה-TLB וה-PTE נשארים ללא שינוי.\n*   מצב TLB: `[(0x00000, 0x100, R/W=1)]`.\n\n**גישה 4: קריאה לכתובת `0x00000010`**\n*   מספר דף וירטואלי: `0x00000` (P1=0, P2=0). היסט: `0x10`.\n*   **בדיקת TLB**: Hit עבור (0x00000, 0x100, R/W=1).\n*   **בדיקת הרשאות**: גישת קריאה מותרת (R/W=1).\n*   **עדכון PTE**: A=1 (כבר היה 1). ה-PTE נשאר: PFN=0x100, P=1, R/W=1, A=1, D=0.\n*   **כתובת פיזית**: PFN `0x100` + היסט `0x10` = `0x04000010`.\n*   **עדכון TLB**: הערך (0x00000, 0x100, R/W=1) הופך לשימוש האחרון. \n*   מצב TLB: `[(0x00000, 0x100, R/W=1)]`.\n\n**גישה 5: כתיבה לכתובת `0x00401010`**\n*   מספר דף וירטואלי: `0x00401` (P1=1, P2=1). היסט: `0x10`.\n*   **בדיקת TLB**: Miss.\n*   **מעבר בטבלת דפים**: \n    *   גישה ל-P1[1].\n    *   גישה ל-P2[1]. PTE שנמצא: PFN=0x201, P=1, R/W=1, A=0, D=0.\n    *   **בדיקת הרשאות**: גישת כתיבה מותרת (R/W=1).\n    *   **בדיקת Present bit**: P=1, הדף נמצא בזיכרון. אין Page Fault.\n    *   **עדכון PTE**: A=1, D=1. ה-PTE הופך ל: PFN=0x201, P=1, R/W=1, A=1, D=1.\n*   **כתובת פיזית**: PFN `0x201` + היסט `0x10` = `0x08040010`.\n*   **עדכון TLB**: הוספת (VA Page `0x00401`, PFN `0x201`, R/W=1) ל-TLB. \n    *   מצב TLB: `[(0x00000, 0x100, R/W=1), (0x00401, 0x201, R/W=1)]`. (0x00000 הוא ה-LRU).\n*   **תוצאה**: כתובת פיזית `0x08040010`.\n\n**גישה 6: קריאה לכתובת `0x00001010`**\n*   מספר דף וירטואלי: `0x00001` (P1=0, P2=1). היסט: `0x10`.\n*   **בדיקת TLB**: Miss.\n*   **מעבר בטבלת דפים**: \n    *   גישה ל-P1[0].\n    *   גישה ל-P2[1]. PTE שנמצא: PFN=0x101, P=1, R/W=0, A=0, D=0. (שימו לב: ה-A bit לא עודכן בגישה 2 מכיוון שהייתה תקלת הרשאה).\n    *   **בדיקת הרשאות**: גישת קריאה מותרת (R/W=0 פירושו קריאה בלבד).\n    *   **בדיקת Present bit**: P=1, הדף נמצא בזיכרון. אין Page Fault.\n    *   **עדכון PTE**: A=1. ה-PTE הופך ל: PFN=0x101, P=1, R/W=0, A=1, D=0.\n*   **כתובת פיזית**: PFN `0x101` + היסט `0x10` = `0x04040010`.\n*   **עדכון TLB**: הוספת (VA Page `0x00001`, PFN `0x101`, R/W=0) ל-TLB. ה-TLB מלא (2 כניסות), ולכן יש לפנות את הכניסה שהיא LRU. במקרה זה, (0x00000, 0x100, R/W=1) היא ה-LRU.\n    *   מצב TLB: `[(0x00401, 0x201, R/W=1), (0x00001, 0x101, R/W=0)]`.\n*   **תוצאה**: כתובת פיזית `0x04040010`."
    },
    "difficulty_estimation": "Hard"
  }
}