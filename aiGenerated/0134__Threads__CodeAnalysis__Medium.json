{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Threads",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 18:49:10",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1969,
      "output_tokens": 789,
      "total_tokens": 6083
    },
    "subject": "Virtualization"
  },
  "question": {
    "id": 10,
    "type": "CodeAnalysis",
    "topic": [
      "Threads",
      "Pthreads",
      "Race Conditions",
      "Shared Memory"
    ],
    "content": {
      "text": "לפניך קטע קוד בשפת C המשתמש בספריית pthreads. התוכנית יוצרת שלושה חוטים (threads), כאשר כל אחד מהם אמור להדפיס את המספר שקיבל כארגומנט ולעדכן מונה גלובלי. מה ניתן לומר על פלט התוכנית?",
      "code_snippet": "#include <pthread.h>\n#include <stdio.h>\n\nint counter = 0;\n\nvoid* task(void* arg) {\n    int id = *(int*)arg;\n    printf(\"%d\", id);\n    counter++;\n    return NULL;\n}\n\nint main() {\n    pthread_t threads[3];\n    for (int i = 0; i < 3; i++) {\n        pthread_create(&threads[i], NULL, task, &i);\n    }\n    for (int i = 0; i < 3; i++) {\n        pthread_join(threads[i], NULL);\n    }\n    printf(\" C%d\", counter);\n    return 0;\n}",
      "options": [
        "א. הפלט תמיד יהיה הצירוף '012 C3' בסדר כלשהו של הספרות.",
        "ב. הפלט יהיה תמיד '333 C3'.",
        "ג. ייתכן שהפלט יכיל את הספרה 3, וייתכן שספרות מסוימות יופיעו יותר מפעם אחת (למשל '133 C2').",
        "ד. התוכנית תמיד תדפיס '012 C0' כי המונה לא מתעדכן בחוט הראשי.",
        "ה. תתרחש שגיאת סגמנטציה כיוון שהגישה לכתובת של i אינה מותרת מהחוטים."
      ]
    },
    "sub_questions": null,
    "points": 10,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ג",
      "explanation": "הקוד מדגים שתי בעיות סנכרון נפוצות: 1. העברת מצביע למשתנה מקומי (i) שערכו משתנה בחוט אחר. כל החוטים מקבלים את אותה כתובת בזיכרון. כיוון שהחוט הראשי ממשיך לרוץ ולקדם את i, בזמן שהחוטים החדשים ניגשים לכתובת זו, הערך בה עשוי להיות כל אחד מערכי הלולאה או ערך הסיום (3). לכן ייתכנו כפילויות או הופעה של הספרה 3. 2. קיימת תחרות (Race Condition) על המשתנה הגלובלי counter. הפעולה ++ אינה אטומית, ולכן אם שני חוטים ינסו לעדכן אותו בו-זמנית, ייתכן שעדכון אחד ידרס והערך הסופי יהיה קטן מ-3."
    },
    "difficulty_estimation": "Medium"
  }
}