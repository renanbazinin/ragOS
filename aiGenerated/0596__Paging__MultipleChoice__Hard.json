{
  "metadata": {
    "source": "ai_generated",
    "subject": "Virtualization",
    "topic_hint": "Paging",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-07 22:55:29",
    "examples_used": 2,
    "token_usage": {
      "prompt_tokens": 969,
      "output_tokens": 1096,
      "total_tokens": 6153
    }
  },
  "question": {
    "id": 101,
    "type": "MultipleChoice",
    "topic": [
      "Virtual Memory",
      "Paging",
      "Copy-on-Write",
      "Process Management"
    ],
    "content": {
      "text": "נתונה מערכת הפעלה המיישמת זיכרון וירטואלי עם דפדוף (paging) בגודל דף של 4KB ותומכת במנגנון Copy-on-Write (COW). תהליך אב P מקצה אזור זיכרון בגודל 4KB בשם buf וכותב למיקום buf[0] את התו 'A'. לאחר מכן, תהליך P מבצע קריאה למערכת fork() ליצירת תהליך בן C. מיד לאחר ה-fork(), תהליך P כותב למיקום buf[0] את התו 'B'. לבסוף, תהליך C קורא את התו ממיקום buf[0]. איזו טענה נכונה בהכרח לגבי מצב הזיכרון הפיזי והערכים הנצפים על ידי התהליכים?",
      "code_snippet": null,
      "options": [
        "א. בסיום הפעולות, אזור buf משתמש בשני דפים פיזיים שונים. תהליך P יקרא 'B' ותהליך C יקרא 'A'.",
        "ב. בסיום הפעולות, אזור buf משתמש בדף פיזי אחד בלבד. גם תהליך P וגם תהליך C יקראו 'B'.",
        "ג. בסיום הפעולות, אזור buf משתמש בשני דפים פיזיים שונים. גם תהליך P וגם תהליך C יקראו 'B'.",
        "ד. בסיום הפעולות, אזור buf משתמש בדף פיזי אחד בלבד. תהליך P יקרא 'B' ותהליך C יקרא 'A'.",
        "ה. כל התשובות האחרות אינן נכונות."
      ]
    },
    "sub_questions": null,
    "points": null,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "א",
      "explanation": "הסבר:\n1.  **לפני fork()**: תהליך P מקצה דף זיכרון וירטואלי עבור buf אשר ממופה לדף פיזי יחיד (נניח PP1). הכתיבה buf[0] = 'A' גורמת ל-PP1 להכיל 'A'.\n2.  **לאחר fork()**: תהליך C נוצר. מכיוון שהמערכת תומכת ב-COW, ה-PTE (Page Table Entry) עבור הדף של buf בשני התהליכים (P ו-C) מצביע כעת על אותו דף פיזי PP1, אך מסומן כ\"קריאה בלבד\" (או \"COW\"). זה אומר שכל ניסיון כתיבה לדף זה יגרום ל-page fault.\n3.  **P כותב 'B'**: כאשר תהליך P מנסה לכתוב ל-buf[0] = 'B', מתרחשת פסיקת דף (page fault) מכיוון שהדף מסומן כ-COW/קריאה בלבד. מערכת ההפעלה מטפלת בפסיקה:\n    *   מקצה דף פיזי חדש (נניח PP2).\n    *   מעתיקה את התוכן של PP1 (שהוא 'A') ל-PP2.\n    *   מעדכנת את ה-PTE של P עבור buf כך שיצביע על PP2 ומסמנת אותו כ\"קריאה-כתיבה\".\n    *   תהליך P ממשיך את פעולת הכתיבה, וכעת PP2 מכיל 'B'.\n    *   ה-PTE של C עדיין מצביע על PP1 (שעדיין מכיל 'A') ומסומן כ-COW.\n4.  **C קורא buf[0]**: תהליך C מבצע קריאה. מכיוון שה-PTE שלו מצביע על PP1 (המכיל 'A') והפעולה היא קריאה, לא מתרחשת פסיקת דף. C קורא את 'A'.\n\nלכן, בסיום הפעולות, קיימים שני דפים פיזיים עבור אזור buf (אחד עבור P ואחד עבור C), תהליך P רואה 'B' ותהליך C רואה 'A'. תשובה א' נכונה."
    },
    "difficulty_estimation": "Hard"
  }
}