{
  "metadata": {
    "source": "ai_generated",
    "topic_hint": "Threads",
    "requested_type": "CodeAnalysis",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-07 18:48:30",
    "examples_used": 3,
    "token_usage": {
      "prompt_tokens": 1969,
      "output_tokens": 719,
      "total_tokens": 4384
    },
    "subject": "Virtualization"
  },
  "question": {
    "id": 10,
    "type": "CodeAnalysis",
    "topic": [
      "Threads",
      "Pthreads",
      "Concurrency",
      "Race Conditions"
    ],
    "content": {
      "text": "לפניך קטע קוד בשפת C המשתמש בספריית pthreads. מה ניתן לומר על הפלט של התוכנית בהרצה טיפוסית במערכת מרובת ליבות?",
      "code_snippet": "#include <pthread.h>\n#include <stdio.h>\n#include <unistd.h>\n\nvoid* thread_func(void* arg) {\n    int id = *(int*)arg;\n    printf(\"%d \", id);\n    return NULL;\n}\n\nint main() {\n    pthread_t threads[4];\n    for (int i = 0; i < 4; i++) {\n        pthread_create(&threads[i], NULL, thread_func, &i);\n    }\n    for (int i = 0; i < 4; i++) {\n        pthread_join(threads[i], NULL);\n    }\n    return 0;\n}",
      "options": [
        "א. הפלט יהיה תמיד 0 1 2 3 (בסדר כלשהו).",
        "ב. הפלט יהיה תמיד 4 4 4 4.",
        "ג. הפלט עשוי להכיל ספרות בין 0 ל-4, כאשר ייתכן שספרה מסוימת תודפס יותר מפעם אחת וספרה אחרת לא תודפס כלל.",
        "ד. התוכנית תגרום לשגיאת סגמנטציה (Segmentation Fault) כיוון שכל החוטים ניגשים לאותו משתנה i."
      ]
    },
    "sub_questions": null,
    "points": 10,
    "solution": {
      "is_present_in_file": true,
      "correct_option": "ג",
      "explanation": "הבעיה המרכזית בקוד היא העברת הכתובת של משתנה הלולאה i לכל החוטים. כיוון שכל החוטים חולקים את אותו מרחב כתובות, כל חוט מקבל מצביע לאותו מיקום בזיכרון (המחסנית של main). בזמן שחוט אחד נוצר ומתחיל את ריצתו, הלולאה ב-main ממשיכה לרוץ ומעדכנת את הערך של i. כתוצאה מכך, עד שחוט מסוים ניגש לזיכרון כדי לקרוא את הערך של id, הערך של i עשוי להשתנות. ייתכן שחוט יקרא את הערך 1, 2, 3 או אפילו 4 (אם הלולאה הסתיימה לפני שהחוט ניגש לזיכרון). לכן, הפלט אינו צפוי ויכול לכלול חזרות על מספרים."
    },
    "difficulty_estimation": "Medium"
  }
}