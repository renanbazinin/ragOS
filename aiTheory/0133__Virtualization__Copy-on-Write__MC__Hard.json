{
  "metadata": {
    "source": "ai_generated_from_summary",
    "subject": "Virtualization",
    "topic_hint": "Copy-on-Write",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-14 17:23:38",
    "context_chunks_used": 5,
    "context_lectures": [
      8,
      9,
      4,
      7
    ],
    "token_usage": {
      "prompt_tokens": 1949,
      "output_tokens": 905,
      "total_tokens": 5895
    }
  },
  "question": {
    "id": 1,
    "type": "MultipleChoice",
    "subject": "Virtualization",
    "topic": [
      "Copy-on-Write"
    ],
    "difficulty_estimation": "Hard",
    "content": {
      "text": "מערכת הפעלה המיישמת מנגנון Copy-on-Write (CoW) יוצרת תהליכי בן (child processes) על ידי שיתוף דפי זיכרון עם תהליך האב (parent process). בהתחשב בכך, איזו מהפעולות הבאות מהווה את המנגנון המרכזי שמופעל ברגע שתהליך בן מנסה לבצע פעולת כתיבה (write) לדף זיכרון משותף עם האב?",
      "code_snippet": null,
      "options": [
        "א. מערכת ההפעלה מבצעת page fault, מאתרת דף פיזי חדש, מעתיקה את תוכן הדף המשותף לדף החדש, ומעדכנת את טבלת הדפים של תהליך הבן כדי שתצביע על הדף החדש.",
        "ב. ה-MMU מזהה את ניסיון הכתיבה, מוחק את הדף המשותף מהזיכרון הפיזי, וטוען עותק חדש וריק של הדף מהדיסק עבור תהליך הבן.",
        "ג. תהליך הבן מקבל הודעת שגיאה (segmentation fault) והפעולה נכשלת, מכיוון שדפים משותפים אסורים בכתיבה.",
        "ד. מערכת ההפעלה מעדכנת ישירות את טבלת הדפים של תהליך הבן כך שהדף המשותף יהפוך להיות פרטי (private) ויאפשר כתיבה, ללא צורך בהעתקת תוכן."
      ]
    },
    "solution": {
      "correct_option": "א",
      "explanation": "התשובה הנכונה היא א'. מנגנון Copy-on-Write (CoW) פועל כך: כאשר תהליך בן נוצר באמצעות fork, דפי הזיכרון של האב והבן משותפים, אך הם מסומנים כקריאה בלבד (read-only) עבור הבן. ברגע שתהליך הבן מנסה לכתוב לדף כזה, מתרחשת הפרה של הרשאת הזיכרון, מה שגורם ל-page fault. מערכת ההפעלה מיירטת את ה-page fault, מאתרת דף פיזי חדש פנוי, מעתיקה אליו את תוכן הדף המשותף המקורי, ולאחר מכן מעדכנת את טבלת הדפים (page table) של תהליך הבן כך שה-Page Table Entry (PTE) הרלוונטי יצביע על הדף הפיזי החדש והפרטי שלו. רק אז מתאפשרת פעולת הכתיבה לדף החדש. תהליך זה מתואר בחומר הלימוד: \"רק בנקודה הזו, מערכת ההפעלה מוצאת מקום חדש בזיכרון, יוצרת עותק של מה שהיה בו ומשנה את מה שהתהליך רצה לשנות.\" אפשרות ב' שגויה מכיוון שאין מחיקה של הדף המשותף או טעינה מהדיסק (במיוחד כשהחומר מציין שאין swapping). אפשרות ג' שגויה כיוון שמטרת CoW היא לאפשר כתיבה תוך שמירה על הפרדה. אפשרות ד' שגויה כיוון ששינוי מצביע בטבלת הדפים ללא העתקה פיזית של הנתונים יגרום לכך שהאב והבן יראו תוכן שונה מבלי שהנתונים הועתקו בפועל, וזה נוגד את עקרון הבידוד."
    }
  }
}