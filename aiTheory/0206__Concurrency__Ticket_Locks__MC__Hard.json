{
  "metadata": {
    "source": "ai_generated_from_summary",
    "subject": "Concurrency",
    "topic_hint": "Ticket Locks",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Hard",
    "generated_at": "2026-02-14 17:43:41",
    "context_chunks_used": 5,
    "context_lectures": [
      16,
      11,
      13
    ],
    "token_usage": {
      "prompt_tokens": 2333,
      "output_tokens": 713,
      "total_tokens": 6606
    }
  },
  "question": {
    "id": 1,
    "type": "MultipleChoice",
    "subject": "Concurrency",
    "topic": [
      "Ticket Locks"
    ],
    "difficulty_estimation": "Hard",
    "content": {
      "text": "מנעול Ticket Lock מוצג כפתרון לבעיית ההוגנות במנעולים קודמים. בהתבסס על מנגנון הפעולה המתואר למנעול Ticket Lock, איזו בעיית ביצועים פוטנציאלית עלולה להתעורר כאשר חוטים רבים ממתינים למנעול, ואינה מטופלת באופן מפורש במנגנון זה, בניגוד לפתרונות מתקדמים יותר בקטגוריית \"מנעולי תור\"?",
      "code_snippet": null,
      "options": [
        "א. חוסר מניעה הדדית (mutual exclusion) בין חוטים בקטע הקריטי.",
        "ב. מצב קיפאון (deadlock) שבו חוטים ממתינים זה לזה ללא יכולת להתקדם.",
        "ג. צריכת משאבי BUS גבוהה עקב אי-ולידציה חוזרת ונשנית של קווי מטמון משותפים על ידי חוטים הממתינים למשתנה התור (turn).",
        "ד. הרעבה (starvation) של חוטים מסוימים שאינם מצליחים לתפוס את המנעול לעולם."
      ]
    },
    "solution": {
      "correct_option": "ג",
      "explanation": "מנעול Ticket Lock, כפי שמתואר בחומר, פועל על בסיס משתנה יחיד ומשותף בשם `turn` (התור הנוכחי). כל החוטים הממתינים למנעול מבצעים לולאת המתנה (spin-wait) תוך כדי קריאה חוזרת ונשנית של ערך משתנה ה-`turn`. כאשר חוט משחרר את המנעול, הוא מקדם את ערך ה-`turn`. שינוי זה במשתנה המשותף גורם לאי-ולידציה (invalidation) של קווי המטמון (cache lines) אצל כל המעבדים שמחזיקים עותק של משתנה ה-`turn` במטמון המקומי שלהם. כתוצאה מכך, חוטים רבים ינסו לגשת ל-BUS על מנת לטעון מחדש את הערך המעודכן, מה שיוצר תעבורת BUS גבוהה ופוגע בביצועים, תופעה הידועה גם כ-cache contention או \"thundering herd\" במטמון. בעיה זו היא בדיוק מה שסוגים מתקדמים יותר של \"מנעולי תור\", כמו מנעול אנדרסון המוזכר בחומר, מנסים למנוע על ידי מתן משתנה ייעודי לכל חוט להמתין עליו, ובכך למנוע את ה-\"לינקי הזה על ה-cache\"."
    }
  }
}