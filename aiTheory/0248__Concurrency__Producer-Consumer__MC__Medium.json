{
  "metadata": {
    "source": "ai_generated_from_summary",
    "subject": "Concurrency",
    "topic_hint": "Producer-Consumer",
    "requested_type": "MultipleChoice",
    "requested_difficulty": "Medium",
    "generated_at": "2026-02-14 17:54:22",
    "context_chunks_used": 5,
    "context_lectures": [
      14
    ],
    "token_usage": {
      "prompt_tokens": 1516,
      "output_tokens": 877,
      "total_tokens": 6956
    }
  },
  "question": {
    "id": 1,
    "type": "MultipleChoice",
    "subject": "Concurrency",
    "topic": [
      "Producer-Consumer"
    ],
    "difficulty_estimation": "Medium",
    "content": {
      "text": "בבעיית היצרן-צרכן (Bounded Buffer), שימוש במשתנה תנאי (condition variable) יחיד עבור יצרנים וצרכנים (למשל, `cv1`) עלול להוביל לקיפאון (deadlock). מהי הסיבה העיקרית לכך?",
      "code_snippet": "Producer:\n```c\nlock(&m1);\nmmmBop();\nwhile (count < MAX)\n    wait(&cv1, &m1);\n++count;\nsignal(&cv1);\nunlock(&m1);\n```\n\nConsumer:\n```c\nlock(&m1);\nwhile (count == 0)\n    wait(&cv1, &m1);\nbaDuBop();\n--count;\nsignal(&cv1);\nunlock(&m1);\n```",
      "options": [
        "א. כאשר צרכן מסיים לצרוך פריט ושולח סיגנל, ייתכן שיצרן יתעורר בטעות במקום יצרן אחר, למרות שהמחסן עדיין מלא.",
        "ב. כאשר יצרן מסיים לייצר פריט ושולח סיגנל, ייתכן שיצרן יתעורר בטעות במקום צרכן, מה שמונע צריכה של הפריט שנוצר.",
        "ג. כאשר צרכן מסיים לצרוך פריט ושולח סיגנל, ייתכן שצרכן אחר יתעורר בטעות במקום יצרן, למרות שהמחסן התפנה ויש מקום לייצור נוסף.",
        "ד. כאשר יצרן מסיים לייצר פריט ושולח סיגנל, ייתכן שצרכן יתעורר בטעות במקום יצרן, למרות שהמחסן אינו מלא."
      ]
    },
    "solution": {
      "correct_option": "ב",
      "explanation": "התשובה הנכונה היא ב'. במימוש בעיית היצרן-צרכן עם משתנה תנאי יחיד (`cv1`), כאשר יצרן מסיים לייצר פריט, הוא שולח סיגנל (`signal(&cv1)`) כדי להודיע שיש פריט חדש לצריכה. המטרה היא להעיר צרכן שייתכן שממתין. עם זאת, מכיוון שגם יצרנים וגם צרכנים ממתינים על אותו משתנה תנאי (`cv1`), מערכת ההפעלה אינה מבחינה בין סוגי החוטים. לכן, ייתכן שחוט יצרן אחר (שממתין כי המחסן היה מלא בעבר, או מסיבה אחרת) יתעורר במקום צרכן. אם יצרן מתעורר אך אינו יכול להמשיך (למשל, כי המחסן שוב מלא), ואין צרכן שמתעורר כדי לרוקן את המחסן, ייווצר מצב של קיפאון שבו יצרנים חסומים כי המחסן מלא וצרכנים חסומים כי אין פריטים, אך אף אחד לא מתקדם. מצב זה מתואר במפורש בחומר ההרצאה: \"כאשר עושים signal ל-cv1, ייתכן ואנחנו רוצים להעיר צרכן אבל במקום זאת בטעות יצרן שמחכה לסיגנל יתעורר.\""
    }
  }
}